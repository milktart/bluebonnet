<!-- Event Form - Sidebar Only - Using Preline Components -->

<%
  const isAddMode = !isEditing;
  const submitButtonText = isAddMode ? 'Add Event' : 'Update Event';
  const headerText = isAddMode ? 'Add Event/Activity' : 'Edit Event';
%>

<div class="sidebar-form-container">
  <div class="flex items-start justify-between mb-6">
    <div class="flex items-center">
      <button onclick="closeSecondarySidebar()" class="flex items-center justify-center w-8 h-8 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors mr-3">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
        </svg>
      </button>
      <h2 class="text-lg font-bold text-gray-900"><%= headerText %></h2>
    </div>
    <div class="w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center flex-shrink-0">
      <span class="material-symbols-outlined text-orange-600" style="font-size: 16px;">event</span>
    </div>
  </div>

  <form id="<%= isAddMode ? 'addEventForm' : 'editEventForm' %>" action="<%= isAddMode ? `/events/trips/${tripId}/events` : `/events/${data?.id}` %>" method="POST" class="space-y-4">
    <% if (!isAddMode) { %>
      <input type="hidden" name="_method" value="PUT">
    <% } %>
    <input type="hidden" name="tripId" value="<%= tripId %>">

    <!-- Event Name -->
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">Event/Activity Name</label>
      <input type="text" name="name" id="<%= isAddMode ? '' : 'edit_event_name' %>" value="<%= data?.name || '' %>" placeholder="e.g., Museum Tour, Dinner Reservation, Concert" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500" required>
    </div>

    <!-- Location/Venue -->
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">Location/Venue</label>
      <textarea name="location" id="<%= isAddMode ? '' : 'edit_event_location' %>" rows="2" placeholder="Address or venue name with city" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"><%= data?.location || '' %></textarea>
      <small class="text-sm text-gray-500 mt-1">Optional - for map placement</small>
      <input type="hidden" name="timezone" id="<%= isAddMode ? '' : 'edit_event_timezone' %>" value="<%= data?.timezone || '' %>">
    </div>

    <!-- Start Date & Time -->
    <div class="grid grid-cols-2 gap-3">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Start Date</label>
        <input type="date" name="startDate" id="<%= isAddMode ? '' : 'edit_event_startDate' %>" value="<%= data?.startDate || '' %>" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500" required>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Start Time</label>
        <input type="time" name="startTime" id="<%= isAddMode ? '' : 'edit_event_startTime' %>" value="<%= data?.startTime || '' %>" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500" required>
        <small class="text-sm text-gray-500 mt-1">Local start time</small>
      </div>
    </div>

    <!-- End Date & Time -->
    <div class="grid grid-cols-2 gap-3">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">End Date</label>
        <input type="date" name="endDate" id="<%= isAddMode ? '' : 'edit_event_endDate' %>" value="<%= data?.endDate || '' %>" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500" required>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">End Time</label>
        <input type="time" name="endTime" id="<%= isAddMode ? '' : 'edit_event_endTime' %>" value="<%= data?.endTime || '' %>" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500" required>
        <small class="text-sm text-gray-500 mt-1">Local end time</small>
      </div>
    </div>

    <!-- Contact Information -->
    <div class="grid grid-cols-2 gap-3">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Contact Phone</label>
        <input type="tel" name="contactPhone" id="<%= isAddMode ? '' : 'edit_event_contactPhone' %>" value="<%= data?.contactPhone || '' %>" placeholder="e.g., +1-555-0123" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500">
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Contact Email</label>
        <input type="email" name="contactEmail" id="<%= isAddMode ? '' : 'edit_event_contactEmail' %>" value="<%= data?.contactEmail || '' %>" placeholder="contact@venue.com" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500">
      </div>
    </div>

    <!-- Buttons -->
    <div class="flex space-x-3 pt-4">
      <button type="submit" class="flex-1 <%= isAddMode ? 'bg-blue-600 hover:bg-blue-700 focus:ring-blue-500' : 'bg-green-600 hover:bg-green-700 focus:ring-green-500' %> text-white py-2 px-4 rounded-md focus:outline-none focus:ring-2 transition-colors">
        <%= submitButtonText %>
      </button>
      <button type="button" onclick="closeSecondarySidebar()" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-colors">
        Cancel
      </button>
    </div>
  </form>

  <% if (!isAddMode) { %>
    <form action="/events/<%= data?.id %>?_method=DELETE" method="POST" class="mt-4 pt-4 border-t border-gray-200">
      <input type="hidden" name="tripId" value="<%= tripId %>">
      <button type="submit" class="w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors" onclick="return confirm('Are you sure you want to delete this event?')">
        Delete Event
      </button>
    </form>
  <% } %>
</div>

