import{f as w,a as u,c as je,t as ma}from"../chunks/mgpANiac.js";import{h as oi}from"../chunks/C0UKtQpt.js";import{o as Va,w as li}from"../chunks/DY5-1jsb.js";import{aV as di,Z as Jr,o as Ma,q as Gr,a3 as Cr,ag as ci,a8 as Er,a as e,d as Ke,a0 as vi,a1 as ui,a2 as Or,a4 as jr,aa as fr,ah as pi,aP as fi,aB as zr,I as mr,a9 as $r,ac as mi,aN as Lr,aU as Yr,at as Ur,w as ne,aW as hi,aX as gi,aY as _i,aZ as Ia,a5 as Wr,a7 as Zr,a_ as Nr,ai as yi,aM as bi,a6 as xi,M as Ti,a$ as Kr,b0 as Di,F as wi,e as Xr,J as ki,b1 as Ci,b2 as Ei,t as Qr,g as ji,x as Jt,s as o,ad as pa,Y as Ae,ae as Wa,B as Gt,C as a,y as r,b3 as Q,u as c,E as t,A as K,z as fe,b4 as Ni,b5 as lr,b6 as La,n as Ft,$ as Si}from"../chunks/6VQ_8qfV.js";import{s as q,e as R}from"../chunks/BgKsp-fi.js";import{i as I}from"../chunks/DWD46BZK.js";import{t as Mi,s as kt,c as Ii,B as Aa}from"../chunks/DBddglCw.js";import{i as Yt}from"../chunks/D4j-cL-r.js";import{s as Ai,a as $i}from"../chunks/DOiyoGAd.js";import{a as Pi,b as qi}from"../chunks/CN9vruw_.js";import{B as Li}from"../chunks/CTlAKUO8.js";import{s as Sr}from"../chunks/BjBIcaOF.js";import{_ as Mr,b as dr}from"../chunks/y2GqnK4-.js";import{p as Se}from"../chunks/CEvUO948.js";import{r as be,s as gt,a as hr,b as Ir}from"../chunks/Djbzun47.js";import{b as xe,a as ei}from"../chunks/dsJstiAQ.js";function Ri(n,s,d){Ma&&Gr();var f=new Li(n),x=!di();Jr(()=>{var m=s();x&&m!==null&&typeof m=="object"&&(m={}),f.ensure(m,d)})}function ha(n,s){return s}function Fi(n,s,d){for(var f=[],x=s.length,m,v=s.length,p=0;p<x;p++){let ve=s[p];Zr(ve,()=>{if(m){if(m.pending.delete(ve),m.done.add(ve),m.pending.size===0){var re=n.outrogroups;Pr(Lr(m.done)),re.delete(m),re.size===0&&(n.outrogroups=null)}}else v-=1},!1)}if(v===0){var h=f.length===0&&d!==null;if(h){var P=d,L=P.parentNode;bi(L),L.append(P),n.items.clear()}Pr(s,!h)}else m={pending:new Set(s),done:new Set},(n.outrogroups??=new Set).add(m)}function Pr(n,s=!0){for(var d=0;d<n.length;d++)xi(n[d],s)}var Hr;function ut(n,s,d,f,x,m=null){var v=n,p=new Map,h=(s&Kr)!==0;if(h){var P=n;v=Ma?Cr(ci(P)):P.appendChild(Er())}Ma&&Gr();var L=null,ve=Ke(()=>{var E=d();return Yr(E)?E:E==null?[]:Lr(E)}),re,te=!0;function he(){i.fallback=L,Oi(i,re,v,s,f),L!==null&&(re.length===0?(L.f&Ia)===0?Wr(L):(L.f^=Ia,nr(L,null,v)):Zr(L,()=>{L=null}))}var le=Jr(()=>{re=e(ve);var E=re.length;let se=!1;if(Ma){var ge=vi(v)===ui;ge!==(E===0)&&(v=Or(),Cr(v),jr(!1),se=!0)}for(var ue=new Set,N=mr,ie=mi(),ye=0;ye<E;ye+=1){Ma&&fr.nodeType===pi&&fr.data===fi&&(v=fr,se=!0,jr(!1));var U=re[ye],z=f(U,ye),k=te?null:p.get(z);k?(k.v&&zr(k.v,U),k.i&&zr(k.i,ye),ie&&N.skipped_effects.delete(k.e)):(k=zi(p,te?v:Hr??=Er(),U,z,ye,x,s,d),te||(k.e.f|=Ia),p.set(z,k)),ue.add(z)}if(E===0&&m&&!L&&(te?L=$r(()=>m(v)):(L=$r(()=>m(Hr??=Er())),L.f|=Ia)),Ma&&E>0&&Cr(Or()),!te)if(ie){for(const[Y,H]of p)ue.has(Y)||N.skipped_effects.add(H.e);N.oncommit(he),N.ondiscard(()=>{})}else he();se&&jr(!0),e(ve)}),i={effect:le,items:p,outrogroups:null,fallback:L};te=!1,Ma&&(v=fr)}function Oi(n,s,d,f,x){var m=(f&Di)!==0,v=s.length,p=n.items,h=n.effect.first,P,L=null,ve,re=[],te=[],he,le,i,E;if(m)for(E=0;E<v;E+=1)he=s[E],le=x(he,E),i=p.get(le).e,(i.f&Ia)===0&&(i.nodes?.a?.measure(),(ve??=new Set).add(i));for(E=0;E<v;E+=1){if(he=s[E],le=x(he,E),i=p.get(le).e,n.outrogroups!==null)for(const k of n.outrogroups)k.pending.delete(i),k.done.delete(i);if((i.f&Ia)!==0)if(i.f^=Ia,i===h)nr(i,null,d);else{var se=L?L.next:h;i===n.effect.last&&(n.effect.last=i.prev),i.prev&&(i.prev.next=i.next),i.next&&(i.next.prev=i.prev),qa(n,L,i),qa(n,i,se),nr(i,se,d),L=i,re=[],te=[],h=L.next;continue}if((i.f&Nr)!==0&&(Wr(i),m&&(i.nodes?.a?.unfix(),(ve??=new Set).delete(i))),i!==h){if(P!==void 0&&P.has(i)){if(re.length<te.length){var ge=te[0],ue;L=ge.prev;var N=re[0],ie=re[re.length-1];for(ue=0;ue<re.length;ue+=1)nr(re[ue],ge,d);for(ue=0;ue<te.length;ue+=1)P.delete(te[ue]);qa(n,N.prev,ie.next),qa(n,L,N),qa(n,ie,ge),h=ge,L=ie,E-=1,re=[],te=[]}else P.delete(i),nr(i,h,d),qa(n,i.prev,i.next),qa(n,i,L===null?n.effect.first:L.next),qa(n,L,i),L=i;continue}for(re=[],te=[];h!==null&&h!==i;)(P??=new Set).add(h),te.push(h),h=h.next;if(h===null)continue}(i.f&Ia)===0&&re.push(i),L=i,h=i.next}if(n.outrogroups!==null){for(const k of n.outrogroups)k.pending.size===0&&(Pr(Lr(k.done)),n.outrogroups?.delete(k));n.outrogroups.size===0&&(n.outrogroups=null)}if(h!==null||P!==void 0){var ye=[];if(P!==void 0)for(i of P)(i.f&Nr)===0&&ye.push(i);for(;h!==null;)(h.f&Nr)===0&&h!==n.fallback&&ye.push(h),h=h.next;var U=ye.length;if(U>0){var z=(f&Kr)!==0&&v===0?d:null;if(m){for(E=0;E<U;E+=1)ye[E].nodes?.a?.measure();for(E=0;E<U;E+=1)ye[E].nodes?.a?.fix()}Fi(n,ye,z)}}m&&Ti(()=>{if(ve!==void 0)for(i of ve)i.nodes?.a?.apply()})}function zi(n,s,d,f,x,m,v,p){var h=(v&gi)!==0?(v&_i)===0?ne(d,!1,!1):Ur(d):null,P=(v&hi)!==0?Ur(x):null;return{v:h,i:P,e:$r(()=>(m(s,h??d,P??x,p),()=>{n.delete(f)}))}}function nr(n,s,d){if(n.nodes)for(var f=n.nodes.start,x=n.nodes.end,m=s&&(s.f&Ia)===0?s.nodes.start:d;f!==null;){var v=yi(f);if(m.before(f),f===x)return;f=v}}function qa(n,s,d){s===null?n.effect.first=d:s.next=d,d===null?n.effect.last=s:d.prev=s}function xr(n,s,d,f){var x=n.__style;if(Ma||x!==s){var m=Mi(s);(!Ma||m!==n.getAttribute("style"))&&(m==null?n.removeAttribute("style"):n.style.cssText=m),n.__style=s}return f}function ti(n,s,d=!1){if(n.multiple){if(s==null)return;if(!Yr(s))return Ci();for(var f of n.options)f.selected=s.includes(vr(f));return}for(f of n.options){var x=vr(f);if(Ei(x,s)){f.selected=!0;return}}(!d||s!==void 0)&&(n.selectedIndex=-1)}function Ui(n){var s=new MutationObserver(()=>{ti(n,n.__value)});s.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Qr(()=>{s.disconnect()})}function cr(n,s,d=s){var f=new WeakSet,x=!0;wi(n,"change",m=>{var v=m?"[selected]":":checked",p;if(n.multiple)p=[].map.call(n.querySelectorAll(v),vr);else{var h=n.querySelector(v)??n.querySelector("option:not([disabled])");p=h&&vr(h)}d(p),mr!==null&&f.add(mr)}),Xr(()=>{var m=s();if(n===document.activeElement){var v=ki??mr;if(f.has(v))return}if(ti(n,m,x),x&&m===void 0){var p=n.querySelector(":checked");p!==null&&(m=vr(p),d(m))}n.__value=m,x=!1}),Ui(n)}function vr(n){return"__value"in n?n.__value:n.value}function sr(n,s,d){var f=ji(n,s);f&&f.set&&(n[s]=d,Qr(()=>{n[s]=null}))}function ur(n){return function(...s){var d=s[0];return d.preventDefault(),n?.apply(this,s)}}var Hi=w('<div style="width: 100%; height: 100%; position: absolute;"></div>');function Vi(n,s){Jt(s,!1);let d=Se(s,"tripData",24,()=>({}));Se(s,"fullTripData",8,null),Se(s,"isPast",8,!1);let f=Se(s,"highlightedTripId",8,null),x=Se(s,"highlightedItemType",8,null),m=Se(s,"highlightedItemId",8,null),v=ne(),p=ne(),h=ne(!1),P=[],L={};const ve="https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}";function re(U,z){const Y=(z[0]-U[0])*Math.PI/180,H=(z[1]-U[1])*Math.PI/180,g=Math.sin(Y/2)*Math.sin(Y/2)+Math.cos(U[0]*Math.PI/180)*Math.cos(z[0]*Math.PI/180)*Math.sin(H/2)*Math.sin(H/2);return 6371*(2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g)))}function te(U,z,k=300){const Y=[],H=U[0]*Math.PI/180,g=U[1]*Math.PI/180,W=z[0]*Math.PI/180,C=z[1]*Math.PI/180,S=C-g,y=Math.sin(H)*Math.sin(W)+Math.cos(H)*Math.cos(W)*Math.cos(S),_=Math.acos(Math.max(-1,Math.min(1,y)));if(_<1e-5)return Y.push(U,z),Y;let F=U[1];for(let A=0;A<=k;A++){const ae=A/k,ke=Math.sin((1-ae)*_)/Math.sin(_),de=Math.sin(ae*_)/Math.sin(_),pe=ke*Math.cos(H)*Math.cos(g)+de*Math.cos(W)*Math.cos(C),B=ke*Math.cos(H)*Math.sin(g)+de*Math.cos(W)*Math.sin(C),J=ke*Math.sin(H)+de*Math.sin(W),Z=Math.atan2(J,Math.sqrt(pe*pe+B*B));let O=Math.atan2(B,pe),ce=Z*180/Math.PI,Me=O*180/Math.PI;const Le=Me-F;Le>180?Me-=360:Le<-180&&(Me+=360),F=Me,Y.push([ce,Me])}return Y}function he(U,z){return new Promise(k=>{le(U,z,k)})}async function le(U,z,k){if(!e(p)||!e(p)._container||!e(p)._container.offsetParent)return;const Y=(await Mr(async()=>{const{default:de}=await import("../chunks/2Sd0OU2W.js").then(pe=>pe.l);return{default:de}},[],import.meta.url)).default,H=P.find(de=>de.itemType===U&&de.itemId===z);if(!H)return;const g=`${U}-${z}`;if(L[g]&&(clearInterval(L[g].interval),L[g].marker))try{e(p).removeLayer(L[g].marker)}catch{}const W=H.polyline.getLatLngs();if(W.length===0)return;const C=W[0],S=W[W.length-1],y=re([C.lat,C.lng],[S.lat,S.lng]),_=e(p).getZoom(),F=Math.max(.75,2**(4-_)),A=y/6e3*3e3*F,ae=50,ke=ae/A;try{const de=Y.marker([C.lat,C.lng],{icon:Y.divIcon({className:"moving-dot-marker",html:`<div style="
            width: 12px;
            height: 12px;
            background: ${H.originalColor};
            border-radius: 50%;
            box-shadow: 0 0 10px ${H.originalColor}, 0 0 20px ${H.originalColor}, inset 0 0 5px rgba(255,255,255,0.5);
            border: 2px solid white;
          "></div>`,iconSize:[16,16],iconAnchor:[8,8]})}).addTo(e(p));let pe=0;const B=setInterval(()=>{if(pe+=ke,pe>=1){clearInterval(B);try{e(p).removeLayer(de)}catch{}delete L[g],k();return}const J=pe*(W.length-1),Z=Math.floor(J),O=Math.min(Z+1,W.length-1),ce=J-Z,Me=W[Z],Le=W[O],pt=Me.lat+(Le.lat-Me.lat)*ce,Je=Me.lng+(Le.lng-Me.lng)*ce;de.setLatLng(Y.latLng(pt,Je))},ae);L[g]={marker:de,interval:B}}catch(de){console.error("[MapVisualization] Error creating animation:",de)}}async function i(U){if(!(!e(p)||!e(p)._container||!e(p)._container.offsetParent)&&L[U]){if(clearInterval(L[U].interval),L[U].marker)try{e(p).removeLayer(L[U].marker)}catch{}delete L[U]}}function E(){Object.keys(L).forEach(U=>{i(U)})}async function se(U){if(!e(p)||!P||P.length===0)return;E();const z=P.filter(k=>k.tripId===U);if(z.length!==0){z.sort((k,Y)=>{const H=k.sortDate?.getTime()||0,g=Y.sortDate?.getTime()||0;return H-g});for(const k of z)await new Promise(Y=>{le(k.itemType,k.itemId,Y)})}}function ge(){return e(p)}async function ue(){if(!e(p)||!d())return;const U=(await Mr(async()=>{const{default:g}=await import("../chunks/2Sd0OU2W.js").then(W=>W.l);return{default:g}},[],import.meta.url)).default;P=[],Object.keys(L).forEach(g=>{if(L[g].interval&&clearInterval(L[g].interval),L[g].marker)try{e(p).removeLayer(L[g].marker)}catch{}}),L={},e(p).eachLayer(g=>{(g instanceof U.Marker||g instanceof U.Polyline)&&e(p).removeLayer(g)});const z=[],k=[],Y=[];if(d().flights&&Array.isArray(d().flights))for(const g of d().flights){if(!g.origin||!g.destination)continue;const W=parseFloat(g.originLat),C=parseFloat(g.originLng),S=parseFloat(g.destinationLat),y=parseFloat(g.destinationLng);!isNaN(W)&&!isNaN(C)&&(z.push({name:g.origin,type:"flight",details:`${g.airline} ${g.flightNumber}`,lat:W,lng:C}),Y.push([W,C])),!isNaN(S)&&!isNaN(y)&&(z.push({name:g.destination,type:"flight",details:`${g.airline} ${g.flightNumber}`,lat:S,lng:y}),Y.push([S,y])),!isNaN(W)&&!isNaN(C)&&!isNaN(S)&&!isNaN(y)&&k.push({type:"flight",from:[W,C],to:[S,y],color:"#a68900",itemType:"flight",itemId:g.id,tripId:g.tripId||null,sortDate:new Date(g.departureDateTime||0)})}if(d().hotels&&Array.isArray(d().hotels))for(const g of d().hotels){if(!g.address)continue;const W=parseFloat(g.lat),C=parseFloat(g.lng);!isNaN(W)&&!isNaN(C)&&(z.push({name:g.hotelName,type:"hotel",details:g.address,lat:W,lng:C}),Y.push([W,C]))}if(d().events&&Array.isArray(d().events))for(const g of d().events){if(!g.location)continue;const W=parseFloat(g.lat),C=parseFloat(g.lng);!isNaN(W)&&!isNaN(C)&&(z.push({name:g.name,type:"event",details:g.location,lat:W,lng:C}),Y.push([W,C]))}if(d().transportation&&Array.isArray(d().transportation))for(const g of d().transportation){if(!g.origin||!g.destination)continue;const W=parseFloat(g.originLat),C=parseFloat(g.originLng),S=parseFloat(g.destinationLat),y=parseFloat(g.destinationLng);!isNaN(W)&&!isNaN(C)&&(z.push({name:g.method,type:"transportation",details:g.origin,lat:W,lng:C}),Y.push([W,C])),!isNaN(S)&&!isNaN(y)&&(z.push({name:g.method,type:"transportation",details:g.destination,lat:S,lng:y}),Y.push([S,y])),!isNaN(W)&&!isNaN(C)&&!isNaN(S)&&!isNaN(y)&&k.push({type:"transportation",from:[W,C],to:[S,y],color:"#0066cc",itemType:"transportation",itemId:g.id,tripId:g.tripId||null,sortDate:new Date(g.departureDateTime||0)})}if(d().carRentals&&Array.isArray(d().carRentals))for(const g of d().carRentals){if(!g.pickupLocation)continue;const W=parseFloat(g.pickupLat),C=parseFloat(g.pickupLng);!isNaN(W)&&!isNaN(C)&&(z.push({name:g.company,type:"carRental",details:g.pickupLocation,lat:W,lng:C}),Y.push([W,C]))}const H={flight:"#a68900",event:"#d6006a",hotel:"#7c2d8f",carRental:"#d35a2f",transportation:"#0066cc"};if(k.forEach((g,W)=>{const C=te(g.from,g.to),S=U.polyline(C,{color:g.color,weight:6,opacity:.2,smooth:!0,noClip:!0}).addTo(e(p)),y=U.polyline(C,{color:g.color,weight:4,opacity:.35,smooth:!0,noClip:!0}).addTo(e(p)),_=U.polyline(C,{color:"#ffffff",weight:2,opacity:1,smooth:!0,noClip:!0}).addTo(e(p));P.push({index:W+1,polyline:_,glowLayers:[S,y,_],originalColor:g.color,originalWeight:2,originalOpacity:1,itemType:g.itemType,itemId:g.itemId,tripId:g.tripId,sortDate:g.sortDate})}),z.forEach(g=>{const W=H[g.type]||"#6c757d",C=U.circleMarker([g.lat,g.lng],{radius:4,fillColor:W,color:"#fff",weight:1,opacity:1,fillOpacity:.8}).addTo(e(p)),S=`
        <div style="min-width: 200px;">
          <strong>${g.name}</strong><br>
          <em>${g.type}</em><br>
          ${g.details}
        </div>
      `;C.bindPopup(S)}),Y.length>0){const g=U.latLngBounds(Y),W=g.getNorth()-g.getSouth(),C=g.getEast()-g.getWest(),S=Math.max(W,C);let y;S>300?y=1.5:S>150?y=1.75:S>100?y=2:S>50?y=2.5:S>20?y=3:S>10?y=3.5:y=4,e(p).fitBounds(g,{maxZoom:y,animate:!1});const _=e(p).getBounds(),F=_.getCenter(),A=_.getEast()-_.getWest();_.getNorth()-_.getSouth();const ae=U.latLng(F.lat,F.lng-A*.135);e(p).setView(ae,e(p).getZoom(),{animate:!1})}}function N(U){return U?U.flights?.length>0||U.hotels?.length>0||U.events?.length>0||U.transportation?.length>0||U.carRentals?.length>0:!1}Va(async()=>{if(!e(v))return console.error("[MapVisualization DEBUG] mapContainer is null!"),()=>{e(p)&&e(p).remove()};try{const U=(await Mr(async()=>{const{default:k}=await import("../chunks/2Sd0OU2W.js").then(Y=>Y.l);return{default:k}},[],import.meta.url)).default;o(p,U.map(e(v),{center:[0,0],zoom:2,minZoom:1,zoomSnap:.5,zoomControl:!1,scrollWheelZoom:!0,attributionControl:!1,worldCopyJump:!0})),U.control.zoom({position:"bottomright"}).addTo(e(p));const z=window.MAP_TILE_URL||ve;U.tileLayer(z,{attribution:"",maxZoom:18,minZoom:1}).addTo(e(p))}catch(U){console.error("[MapVisualization DEBUG] Error initializing empty map:",U)}return o(h,!0),()=>{e(p)&&e(p).remove()}}),pa(()=>(e(h),e(p),Ae(d())),()=>{e(h)&&e(p)&&d()&&N(d())&&ue().catch(U=>console.error("[MapVisualization DEBUG] populateMapWithData error:",U))}),pa(()=>(e(h),e(p),Ae(f()),Ae(m())),()=>{e(h)&&e(p)&&f()&&!m()?se(f()).catch(U=>console.error("[MapVisualization DEBUG] highlightTripOnMap error:",U)):!f()&&!m()&&e(h)&&e(p)&&E()}),pa(()=>(e(h),e(p),Ae(m()),Ae(x())),()=>{e(h)&&e(p)&&m()&&x()&&(E(),he(x(),m()).catch(U=>console.error("[MapVisualization DEBUG] highlightMapMarker error:",U)))}),Wa();var ie={highlightMapMarker:he,unhighlightMapMarker:i,clearAllAnimations:E,getMapInstance:ge};Yt();var ye=Hi();return dr(ye,U=>o(v,U),()=>e(v)),u(n,ye),sr(s,"highlightMapMarker",he),sr(s,"unhighlightMapMarker",i),sr(s,"clearAllAnimations",E),sr(s,"getMapInstance",ge),Gt(ie)}var Bi=w('<div class="map-layout svelte-4r5mac"><div id="tripMap" class="map-container svelte-4r5mac"><!></div> <aside class="primary-sidebar sidebar svelte-4r5mac"><!></aside> <aside id="secondary-sidebar" class="secondary-sidebar sidebar svelte-4r5mac"><!></aside> <aside id="tertiary-sidebar" class="tertiary-sidebar sidebar svelte-4r5mac"><!></aside></div>');function Ji(n,s){Jt(s,!1);let d=Se(s,"tripData",8,null),f=Se(s,"isPast",8,!1),x=Se(s,"highlightedTripId",8,null),m=Se(s,"highlightedItemType",8,null),v=Se(s,"highlightedItemId",8,null),p=ne(),h=ne(),P=ne();function L(){return e(P)}Va(()=>{const N=new MutationObserver(()=>{if(e(p)){const ie=e(p).textContent?.trim().length>0;Q(p,e(p).style.display=ie?"flex":"none")}if(e(h)){const ie=e(h).textContent?.trim().length>0;Q(h,e(h).style.display=ie?"flex":"none")}});if(e(p)){N.observe(e(p),{childList:!0,subtree:!0,characterData:!0});const ie=e(p).textContent?.trim().length>0;Q(p,e(p).style.display=ie?"flex":"none")}if(e(h)){N.observe(e(h),{childList:!0,subtree:!0,characterData:!0});const ie=e(h).textContent?.trim().length>0;Q(h,e(h).style.display=ie?"flex":"none")}return()=>N.disconnect()});var ve={getMapComponent:L};Yt();var re=Bi(),te=a(re),he=a(te);Ri(he,()=>(Ae(d()),c(()=>JSON.stringify(d()))),N=>{dr(Vi(N,{get tripData(){return d()},get isPast(){return f()},get highlightedTripId(){return x()},get highlightedItemType(){return m()},get highlightedItemId(){return v()},$$legacy:!0}),ie=>o(P,ie),()=>e(P))}),t(te);var le=r(te,2),i=a(le);Sr(i,s,"primary",{}),t(le);var E=r(le,2),se=a(E);Sr(se,s,"secondary",{}),t(E),dr(E,N=>o(p,N),()=>e(p));var ge=r(E,2),ue=a(ge);return Sr(ue,s,"tertiary",{}),t(ge),dr(ge,N=>o(h,N),()=>e(h)),t(re),u(n,re),sr(s,"getMapComponent",L),Gt(ve)}const ai={currentTrip:null,trips:[],flights:[],hotels:[],events:[],carRentals:[],transportation:[],companions:[],vouchers:[],loading:!1,error:null},Bt=li(ai),Gi={setCurrentTrip(n){Bt.update(s=>({...s,currentTrip:n}))},setTrips(n){Bt.update(s=>({...s,trips:n}))},addTrip(n){Bt.update(s=>({...s,trips:[...s.trips,n]}))},updateTrip(n,s){Bt.update(d=>({...d,trips:d.trips.map(f=>f.id===n?{...f,...s}:f),currentTrip:d.currentTrip?.id===n?{...d.currentTrip,...s}:d.currentTrip}))},deleteTrip(n){Bt.update(s=>({...s,trips:s.trips.filter(d=>d.id!==n),currentTrip:s.currentTrip?.id===n?null:s.currentTrip}))},setFlights(n){Bt.update(s=>({...s,flights:n}))},addFlight(n){Bt.update(s=>({...s,flights:[...s.flights,n]}))},updateFlight(n,s){Bt.update(d=>({...d,flights:d.flights.map(f=>f.id===n?{...f,...s}:f)}))},deleteFlight(n){Bt.update(s=>({...s,flights:s.flights.filter(d=>d.id!==n)}))},setHotels(n){Bt.update(s=>({...s,hotels:n}))},addHotel(n){Bt.update(s=>({...s,hotels:[...s.hotels,n]}))},updateHotel(n,s){Bt.update(d=>({...d,hotels:d.hotels.map(f=>f.id===n?{...f,...s}:f)}))},deleteHotel(n){Bt.update(s=>({...s,hotels:s.hotels.filter(d=>d.id!==n)}))},setLoading(n){Bt.update(s=>({...s,loading:n}))},setError(n){Bt.update(s=>({...s,error:n}))},reset(){Bt.set(ai)}};function Yi(){if(typeof window<"u"){const n=window.location.hostname,s=window.location.protocol;return window.location.port==="5173"?`${s}//${n}:3501/api`:n==="localhost"||n==="127.0.0.1"?`${s}//localhost:3000/api`:`${s}//${n}:3501/api`}return"http://localhost:3000/api"}const Wi=Yi();function Zi(n){return n&&typeof n=="object"&&"data"in n?n.data:n}async function We(n,s){const d=`${Wi}${n}`;try{const f=await fetch(d,{...s,credentials:"include",headers:{"Content-Type":"application/json",...s?.headers}});if(!f.ok){let v=`API error (${f.status})`;try{const p=await f.json();v=p.message||p.error||v}catch{try{const p=await f.text();p&&(v=p)}catch{}}throw f.status===401?(typeof window<"u"&&(window.location.href="/login"),new Error("Your session has expired. Please log in again.")):f.status===403?new Error("You do not have permission to access this resource."):f.status===404?new Error("The requested resource was not found."):f.status===409?new Error("This item already exists or there was a conflict."):f.status>=500?new Error("Server error. Please try again later."):new Error(v)}const x=await f.json();return Zi(x)}catch(f){throw f instanceof TypeError&&f.message.includes("fetch")?new Error("Network error. Please check your internet connection and try again."):f instanceof Error?f:new Error("An unexpected error occurred. Please try again.")}}const Ya={getAll:(n="upcoming")=>We(`/v1/trips?filter=${n}`),getOne:n=>We(`/v1/trips/${n}`),create:n=>We("/v1/trips",{method:"POST",body:JSON.stringify(n)}),update:(n,s)=>We(`/v1/trips/${n}`,{method:"PUT",body:JSON.stringify(s)}),delete:n=>We(`/v1/trips/${n}`,{method:"DELETE"})},or={getByTrip:n=>We(`/v1/flights/trips/${n}`),createStandalone:n=>We("/v1/flights",{method:"POST",body:JSON.stringify(n)}),create:(n,s)=>n?We(`/v1/flights/trips/${n}`,{method:"POST",body:JSON.stringify(s)}):or.createStandalone(s),update:(n,s)=>We(`/v1/flights/${n}`,{method:"PUT",body:JSON.stringify(s)}),delete:n=>We(`/v1/flights/${n}`,{method:"DELETE"}),lookupAirline:n=>We(`/v1/flights/lookup/airline/${encodeURIComponent(n.toUpperCase())}`)},gr={getByTrip:n=>We(`/v1/hotels/trips/${n}`),createStandalone:n=>We("/v1/hotels",{method:"POST",body:JSON.stringify(n)}),create:(n,s)=>n?We(`/v1/hotels/trips/${n}`,{method:"POST",body:JSON.stringify(s)}):gr.createStandalone(s),update:(n,s)=>We(`/v1/hotels/${n}`,{method:"PUT",body:JSON.stringify(s)}),delete:n=>We(`/v1/hotels/${n}`,{method:"DELETE"})},_r={getByTrip:n=>We(`/v1/events/trips/${n}`),createStandalone:n=>We("/v1/events",{method:"POST",body:JSON.stringify(n)}),create:(n,s)=>n?We(`/v1/events/trips/${n}`,{method:"POST",body:JSON.stringify(s)}):_r.createStandalone(s),update:(n,s)=>We(`/v1/events/${n}`,{method:"PUT",body:JSON.stringify(s)}),delete:n=>We(`/v1/events/${n}`,{method:"DELETE"})},yr={getByTrip:n=>We(`/v1/transportation/trips/${n}`),createStandalone:n=>We("/v1/transportation",{method:"POST",body:JSON.stringify(n)}),create:(n,s)=>n?We(`/v1/transportation/trips/${n}`,{method:"POST",body:JSON.stringify(s)}):yr.createStandalone(s),update:(n,s)=>We(`/v1/transportation/${n}`,{method:"PUT",body:JSON.stringify(s)}),delete:n=>We(`/v1/transportation/${n}`,{method:"DELETE"})},br={getByTrip:n=>We(`/v1/car-rentals/trips/${n}`),createStandalone:n=>We("/v1/car-rentals",{method:"POST",body:JSON.stringify(n)}),create:(n,s)=>n?We(`/v1/car-rentals/trips/${n}`,{method:"POST",body:JSON.stringify(s)}):br.createStandalone(s),update:(n,s)=>We(`/v1/car-rentals/${n}`,{method:"PUT",body:JSON.stringify(s)}),delete:n=>We(`/v1/car-rentals/${n}`,{method:"DELETE"})},Ar={getAll:()=>We("/v1/companions/all"),getByTrip:n=>We(`/v1/companions/trips/${n}`),addToTrip:(n,s,d)=>We(`/v1/companions/trips/${n}`,{method:"POST",body:JSON.stringify({companionId:s,canEdit:d})}),removeFromTrip:(n,s)=>We(`/v1/companions/trips/${n}/${s}`,{method:"DELETE"})};function wa(n,s){if(!n)return"";try{const d=new Date(n);if(isNaN(d.getTime()))return"";if(!s){const v=d.getUTCFullYear(),p=String(d.getUTCMonth()+1).padStart(2,"0"),h=String(d.getUTCDate()).padStart(2,"0"),P=String(d.getUTCHours()).padStart(2,"0"),L=String(d.getUTCMinutes()).padStart(2,"0");return`${v}-${p}-${h}T${P}:${L}`}const x=new Intl.DateTimeFormat("en-CA",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:s}).formatToParts(d),m={};return x.forEach(v=>{v.type!=="literal"&&(m[v.type]=v.value)}),`${m.year}-${m.month}-${m.day}T${m.hour}:${m.minute}`}catch(d){return console.error("Error converting UTC to local time:",d),""}}var Ki=w('<p class="loading-message svelte-1a5pdw0"> </p>'),Xi=w('<div><div class="spinner svelte-1a5pdw0"></div> <!></div>');function Qi(n,s){let d=Se(s,"size",8,"medium"),f=Se(s,"message",8,"Loading...");var x=Xi(),m=r(a(x),2);{var v=p=>{var h=Ki(),P=a(h,!0);t(h),K(()=>q(P,f())),u(p,h)};I(m,p=>{f()&&p(v)})}t(x),K(()=>kt(x,1,`loading-container loading-${d()??""}`,"svelte-1a5pdw0")),u(n,x)}var en=w('<strong class="svelte-1frq9vu"> </strong>'),tn=w('<button class="alert-close svelte-1frq9vu"><span aria-label="Close">×</span></button>'),an=w('<div><div class="alert-content svelte-1frq9vu"><!> <p class="svelte-1frq9vu"> </p></div> <!></div>');function Ra(n,s){let d=Se(s,"type",8,"info"),f=Se(s,"title",8,""),x=Se(s,"message",8),m=Se(s,"dismissible",8,!1),v=ne(!0);function p(){o(v,!1)}var h=je(),P=fe(h);{var L=ve=>{var re=an(),te=a(re),he=a(te);{var le=ue=>{var N=en(),ie=a(N,!0);t(N),K(()=>q(ie,f())),u(ue,N)};I(he,ue=>{f()&&ue(le)})}var i=r(he,2),E=a(i,!0);t(i),t(te);var se=r(te,2);{var ge=ue=>{var N=tn();R("click",N,p),u(ue,N)};I(se,ue=>{m()&&ue(ge)})}t(re),K(()=>{kt(re,1,`alert alert-${d()??""}`,"svelte-1frq9vu"),q(E,x())}),u(ve,re)};I(P,ve=>{e(v)&&ve(L)})}u(n,h)}var rn=w('<div class="loading-indicator svelte-zauskz"><span class="spinner svelte-zauskz"></span> Searching...</div>'),nn=w('<div role="option"><div class="airport-code svelte-zauskz"> </div> <div class="airport-info svelte-zauskz"><div class="airport-name svelte-zauskz"> </div> <div class="airport-location svelte-zauskz"> </div></div></div>'),sn=w('<div class="autocomplete-results svelte-zauskz"></div>'),on=w('<div class="autocomplete-container svelte-zauskz"><input type="text" style="text-transform: uppercase;" class="svelte-zauskz"/> <!> <!></div>');function Vr(n,s){Jt(s,!1);let d=Se(s,"value",12,""),f=Se(s,"placeholder",8,""),x=Se(s,"onSelect",8,N=>{}),m=ne([]),v=ne(!1),p=ne(!1),h=ne(),P=ne(-1);const L=(()=>{let N;return ie=>{if(clearTimeout(N),ie.length<2){o(m,[]),o(v,!1);return}o(p,!0),N=setTimeout(async()=>{try{const ye=await We(`/v1/airports/search?q=${encodeURIComponent(ie)}&limit=10`);o(m,ye.airports||[]),o(v,e(m).length>0)}catch(ye){console.error("Airport search error:",ye),o(m,[]),o(v,!1)}finally{o(p,!1)}},300)}})();function ve(N){d(N.target.value.toUpperCase()),o(P,-1),L(d())}function re(N){d(N.iata),o(m,[]),o(v,!1),o(P,-1),x()(N)}function te(N){if(e(v))switch(N.key){case"ArrowDown":N.preventDefault(),o(P,Math.min(e(P)+1,e(m).length-1));break;case"ArrowUp":N.preventDefault(),o(P,Math.max(e(P)-1,-1));break;case"Enter":N.preventDefault(),e(P)>=0&&re(e(m)[e(P)]);break;case"Escape":N.preventDefault(),o(v,!1),o(P,-1);break}}function he(){setTimeout(()=>{o(v,!1),o(P,-1)},200)}Va(()=>{function N(ie){e(h)&&!e(h).contains(ie.target)&&o(v,!1)}return document.addEventListener("click",N),()=>document.removeEventListener("click",N)}),Yt();var le=on(),i=a(le);be(i),dr(i,N=>o(h,N),()=>e(h));var E=r(i,2);{var se=N=>{var ie=rn();u(N,ie)};I(E,N=>{e(p)&&N(se)})}var ge=r(E,2);{var ue=N=>{var ie=sn();ut(ie,7,()=>e(m),ye=>ye.iata,(ye,U,z)=>{var k=nn();let Y;var H=a(k),g=a(H,!0);t(H);var W=r(H,2),C=a(W),S=a(C,!0);t(C);var y=r(C,2),_=a(y);t(y),t(W),t(k),K(()=>{Y=kt(k,1,"result-item svelte-zauskz",null,Y,{selected:e(P)===e(z)}),gt(k,"aria-selected",e(P)===e(z)),q(g,(e(U),c(()=>e(U).iata))),q(S,(e(U),c(()=>e(U).name))),q(_,`${e(U),c(()=>e(U).city)??""}, ${e(U),c(()=>e(U).country)??""}`)}),R("click",k,()=>re(e(U))),R("keydown",k,F=>F.key==="Enter"&&re(e(U))),u(ye,k)}),t(ie),u(N,ie)};I(ge,N=>{e(v),e(m),c(()=>e(v)&&e(m).length>0)&&N(ue)})}t(le),K(()=>gt(i,"placeholder",f())),xe(i,d),R("input",i,ve),R("keydown",i,te),R("focus",i,()=>d().length>=2&&e(m).length>0&&o(v,!0)),R("blur",i,he),u(n,le),Gt()}var ln=w('<span class="permission-badge svelte-1vsavbz">Can edit</span>'),dn=w('<span class="permission-badge view-only svelte-1vsavbz">View only</span>'),cn=w('<label class="companion-checkbox svelte-1vsavbz"><input type="checkbox" class="svelte-1vsavbz"/> <div class="companion-info svelte-1vsavbz"><div class="companion-avatar svelte-1vsavbz"> </div> <div class="companion-details svelte-1vsavbz"><span class="companion-email svelte-1vsavbz"> </span> <!></div></div></label>'),vn=w('<div class="companions-list svelte-1vsavbz"></div>'),un=w('<p class="no-companions svelte-1vsavbz">No companions added to this trip yet.</p>'),pn=w('<div class="companions-selector svelte-1vsavbz"><!></div>');function fn(n,s){Jt(s,!1),Se(s,"tripId",8,"");let d=Se(s,"currentItemCompanions",24,()=>[]),f=Se(s,"onCompanionsChange",8,null),x=ne([]),m=ne(new Set);Bt.subscribe(te=>{te.currentTrip&&te.currentTrip.travelCompanions&&o(x,te.currentTrip.travelCompanions)});function v(te){if(e(m).has(te)?e(m).delete(te):e(m).add(te),o(m,e(m)),f()){const he=e(x).filter(le=>e(m).has(le.id));f()(he)}}function p(te){return te?te.charAt(0).toUpperCase():"?"}function h(te){const he=["#FF6B6B","#4ECDC4","#45B7D1","#FFA07A","#98D8C8","#F7DC6F","#BB8FCE","#85C1E2","#F8B88B","#A9CCE3"],le=te.charCodeAt(0);return he[le%he.length]}pa(()=>Ae(d()),()=>{d()&&d().length>0&&o(m,new Set(d().map(te=>te.id)))}),Wa(),Yt();var P=pn(),L=a(P);{var ve=te=>{var he=vn();ut(he,5,()=>e(x),le=>le.id,(le,i)=>{var E=cn(),se=a(E);be(se);var ge=r(se,2),ue=a(ge),N=a(ue,!0);t(ue);var ie=r(ue,2),ye=a(ie),U=a(ye,!0);t(ye);var z=r(ye,2);{var k=H=>{var g=ln();u(H,g)},Y=H=>{var g=dn();u(H,g)};I(z,H=>{e(i),c(()=>e(i).canEdit)?H(k):H(Y,!1)})}t(ie),t(ge),t(E),K((H,g,W)=>{hr(se,H),xr(ue,`background-color: ${g??""}`),gt(ue,"title",(e(i),c(()=>e(i).email))),q(N,W),q(U,(e(i),c(()=>e(i).email)))},[()=>(e(m),e(i),c(()=>e(m).has(e(i).id))),()=>(e(i),c(()=>h(e(i).email))),()=>(e(i),c(()=>p(e(i).email)))]),R("change",se,()=>v(e(i).id)),u(le,E)}),t(he),u(te,he)},re=te=>{var he=un();u(te,he)};I(L,te=>{e(x),c(()=>e(x)&&e(x).length>0)?te(ve):te(re,!1)})}t(P),u(n,P),Gt()}var mn=w('<button class="clear-btn svelte-2ng4py">✕</button>'),hn=w('<button class="result-item svelte-2ng4py"><span class="result-name svelte-2ng4py"> </span> <span class="result-email svelte-2ng4py"> </span></button>'),gn=w('<div class="search-results svelte-2ng4py"></div>'),_n=w('<div class="search-results empty svelte-2ng4py"><p class="svelte-2ng4py">No companions found</p></div>'),yn=w('<div class="companion-item svelte-2ng4py"><div class="companion-info svelte-2ng4py"><span class="companion-email svelte-2ng4py"> </span></div> <button class="permission-toggle svelte-2ng4py"> </button> <button class="remove-btn svelte-2ng4py" title="Remove companion">✕</button></div>'),bn=w('<div class="companions-list svelte-2ng4py"><div class="list-header svelte-2ng4py"><span>Name</span> <span class="permission-col svelte-2ng4py">Permission</span> <span class="action-col svelte-2ng4py"></span></div> <!></div>'),xn=w('<p class="no-companions svelte-2ng4py">No companions added yet</p>'),Tn=w('<div class="trip-companions-form svelte-2ng4py"><h4 class="section-title svelte-2ng4py">Travel Companions</h4> <!> <div class="search-container svelte-2ng4py"><div class="search-box svelte-2ng4py"><input type="text" placeholder="Search companions by name or email..." class="search-input svelte-2ng4py"/> <!></div> <!></div> <!></div>');function Dn(n,s){Jt(s,!1);let d=Se(s,"tripId",8),f=Se(s,"companions",28,()=>[]),x=Se(s,"onCompanionsUpdate",8,null),m=ne(""),v=ne(!1),p=ne(null),h=ne([]),P=ne(!1),L=[],ve=!0;async function re(){try{ve=!0;const y=await Ar.getAll();L=Array.isArray(y)?y:y?.data||[]}catch(y){console.error("Failed to load companions:",y),L=[]}finally{ve=!1}}Va(()=>{re()});function te(y){return y.firstName&&y.lastName?`${y.firstName} ${y.lastName}`:y.firstName?y.firstName:y.lastName?y.lastName:y.email}function he(){if(!e(m).trim()){o(h,[]),o(P,!1);return}const y=e(m).toLowerCase(),_=new Set(f().map(F=>F.email));o(h,L.filter(F=>{if(_.has(F.email))return!1;const A=te(F);return F.email.toLowerCase().includes(y)||A.toLowerCase().includes(y)})),o(P,!0)}async function le(y){try{o(v,!0),o(p,null);const _=await Ar.addToTrip(d(),y.id,!1);f([...f(),_]),x()&&x()(f()),o(m,""),o(h,[]),o(P,!1)}catch(_){o(p,_ instanceof Error?_.message:"Failed to add companion")}finally{o(v,!1)}}async function i(y){try{o(v,!0),o(p,null),await Ar.removeFromTrip(d(),y),f(f().filter(_=>_.id!==y)),x()&&x()(f())}catch(_){o(p,_ instanceof Error?_.message:"Failed to remove companion")}finally{o(v,!1)}}function E(y){const _=f().find(F=>F.id===y);_&&(_.canEdit=!_.canEdit,f(f()),x()&&x()(f()))}function se(y){y.target.closest(".search-container")||o(P,!1)}Yt();var ge=Tn();R("click",Ni,se);var ue=r(a(ge),2);{var N=y=>{Ra(y,{type:"error",get message(){return e(p)},dismissible:!0})};I(ue,y=>{e(p)&&y(N)})}var ie=r(ue,2),ye=a(ie),U=a(ye);be(U);var z=r(U,2);{var k=y=>{var _=mn();K(()=>_.disabled=e(v)),R("click",_,()=>{o(m,""),o(h,[]),o(P,!1)}),u(y,_)};I(z,y=>{e(m)&&y(k)})}t(ye);var Y=r(ye,2);{var H=y=>{var _=gn();ut(_,5,()=>e(h),F=>F.id,(F,A)=>{var ae=hn(),ke=a(ae),de=a(ke,!0);t(ke);var pe=r(ke,2),B=a(pe,!0);t(pe),t(ae),K(J=>{ae.disabled=e(v),q(de,J),q(B,(e(A),c(()=>e(A).email)))},[()=>(e(A),c(()=>te(e(A))))]),R("click",ae,()=>le(e(A))),u(F,ae)}),t(_),u(y,_)},g=y=>{var _=je(),F=fe(_);{var A=ae=>{var ke=_n();u(ae,ke)};I(F,ae=>{e(P),e(m),e(h),c(()=>e(P)&&e(m).trim()&&e(h).length===0)&&ae(A)},!0)}u(y,_)};I(Y,y=>{e(P),e(h),c(()=>e(P)&&e(h).length>0)?y(H):y(g,!1)})}t(ie);var W=r(ie,2);{var C=y=>{var _=bn(),F=r(a(_),2);ut(F,1,f,A=>A.id,(A,ae)=>{var ke=yn(),de=a(ke),pe=a(de),B=a(pe,!0);t(pe),t(de);var J=r(de,2),Z=a(J,!0);t(J);var O=r(J,2);t(ke),K(()=>{q(B,(e(ae),c(()=>e(ae).email))),J.disabled=e(v),gt(J,"title",(e(ae),c(()=>e(ae).canEdit?"Click to make view-only":"Click to allow editing"))),q(Z,(e(ae),c(()=>e(ae).canEdit?"Can edit":"View only"))),O.disabled=e(v)}),R("click",J,()=>E(e(ae).id)),R("click",O,()=>i(e(ae).id)),u(A,ke)}),t(_),u(y,_)},S=y=>{var _=xn();u(y,_)};I(W,y=>{Ae(f()),c(()=>f()&&f().length>0)?y(C):y(S,!1)})}t(ge),K(()=>U.disabled=e(v)),xe(U,()=>e(m),y=>o(m,y)),R("input",U,he),R("focus",U,()=>{e(m).trim()&&o(P,!0)}),u(n,ge),Gt()}var wn=w('<div class="error-message"> </div>'),kn=w("<option> </option>"),Cn=w('<div class="form-group"><label>Companions</label> <!></div>'),En=w('<div class="form-group"><label for="tripSelector">Trip</label> <select id="tripSelector"><option>Standalone Item</option><!></select></div> <!>',1),jn=w('<span class="loading-indicator">Looking up...</span>'),Nn=w('<div class="form-row cols-3"><div class="form-group"><label for="flightNumber"> </label> <input type="text" id="flightNumber" name="flightNumber" placeholder="KL668"/></div> <div class="form-group" style="grid-column: span 2;"><label for="airline"> <!></label> <input type="text" id="airline" name="airline" readonly="" class="readonly"/></div></div> <div class="form-row cols-2"><div class="form-group"><label for="origin">Origin</label> <!></div> <div class="form-group"><label for="destination">Destination</label> <!></div></div> <div class="form-row cols-2"><div class="form-group"><label for="departureDate">Departure Date</label> <input type="date" id="departureDate" name="departureDate"/></div> <div class="form-group"><label for="departureTime">Departure Time</label> <input type="text" id="departureTime" name="departureTime" placeholder="HH:MM" maxlength="5"/></div></div> <div class="form-row cols-2"><div class="form-group"><label for="arrivalDate">Arrival Date</label> <input type="date" id="arrivalDate" name="arrivalDate"/></div> <div class="form-group"><label for="arrivalTime">Arrival Time</label> <input type="text" id="arrivalTime" name="arrivalTime" placeholder="HH:MM" maxlength="5"/></div></div> <div class="form-row cols-3"><div class="form-group" style="grid-column: span 2;"><label for="pnr">PNR</label> <input type="text" id="pnr" name="pnr" placeholder="ABC123D"/></div> <div class="form-group"><label for="seat">Seat</label> <input type="text" id="seat" name="seat" placeholder="4A"/></div></div>',1),Sn=w('<div class="form-group"><label for="name">Hotel Name</label> <input type="text" id="name" name="name" placeholder="W Bangkok" required/></div> <div class="form-group"><label for="address">Address</label> <textarea id="address" name="address" placeholder="Full address"></textarea></div> <div class="form-row cols-2"><div class="form-group"><label for="checkInDate">Check-in Date</label> <input type="date" id="checkInDate" name="checkInDate" required/></div> <div class="form-group"><label for="checkInTime">Check-in Time</label> <input type="text" id="checkInTime" name="checkInTime" placeholder="HH:MM" maxlength="5"/></div></div> <div class="form-row cols-2"><div class="form-group"><label for="checkOutDate">Check-out Date</label> <input type="date" id="checkOutDate" name="checkOutDate" required/></div> <div class="form-group"><label for="checkOutTime">Check-out Time</label> <input type="text" id="checkOutTime" name="checkOutTime" placeholder="HH:MM" maxlength="5"/></div></div> <div class="form-group"><label for="confirmationNumber">Confirmation Number</label> <input type="text" id="confirmationNumber" name="confirmationNumber"/></div> <div class="form-group"><label for="notes">Notes</label> <textarea id="notes" name="notes" placeholder="Additional information"></textarea></div>',1),Mn=w("<option> </option>"),In=w('<div class="form-group"><label for="method">Method</label> <select id="method" name="method" required><option>Select Method</option><!></select></div> <div class="form-row cols-2"><div class="form-group"><label for="origin">From</label> <input type="text" id="origin" name="origin" required/></div> <div class="form-group"><label for="destination">To</label> <input type="text" id="destination" name="destination" required/></div></div> <div class="form-row cols-2"><div class="form-group"><label for="departureDate">Departure Date</label> <input type="date" id="departureDate" name="departureDate" required/></div> <div class="form-group"><label for="departureTime">Departure Time</label> <input type="text" id="departureTime" name="departureTime" placeholder="HH:MM" maxlength="5"/></div></div> <div class="form-row cols-2"><div class="form-group"><label for="arrivalDate">Arrival Date</label> <input type="date" id="arrivalDate" name="arrivalDate" required/></div> <div class="form-group"><label for="arrivalTime">Arrival Time</label> <input type="text" id="arrivalTime" name="arrivalTime" placeholder="HH:MM" maxlength="5"/></div></div> <div class="form-group"><label for="bookingReference">Booking Reference</label> <input type="text" id="bookingReference" name="bookingReference"/></div> <div class="form-group"><label for="notes">Notes</label> <textarea id="notes" name="notes" placeholder="Additional information"></textarea></div>',1),An=w('<div class="form-row cols-2"><div class="form-group"><label for="company">Company</label> <input type="text" id="company" name="company" required/></div> <div class="form-group"><label for="pickupLocation">Pickup Location</label> <input type="text" id="pickupLocation" name="pickupLocation" required/></div></div> <div class="form-row cols-2"><div class="form-group"><label for="pickupDate">Pickup Date</label> <input type="date" id="pickupDate" name="pickupDate" required/></div> <div class="form-group"><label for="pickupTime">Pickup Time</label> <input type="text" id="pickupTime" name="pickupTime" placeholder="HH:MM" maxlength="5"/></div></div> <div class="form-group"><label for="dropoffLocation">Dropoff Location</label> <input type="text" id="dropoffLocation" name="dropoffLocation" required/></div> <div class="form-row cols-2"><div class="form-group"><label for="dropoffDate">Dropoff Date</label> <input type="date" id="dropoffDate" name="dropoffDate" required/></div> <div class="form-group"><label for="dropoffTime">Dropoff Time</label> <input type="text" id="dropoffTime" name="dropoffTime" placeholder="HH:MM" maxlength="5"/></div></div> <div class="form-group"><label for="confirmationNumber">Confirmation Number</label> <input type="text" id="confirmationNumber" name="confirmationNumber"/></div> <div class="form-group"><label for="notes">Notes</label> <textarea id="notes" name="notes" placeholder="Additional information"></textarea></div>',1),$n=w('<div class="form-group"><label for="name">Event Name</label> <input type="text" id="name" name="name" required/></div> <div class="form-group"><label for="location">Location</label> <input type="text" id="location" name="location" required/></div> <div class="form-group checkbox-group svelte-diniqf"><label for="allDay" class="svelte-diniqf"><input type="checkbox" id="allDay" name="allDay" class="svelte-diniqf"/> <span class="svelte-diniqf">All Day Event</span></label></div> <div class="form-row cols-2"><div class="form-group"><label for="startDate">Start Date</label> <input type="date" id="startDate" name="startDate" required/></div> <div class="form-group"><label for="startTime">Start Time</label> <input type="text" id="startTime" name="startTime" placeholder="HH:MM" maxlength="5"/></div></div> <div class="form-row cols-2"><div class="form-group"><label for="endDate">End Date</label> <input type="date" id="endDate" name="endDate"/></div> <div class="form-group"><label for="endTime">End Time</label> <input type="text" id="endTime" name="endTime" placeholder="HH:MM" maxlength="5"/></div></div> <div class="form-group"><label for="ticketNumber">Ticket Number</label> <input type="text" id="ticketNumber" name="ticketNumber"/></div> <div class="form-group"><label for="description">Description</label> <textarea id="description" name="description" placeholder="Event details"></textarea></div> <div class="form-group"><label for="notes">Notes</label> <textarea id="notes" name="notes" placeholder="Additional information"></textarea></div>',1),Pn=w('<input type="text"/>'),qn=w('<input type="date"/>'),Ln=w('<input type="text" maxlength="5"/>'),Rn=w("<option> </option>"),Fn=w("<select><option> </option><!></select>"),On=w("<textarea></textarea>"),zn=w('<div class="form-group"><label> </label> <!></div>'),Un=w("<!> <!>",1),Hn=w('<button type="button" class="delete-btn"> </button>'),Vn=w('<div class="edit-panel"><div class="edit-header"><div class="header-left"><button class="back-btn"><svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></button> <h3> </h3></div> <div class="icon-badge"><span class="material-symbols-outlined"> </span></div></div> <form class="edit-content"><!> <div class="form-fields"><!> <!></div> <div class="form-buttons"><button type="submit" class="submit-btn"> </button> <button type="button" class="cancel-btn">Cancel</button></div> <!></form></div>');function Bn(n,s){Jt(s,!1);const d=ne(),f=ne(),x=ne(),m=ne();let v=Se(s,"itemType",8),p=Se(s,"data",12,null),h=Se(s,"tripId",8,""),P=Se(s,"allTrips",24,()=>[]),L=Se(s,"onClose",8,()=>{}),ve=Se(s,"onSave",8,()=>{}),re=ne(!1),te=ne(null);function he(M){if(!M)return new Date(0);const[V,X,_e]=M.split("-").map(Number);return new Date(V,X-1,_e,0,0,0,0)}function le(M){if(!M)return{};const V={...M};if(v()==="flight"&&M.departureDateTime){const X=wa(M.departureDateTime,M.originTimezone);if(X){const[_e,Ie]=X.split("T");V.departureDate=_e,V.departureTime=Ie}if(M.arrivalDateTime){const _e=wa(M.arrivalDateTime,M.destinationTimezone);if(_e){const[Ie,Pe]=_e.split("T");V.arrivalDate=Ie,V.arrivalTime=Pe}}}if(v()==="hotel"&&M.checkInDateTime){const X=wa(M.checkInDateTime,M.timezone);if(X){const[_e,Ie]=X.split("T");V.checkInDate=_e,V.checkInTime=Ie}if(M.checkOutDateTime){const _e=wa(M.checkOutDateTime,M.timezone);if(_e){const[Ie,Pe]=_e.split("T");V.checkOutDate=Ie,V.checkOutTime=Pe}}}if(v()==="hotel"&&M.hotelName&&!M.name&&(V.name=M.hotelName),v()==="event"&&M.startDateTime){const X=wa(M.startDateTime,M.timezone);if(X){const[_e,Ie]=X.split("T");V.startDate=_e,V.startTime=Ie}if(M.endDateTime){const _e=wa(M.endDateTime,M.timezone);if(_e){const[Ie,Pe]=_e.split("T");V.endDate=Ie,V.endTime=Pe}}V.startTime==="00:00"&&V.endTime==="23:59"&&(V.allDay=!0)}if(v()==="transportation"&&M.departureDateTime){const X=wa(M.departureDateTime,M.originTimezone);if(X){const[_e,Ie]=X.split("T");V.departureDate=_e,V.departureTime=Ie}if(M.arrivalDateTime){const _e=wa(M.arrivalDateTime,M.destinationTimezone);if(_e){const[Ie,Pe]=_e.split("T");V.arrivalDate=Ie,V.arrivalTime=Pe}}}if(v()==="carRental"&&M.pickupDateTime){const X=wa(M.pickupDateTime,M.pickupTimezone);if(X){const[_e,Ie]=X.split("T");V.pickupDate=_e,V.pickupTime=Ie}if(M.dropoffDateTime){const _e=wa(M.dropoffDateTime,M.dropoffTimezone);if(_e){const[Ie,Pe]=_e.split("T");V.dropoffDate=Ie,V.dropoffTime=Pe}}}return V}let i=ne(le(p())),E=ne(!1),se=ne(""),ge=ne([]);async function ue(){if(!(v()!=="flight"||!e(i).flightNumber)){o(E,!0);try{const M=await or.lookupAirline(e(i).flightNumber);M&&M.name&&Q(i,e(i).airline=M.name)}catch(M){console.debug("Airline lookup failed:",M)}finally{o(E,!1)}}}function N(M){const V=M.target;let X=V.value.replace(/\D/g,"");X.length>0&&(X.length<=2?X=X:X.length===3?X=X.slice(0,2)+":"+X.slice(2):X=X.slice(0,2)+":"+X.slice(2,4)),V.value=X;const _e=V.name;_e&&(Q(i,e(i)[_e]=X),console.log("[ItemEditForm] formatTimeInput updated",_e,"=",X))}function ie(){return{trip:{title:e(d)?"Edit Trip":"Add Trip",fields:[{name:"name",label:"Trip Name",type:"text",required:!0,placeholder:"Summer Vacation"},{name:"purpose",label:"Purpose",type:"select",options:["leisure","business","family","romantic","adventure"],required:!0},{name:"departureDate",label:"Departure Date",type:"date",required:!0},{name:"returnDate",label:"Return Date",type:"date",required:!0},{name:"notes",label:"Notes",type:"textarea"}]},flight:{title:e(d)?"Edit Flight":"Add Flight",fields:[{name:"flightNumber",label:"Flight Number",type:"text",required:!0,placeholder:"KL668"},{name:"airline",label:"Airline",type:"text",readonly:!0},{name:"origin",label:"Origin",type:"airport",required:!0,placeholder:"AUS"},{name:"destination",label:"Destination",type:"airport",required:!0,placeholder:"AMS"},{name:"departureDate",label:"Departure Date",type:"date",required:!0},{name:"departureTime",label:"Departure Time",type:"time",required:!0,placeholder:"HH:MM"},{name:"arrivalDate",label:"Arrival Date",type:"date",required:!0},{name:"arrivalTime",label:"Arrival Time",type:"time",required:!0,placeholder:"HH:MM"},{name:"pnr",label:"PNR",type:"text",placeholder:"ABC123D"},{name:"seat",label:"Seat",type:"text",placeholder:"4A"}]},hotel:{title:e(d)?"Edit Hotel":"Add Hotel",fields:[{name:"name",label:"Hotel Name",type:"text",required:!0},{name:"address",label:"Address",type:"text",required:!0},{name:"checkInDate",label:"Check In Date",type:"date",required:!0},{name:"checkInTime",label:"Check In Time",type:"time",placeholder:"HH:MM"},{name:"checkOutDate",label:"Check Out Date",type:"date",required:!0},{name:"checkOutTime",label:"Check Out Time",type:"time",placeholder:"HH:MM"},{name:"confirmationNumber",label:"Confirmation Number",type:"text"},{name:"notes",label:"Notes",type:"textarea"}]},transportation:{title:e(d)?"Edit Transportation":"Add Transportation",fields:[{name:"method",label:"Method",type:"select",options:["train","bus","ferry","shuttle","taxi","rideshare","subway","metro","tram","other"],required:!0},{name:"origin",label:"From",type:"text",required:!0},{name:"destination",label:"To",type:"text",required:!0},{name:"departureDate",label:"Departure Date",type:"date",required:!0},{name:"departureTime",label:"Departure Time",type:"time",placeholder:"HH:MM"},{name:"arrivalDate",label:"Arrival Date",type:"date",required:!0},{name:"arrivalTime",label:"Arrival Time",type:"time",placeholder:"HH:MM"},{name:"bookingReference",label:"Booking Reference",type:"text"},{name:"notes",label:"Notes",type:"textarea"}]},carRental:{title:e(d)?"Edit Car Rental":"Add Car Rental",fields:[{name:"company",label:"Company",type:"text",required:!0},{name:"pickupLocation",label:"Pickup Location",type:"text",required:!0},{name:"pickupDate",label:"Pickup Date",type:"date",required:!0},{name:"pickupTime",label:"Pickup Time",type:"time",placeholder:"HH:MM"},{name:"dropoffLocation",label:"Dropoff Location",type:"text",required:!0},{name:"dropoffDate",label:"Dropoff Date",type:"date",required:!0},{name:"dropoffTime",label:"Dropoff Time",type:"time",placeholder:"HH:MM"},{name:"confirmationNumber",label:"Confirmation Number",type:"text"},{name:"notes",label:"Notes",type:"textarea"}]},event:{title:e(d)?"Edit Event":"Add Event",fields:[{name:"name",label:"Event Name",type:"text",required:!0},{name:"location",label:"Location",type:"text",required:!0},{name:"startDate",label:"Start Date",type:"date",required:!0},{name:"endDate",label:"End Date",type:"date"},{name:"allDay",label:"All Day Event",type:"checkbox"},{name:"startTime",label:"Start Time",type:"time",placeholder:"HH:MM"},{name:"endTime",label:"End Time",type:"time",placeholder:"HH:MM"},{name:"description",label:"Description",type:"textarea"},{name:"ticketNumber",label:"Ticket Number",type:"text"},{name:"notes",label:"Notes",type:"textarea"}]}}}async function ye(){o(re,!0),o(te,null);try{let M;const V=e(se)||h(),X={...e(i)};v()==="flight"||v()==="transportation"?(delete X.departureDateTime,delete X.arrivalDateTime):v()==="hotel"?(delete X.checkInDateTime,delete X.checkOutDateTime):v()==="carRental"?(delete X.pickupDateTime,delete X.dropoffDateTime):v()==="event"&&(delete X.startDateTime,delete X.endDateTime),v()!=="trip"&&(e(d)?X.tripId=e(se)||null:e(se)&&(X.tripId=e(se))),console.log("[ItemEditForm] Before submit - formData:",{departureDate:e(i).departureDate,departureTime:e(i).departureTime,arrivalDate:e(i).arrivalDate,arrivalTime:e(i).arrivalTime,originTimezone:e(i).originTimezone,destinationTimezone:e(i).destinationTimezone}),console.log("[ItemEditForm] Submitting:",{itemType:v(),isEditing:e(d),tripId:V,data:X}),v()==="trip"?e(d)?M=await Ya.update(p().id,e(i)):M=await Ya.create(e(i)):v()==="flight"?e(d)?(console.log("[ItemEditForm] Updating flight with:",X),M=await or.update(p().id,X)):M=await or.create(V,X):v()==="hotel"?e(d)?M=await gr.update(p().id,X):M=await gr.create(V,X):v()==="event"?e(d)?M=await _r.update(p().id,X):M=await _r.create(V,X):v()==="transportation"?e(d)?M=await yr.update(p().id,X):M=await yr.create(V,X):v()==="carRental"&&(e(d)?M=await br.update(p().id,X):M=await br.create(V,X)),console.log("[ItemEditForm] Save successful, result:",M),ve()(M||X),L()()}catch(M){console.error("[ItemEditForm] Save failed:",M),o(te,M instanceof Error?M.message:"An error occurred")}finally{o(re,!1)}}function U(M){return{trip:"flight_takeoff",flight:"flight",hotel:"hotel",event:"event",transportation:"directions_car",carRental:"directions_car",voucher:"card_giftcard"}[M]||"info"}async function z(){if(confirm(`Delete this ${v()}?`)){o(re,!0),o(te,null);try{v()==="trip"?await Ya.delete(p().id):v()==="flight"?await or.delete(p().id):v()==="hotel"?await gr.delete(p().id):v()==="event"?await _r.delete(p().id):v()==="transportation"?await yr.delete(p().id):v()==="carRental"&&await br.delete(p().id),ve()(null),L()()}catch(M){const V=M instanceof Error?M.message:String(M);V.includes("pattern")||V.includes("string")?(console.debug("Ignoring validation error after delete:",V),ve()(null),L()()):o(te,V)}finally{o(re,!1)}}}pa(()=>Ae(p()),()=>{o(d,!!p()?.id)}),pa(()=>Ae(v()),()=>{o(f,v()!=="trip")}),pa(()=>Ae(P()),()=>{o(x,P().filter(M=>{const V=new Date;V.setHours(0,0,0,0);const X=M.departureDate?he(M.departureDate):null;return X&&X>=V}))}),pa(()=>Ae(p()),()=>{if(p()){const M=le(p());o(i,M),o(se,p()?.tripId||""),o(ge,p()?.travelCompanions||[])}}),pa(()=>Ae(v()),()=>{o(m,ie()[v()])}),Wa(),Yt();var k=Vn(),Y=a(k),H=a(Y),g=a(H),W=r(g,2),C=a(W,!0);t(W),t(H);var S=r(H,2),y=a(S),_=a(y,!0);t(y),t(S),t(Y);var F=r(Y,2),A=a(F);{var ae=M=>{var V=wn(),X=a(V,!0);t(V),K(()=>q(X,e(te))),u(M,V)};I(A,M=>{e(te)&&M(ae)})}var ke=r(A,2),de=a(ke);{var pe=M=>{var V=En(),X=fe(V),_e=r(a(X),2);K(()=>{e(se),lr(()=>{e(x)})});var Ie=a(_e);Ie.value=Ie.__value="";var Pe=r(Ie);ut(Pe,1,()=>e(x),et=>et.id,(et,tt)=>{var Xe=kn(),Ne=a(Xe,!0);t(Xe);var l={};K(()=>{q(Ne,(e(tt),c(()=>e(tt).name))),l!==(l=(e(tt),c(()=>e(tt).id)))&&(Xe.value=(Xe.__value=(e(tt),c(()=>e(tt).id)))??"")}),u(et,Xe)}),t(_e),t(X);var _t=r(X,2);{var At=et=>{var tt=Cn(),Xe=r(a(tt),2);fn(Xe,{get tripId(){return e(se)},get currentItemCompanions(){return e(ge)},onCompanionsChange:Ne=>{o(ge,Ne)}}),t(tt),u(et,tt)};I(_t,et=>{e(se)&&et(At)})}cr(_e,()=>e(se),et=>o(se,et)),u(M,V)};I(de,M=>{e(f)&&M(pe)})}var B=r(de,2);{var J=M=>{var V=Nn(),X=fe(V),_e=a(X),Ie=a(_e),Pe=a(Ie,!0);t(Ie);var _t=r(Ie,2);be(_t),t(_e);var At=r(_e,2),et=a(At),tt=a(et),Xe=r(tt);{var Ne=me=>{var He=jn();u(me,He)};I(Xe,me=>{e(E)&&me(Ne)})}t(et);var l=r(et,2);be(l),t(At),t(X);var j=r(X,2),b=a(j),T=r(a(b),2);Vr(T,{id:"origin",placeholder:"AUS",onSelect:me=>{Q(i,e(i).origin=me.iata)},get value(){return e(i).origin},set value(me){Q(i,e(i).origin=me)},$$legacy:!0}),t(b);var $=r(b,2),oe=r(a($),2);Vr(oe,{id:"destination",placeholder:"AMS",onSelect:me=>{Q(i,e(i).destination=me.iata)},get value(){return e(i).destination},set value(me){Q(i,e(i).destination=me)},$$legacy:!0}),t($),t(j);var we=r(j,2),Ce=a(we),Te=r(a(Ce),2);be(Te),t(Ce);var $e=r(Ce,2),ze=r(a($e),2);be(ze),t($e),t(we);var Ze=r(we,2),Ge=a(Ze),Ee=r(a(Ge),2);be(Ee),t(Ge);var G=r(Ge,2),Ye=r(a(G),2);be(Ye),t(G),t(Ze);var Oe=r(Ze,2),Re=a(Oe),Ue=r(a(Re),2);be(Ue),t(Re);var Ve=r(Re,2),st=r(a(Ve),2);be(st),t(Ve),t(Oe),K((me,He)=>{q(Pe,me),q(tt,`${He??""} `)},[()=>(e(m),c(()=>e(m).fields.find(me=>me.name==="flightNumber")?.label)),()=>(e(m),c(()=>e(m).fields.find(me=>me.name==="airline")?.label))]),xe(_t,()=>e(i).flightNumber,me=>Q(i,e(i).flightNumber=me)),R("blur",_t,ue),xe(l,()=>e(i).airline,me=>Q(i,e(i).airline=me)),xe(Te,()=>e(i).departureDate,me=>Q(i,e(i).departureDate=me)),xe(ze,()=>e(i).departureTime,me=>Q(i,e(i).departureTime=me)),R("keyup",ze,N),xe(Ee,()=>e(i).arrivalDate,me=>Q(i,e(i).arrivalDate=me)),xe(Ye,()=>e(i).arrivalTime,me=>Q(i,e(i).arrivalTime=me)),R("keyup",Ye,N),xe(Ue,()=>e(i).pnr,me=>Q(i,e(i).pnr=me)),xe(st,()=>e(i).seat,me=>Q(i,e(i).seat=me)),u(M,V)},Z=M=>{var V=je(),X=fe(V);{var _e=Pe=>{var _t=Sn(),At=fe(_t),et=r(a(At),2);be(et),t(At);var tt=r(At,2),Xe=r(a(tt),2);La(Xe),t(tt);var Ne=r(tt,2),l=a(Ne),j=r(a(l),2);be(j),t(l);var b=r(l,2),T=r(a(b),2);be(T),t(b),t(Ne);var $=r(Ne,2),oe=a($),we=r(a(oe),2);be(we),t(oe);var Ce=r(oe,2),Te=r(a(Ce),2);be(Te),t(Ce),t($);var $e=r($,2),ze=r(a($e),2);be(ze),t($e);var Ze=r($e,2),Ge=r(a(Ze),2);La(Ge),t(Ze),xe(et,()=>e(i).name,Ee=>Q(i,e(i).name=Ee)),xe(Xe,()=>e(i).address,Ee=>Q(i,e(i).address=Ee)),xe(j,()=>e(i).checkInDate,Ee=>Q(i,e(i).checkInDate=Ee)),xe(T,()=>e(i).checkInTime,Ee=>Q(i,e(i).checkInTime=Ee)),R("keyup",T,N),xe(we,()=>e(i).checkOutDate,Ee=>Q(i,e(i).checkOutDate=Ee)),xe(Te,()=>e(i).checkOutTime,Ee=>Q(i,e(i).checkOutTime=Ee)),R("keyup",Te,N),xe(ze,()=>e(i).confirmationNumber,Ee=>Q(i,e(i).confirmationNumber=Ee)),xe(Ge,()=>e(i).notes,Ee=>Q(i,e(i).notes=Ee)),u(Pe,_t)},Ie=Pe=>{var _t=je(),At=fe(_t);{var et=Xe=>{var Ne=In(),l=fe(Ne),j=r(a(l),2);K(()=>{e(i),lr(()=>{})});var b=a(j);b.value=b.__value="";var T=r(b);ut(T,0,()=>["train","bus","ferry","shuttle","taxi","rideshare","subway","metro","tram","other"],ha,(De,at)=>{var it=Mn(),Fe=a(it,!0);t(it);var nt={};K(()=>{q(Fe,at),nt!==(nt=at)&&(it.value=(it.__value=at)??"")}),u(De,it)}),t(j),t(l);var $=r(l,2),oe=a($),we=r(a(oe),2);be(we),t(oe);var Ce=r(oe,2),Te=r(a(Ce),2);be(Te),t(Ce),t($);var $e=r($,2),ze=a($e),Ze=r(a(ze),2);be(Ze),t(ze);var Ge=r(ze,2),Ee=r(a(Ge),2);be(Ee),t(Ge),t($e);var G=r($e,2),Ye=a(G),Oe=r(a(Ye),2);be(Oe),t(Ye);var Re=r(Ye,2),Ue=r(a(Re),2);be(Ue),t(Re),t(G);var Ve=r(G,2),st=r(a(Ve),2);be(st),t(Ve);var me=r(Ve,2),He=r(a(me),2);La(He),t(me),cr(j,()=>e(i).method,De=>Q(i,e(i).method=De)),xe(we,()=>e(i).origin,De=>Q(i,e(i).origin=De)),xe(Te,()=>e(i).destination,De=>Q(i,e(i).destination=De)),xe(Ze,()=>e(i).departureDate,De=>Q(i,e(i).departureDate=De)),xe(Ee,()=>e(i).departureTime,De=>Q(i,e(i).departureTime=De)),R("keyup",Ee,N),xe(Oe,()=>e(i).arrivalDate,De=>Q(i,e(i).arrivalDate=De)),xe(Ue,()=>e(i).arrivalTime,De=>Q(i,e(i).arrivalTime=De)),R("keyup",Ue,N),xe(st,()=>e(i).bookingReference,De=>Q(i,e(i).bookingReference=De)),xe(He,()=>e(i).notes,De=>Q(i,e(i).notes=De)),u(Xe,Ne)},tt=Xe=>{var Ne=je(),l=fe(Ne);{var j=T=>{var $=An(),oe=fe($),we=a(oe),Ce=r(a(we),2);be(Ce),t(we);var Te=r(we,2),$e=r(a(Te),2);be($e),t(Te),t(oe);var ze=r(oe,2),Ze=a(ze),Ge=r(a(Ze),2);be(Ge),t(Ze);var Ee=r(Ze,2),G=r(a(Ee),2);be(G),t(Ee),t(ze);var Ye=r(ze,2),Oe=r(a(Ye),2);be(Oe),t(Ye);var Re=r(Ye,2),Ue=a(Re),Ve=r(a(Ue),2);be(Ve),t(Ue);var st=r(Ue,2),me=r(a(st),2);be(me),t(st),t(Re);var He=r(Re,2),De=r(a(He),2);be(De),t(He);var at=r(He,2),it=r(a(at),2);La(it),t(at),xe(Ce,()=>e(i).company,Fe=>Q(i,e(i).company=Fe)),xe($e,()=>e(i).pickupLocation,Fe=>Q(i,e(i).pickupLocation=Fe)),xe(Ge,()=>e(i).pickupDate,Fe=>Q(i,e(i).pickupDate=Fe)),xe(G,()=>e(i).pickupTime,Fe=>Q(i,e(i).pickupTime=Fe)),R("keyup",G,N),xe(Oe,()=>e(i).dropoffLocation,Fe=>Q(i,e(i).dropoffLocation=Fe)),xe(Ve,()=>e(i).dropoffDate,Fe=>Q(i,e(i).dropoffDate=Fe)),xe(me,()=>e(i).dropoffTime,Fe=>Q(i,e(i).dropoffTime=Fe)),R("keyup",me,N),xe(De,()=>e(i).confirmationNumber,Fe=>Q(i,e(i).confirmationNumber=Fe)),xe(it,()=>e(i).notes,Fe=>Q(i,e(i).notes=Fe)),u(T,$)},b=T=>{var $=je(),oe=fe($);{var we=Te=>{var $e=$n(),ze=fe($e),Ze=r(a(ze),2);be(Ze),t(ze);var Ge=r(ze,2),Ee=r(a(Ge),2);be(Ee),t(Ge);var G=r(Ge,2),Ye=a(G),Oe=a(Ye);be(Oe),Ft(2),t(Ye),t(G);var Re=r(G,2),Ue=a(Re),Ve=r(a(Ue),2);be(Ve),t(Ue);var st=r(Ue,2),me=r(a(st),2);be(me),t(st),t(Re);var He=r(Re,2),De=a(He),at=r(a(De),2);be(at),t(De);var it=r(De,2),Fe=r(a(it),2);be(Fe),t(it),t(He);var nt=r(He,2),Be=r(a(nt),2);be(Be),t(nt);var Tt=r(nt,2),Wt=r(a(Tt),2);La(Wt),t(Tt);var Dt=r(Tt,2),ot=r(a(Dt),2);La(ot),t(Dt),K(()=>{me.disabled=(e(i),c(()=>e(i).allDay)),Fe.disabled=(e(i),c(()=>e(i).allDay))}),xe(Ze,()=>e(i).name,qe=>Q(i,e(i).name=qe)),xe(Ee,()=>e(i).location,qe=>Q(i,e(i).location=qe)),ei(Oe,()=>e(i).allDay,qe=>Q(i,e(i).allDay=qe)),xe(Ve,()=>e(i).startDate,qe=>Q(i,e(i).startDate=qe)),xe(me,()=>e(i).startTime,qe=>Q(i,e(i).startTime=qe)),R("keyup",me,N),xe(at,()=>e(i).endDate,qe=>Q(i,e(i).endDate=qe)),xe(Fe,()=>e(i).endTime,qe=>Q(i,e(i).endTime=qe)),R("keyup",Fe,N),xe(Be,()=>e(i).ticketNumber,qe=>Q(i,e(i).ticketNumber=qe)),xe(Wt,()=>e(i).description,qe=>Q(i,e(i).description=qe)),xe(ot,()=>e(i).notes,qe=>Q(i,e(i).notes=qe)),u(Te,$e)},Ce=Te=>{var $e=Un(),ze=fe($e);ut(ze,1,()=>(e(m),c(()=>e(m).fields)),ha,(Ee,G)=>{var Ye=zn(),Oe=a(Ye),Re=a(Oe,!0);t(Oe);var Ue=r(Oe,2);{var Ve=me=>{var He=Pn();be(He),K(()=>{gt(He,"id",(e(G),c(()=>e(G).name))),gt(He,"name",(e(G),c(()=>e(G).name))),gt(He,"placeholder",(e(G),c(()=>e(G).placeholder))),He.required=(e(G),c(()=>e(G).required)),He.readOnly=(e(G),c(()=>e(G).readonly)),kt(He,1,Ii((e(G),c(()=>e(G).readonly?"readonly":""))))}),xe(He,()=>e(i)[e(G).name],De=>Q(i,e(i)[e(G).name]=De)),u(me,He)},st=me=>{var He=je(),De=fe(He);{var at=Fe=>{var nt=qn();be(nt),K(()=>{gt(nt,"id",(e(G),c(()=>e(G).name))),gt(nt,"name",(e(G),c(()=>e(G).name))),nt.required=(e(G),c(()=>e(G).required))}),xe(nt,()=>e(i)[e(G).name],Be=>Q(i,e(i)[e(G).name]=Be)),u(Fe,nt)},it=Fe=>{var nt=je(),Be=fe(nt);{var Tt=Dt=>{var ot=Ln();be(ot),K(()=>{gt(ot,"id",(e(G),c(()=>e(G).name))),gt(ot,"name",(e(G),c(()=>e(G).name))),gt(ot,"placeholder",(e(G),c(()=>e(G).placeholder)))}),xe(ot,()=>e(i)[e(G).name],qe=>Q(i,e(i)[e(G).name]=qe)),R("keyup",ot,N),u(Dt,ot)},Wt=Dt=>{var ot=je(),qe=fe(ot);{var yt=Nt=>{var bt=Fn();K(()=>{e(i),lr(()=>{e(G)})});var dt=a(bt),Pt=a(dt);t(dt),dt.value=dt.__value="";var qt=r(dt);ut(qt,1,()=>(e(G),c(()=>e(G).options)),ha,(Ct,xt)=>{var D=Rn(),ga=a(D,!0);t(D);var Qe={};K(()=>{q(ga,e(xt)),Qe!==(Qe=e(xt))&&(D.value=(D.__value=e(xt))??"")}),u(Ct,D)}),t(bt),K(()=>{gt(bt,"id",(e(G),c(()=>e(G).name))),gt(bt,"name",(e(G),c(()=>e(G).name))),bt.required=(e(G),c(()=>e(G).required)),q(Pt,`Select ${e(G),c(()=>e(G).label)??""}`)}),cr(bt,()=>e(i)[e(G).name],Ct=>Q(i,e(i)[e(G).name]=Ct)),u(Nt,bt)},$t=Nt=>{var bt=je(),dt=fe(bt);{var Pt=qt=>{var Ct=On();La(Ct),K(()=>{gt(Ct,"id",(e(G),c(()=>e(G).name))),gt(Ct,"name",(e(G),c(()=>e(G).name))),gt(Ct,"placeholder",(e(G),c(()=>e(G).placeholder)))}),xe(Ct,()=>e(i)[e(G).name],xt=>Q(i,e(i)[e(G).name]=xt)),u(qt,Ct)};I(dt,qt=>{e(G),c(()=>e(G).type==="textarea")&&qt(Pt)},!0)}u(Nt,bt)};I(qe,Nt=>{e(G),c(()=>e(G).type==="select")?Nt(yt):Nt($t,!1)},!0)}u(Dt,ot)};I(Be,Dt=>{e(G),c(()=>e(G).type==="time")?Dt(Tt):Dt(Wt,!1)},!0)}u(Fe,nt)};I(De,Fe=>{e(G),c(()=>e(G).type==="date")?Fe(at):Fe(it,!1)},!0)}u(me,He)};I(Ue,me=>{e(G),c(()=>e(G).type==="text")?me(Ve):me(st,!1)})}t(Ye),K(()=>{gt(Oe,"for",(e(G),c(()=>e(G).name))),q(Re,(e(G),c(()=>e(G).label)))}),u(Ee,Ye)});var Ze=r(ze,2);{var Ge=Ee=>{{let G=Ke(()=>(Ae(p()),c(()=>p().travelCompanions||[])));Dn(Ee,{get tripId(){return Ae(p()),c(()=>p().id)},get companions(){return e(G)},onCompanionsUpdate:Ye=>{p()&&p(p().travelCompanions=Ye,!0)}})}};I(Ze,Ee=>{Ae(v()),e(d),Ae(p()),c(()=>v()==="trip"&&e(d)&&p()?.id)&&Ee(Ge)})}u(Te,$e)};I(oe,Te=>{v()==="event"?Te(we):Te(Ce,!1)},!0)}u(T,$)};I(l,T=>{v()==="carRental"?T(j):T(b,!1)},!0)}u(Xe,Ne)};I(At,Xe=>{v()==="transportation"?Xe(et):Xe(tt,!1)},!0)}u(Pe,_t)};I(X,Pe=>{v()==="hotel"?Pe(_e):Pe(Ie,!1)},!0)}u(M,V)};I(B,M=>{v()==="flight"?M(J):M(Z,!1)})}t(ke);var O=r(ke,2),ce=a(O),Me=a(ce);t(ce);var Le=r(ce,2);t(O);var pt=r(O,2);{var Je=M=>{var V=Hn(),X=a(V);t(V),K(()=>{V.disabled=e(re),q(X,`Delete ${v()??""}`)}),R("click",V,z),u(M,V)};I(pt,M=>{e(d)&&M(Je)})}t(F),t(k),K(M=>{q(C,(e(m),c(()=>e(m).title))),gt(S,"data-type",v()),q(_,M),ce.disabled=e(re),q(Me,`${e(d)?"Update":"Add"} ${v()??""}`),Le.disabled=e(re)},[()=>(Ae(v()),c(()=>U(v())))]),R("click",g,function(...M){L()?.apply(this,M)}),R("click",Le,function(...M){L()?.apply(this,M)}),R("submit",F,ur(ye)),u(n,k),Gt()}var Jn=w('<span class="material-symbols-outlined"> </span>'),Gn=w('<div class="flight-info svelte-1qvkaye"><div class="flight-line svelte-1qvkaye"> </div> <div class="flight-line svelte-1qvkaye"> </div></div>'),Yn=w('<span class="item-label svelte-1qvkaye"> </span>'),Wn=w('<div role="button" tabindex="0"><!> <!></div>'),Zn=w('<span class="day-number svelte-1qvkaye"> </span>'),Kn=w("<div><!></div>"),Xn=w('<div class="month-row svelte-1qvkaye"><div class="month-label svelte-1qvkaye"><div class="month-name svelte-1qvkaye"> </div> <div class="year svelte-1qvkaye"> </div></div> <div class="days-grid svelte-1qvkaye"><div class="items-layer svelte-1qvkaye"></div> <!></div></div>'),Qn=w('<div class="calendar-container svelte-1qvkaye"><div class="calendar-grid svelte-1qvkaye"></div></div>');function es(n,s){Jt(s,!1);let d=Se(s,"trips",24,()=>[]),f=Se(s,"standaloneItems",24,()=>({flights:[],hotels:[],transportation:[],carRentals:[],events:[]})),x=Se(s,"onItemClick",8,()=>{});const m=["January","February","March","April","May","June","July","August","September","October","November","December"],v={trip:"#28536b",flight:"#d4a823",hotel:"#9b6db3",event:"#d6389f",transportation:"#2b7ab6",carRental:"#d97a2f"};let p=ne([]),h={},P=ne({}),L=new Date;const ve=new Set(["2026-01-01","2026-01-19","2026-05-25","2026-06-19","2026-07-03","2026-09-07","2026-11-26","2026-11-27","2026-12-24","2026-12-25","2026-12-28","2026-12-29","2026-12-30","2026-12-31"]);function re(z){return z?ve.has(z):!1}function te(z){const k=z.getUTCFullYear(),Y=String(z.getUTCMonth()+1).padStart(2,"0"),H=String(z.getUTCDate()).padStart(2,"0");return`${k}-${Y}-${H}`}function he(z){const[k,Y,H]=z.split("-").map(Number);return new Date(k,Y-1,H,0,0,0,0)}function le(z){const k=new Date(z);return k.setHours(0,0,0,0),k}function i(){L=new Date,L.setHours(0,0,0,0),h={};const z=new Date(L);z.setMonth(L.getMonth()-3),z.setDate(1);const k=new Date(L);k.setMonth(L.getMonth()+15),k.setDate(1);function Y(g,W){h[g]||(h[g]=[]),h[g].some(C=>C.id===W.id)||h[g].push(W)}function H(g){const W=te(g.startDate);Y(W,g);let C=new Date(g.startDate);for(C.setMonth(C.getMonth()+1),C.setDate(1);C<=g.endDate;){const S=te(C);Y(S,g),C.setMonth(C.getMonth()+1)}}d().forEach(g=>{if(!g.departureDate||!g.returnDate)return;const W=he(g.departureDate),C=he(g.returnDate),S=Math.ceil((C.getTime()-W.getTime())/(1e3*60*60*24))+1,y={id:g.id,type:"trip",data:g,startDate:W,endDate:C,durationDays:S};H(y),g.flights&&g.flights.forEach(_=>{if(!_.departureDateTime)return;let F=new Date(_.departureDateTime);F.setHours(0,0,0,0);let A=new Date(_.arrivalDateTime||_.departureDateTime);A.setHours(0,0,0,0);const ae=Math.ceil((A.getTime()-F.getTime())/(1e3*60*60*24))+1;H({id:_.id,type:"flight",data:_,startDate:F,endDate:A,durationDays:ae})}),g.hotels&&g.hotels.forEach(_=>{if(!_.checkInDateTime)return;let F=new Date(_.checkInDateTime);F.setHours(0,0,0,0);let A=new Date(_.checkOutDateTime||_.checkInDateTime);A.setHours(0,0,0,0);const ae=Math.ceil((A.getTime()-F.getTime())/(1e3*60*60*24))+1;H({id:_.id,type:"hotel",data:_,startDate:F,endDate:A,durationDays:ae})}),g.events&&g.events.forEach(_=>{if(!_.startDateTime)return;let F=new Date(_.startDateTime);F.setHours(0,0,0,0);let A=new Date(_.endDateTime||_.startDateTime);A.setHours(0,0,0,0);const ae=Math.ceil((A.getTime()-F.getTime())/(1e3*60*60*24))+1;H({id:_.id,type:"event",data:_,startDate:F,endDate:A,durationDays:ae})}),g.transportation&&g.transportation.forEach(_=>{if(!_.departureDateTime)return;let F=new Date(_.departureDateTime);F.setHours(0,0,0,0);let A=new Date(_.arrivalDateTime||_.departureDateTime);A.setHours(0,0,0,0);const ae=Math.ceil((A.getTime()-F.getTime())/(1e3*60*60*24))+1;H({id:_.id,type:"transportation",data:_,startDate:F,endDate:A,durationDays:ae})}),g.carRentals&&g.carRentals.forEach(_=>{if(!_.pickupDateTime)return;let F=new Date(_.pickupDateTime);F.setHours(0,0,0,0);let A=new Date(_.dropoffDateTime||_.pickupDateTime);A.setHours(0,0,0,0);const ae=Math.ceil((A.getTime()-F.getTime())/(1e3*60*60*24))+1;H({id:_.id,type:"carRental",data:_,startDate:F,endDate:A,durationDays:ae})})}),["flights","hotels","transportation","carRentals","events"].forEach(g=>{const C={flights:"flight",hotels:"hotel",transportation:"transportation",carRentals:"carRental",events:"event"}[g];f()[g]&&f()[g].forEach(S=>{let y,_;if(g==="flights")y=new Date(S.departureDateTime),_=new Date(S.arrivalDateTime||S.departureDateTime);else if(g==="hotels")y=new Date(S.checkInDateTime),_=new Date(S.checkOutDateTime||S.checkInDateTime);else if(g==="transportation")y=new Date(S.departureDateTime),_=new Date(S.arrivalDateTime||S.departureDateTime);else if(g==="carRentals")y=new Date(S.pickupDateTime),_=new Date(S.dropoffDateTime||S.pickupDateTime);else if(g==="events")y=new Date(S.startDateTime),_=new Date(S.endDateTime||S.startDateTime);else return;y.setHours(0,0,0,0),_.setHours(0,0,0,0);const F=Math.ceil((_.getTime()-y.getTime())/(1e3*60*60*24))+1;H({id:S.id,type:C,data:S,startDate:y,endDate:_,durationDays:F})})}),E(),se(z,k)}function E(){o(P,{});const z=[],k=Object.values(h).flat();Array.from(new Map(k.map(H=>[H.id,H])).values()).forEach(H=>{const g=le(H.startDate).getTime(),W=le(H.endDate).getTime();let C=-1;for(let S=0;S<z.length;S++){let y=!0;for(const _ of z[S]){const F=le(_.startDate).getTime(),A=le(_.endDate).getTime();if(!(W<F||g>A)){y=!1;break}}if(y){C=S,z[S].push(H);break}}C===-1&&(C=z.length,z.push([H])),Q(P,e(P)[H.id]=C)})}function se(z,k){o(p,[]);let Y=new Date(z);for(;Y<k;){const H={month:Y.getMonth(),year:Y.getFullYear()},g=new Date(Y.getFullYear(),Y.getMonth()+1,0).getDate(),W=[];for(let C=1;C<=g;C++){const S=new Date(Y.getFullYear(),Y.getMonth(),C,0,0,0,0),y=te(S);W.push({day:C,dateKey:y,items:h[y]||[],isToday:y===te(L),isBlank:!1})}for(let C=g;C<31;C++)W.push({day:null,dateKey:null,items:[],isToday:!1,isBlank:!0});e(p).push({month:H.month,year:H.year,name:m[H.month],days:W}),Y.setMonth(Y.getMonth()+1)}}function ge(z){return v[z.type]||"#666666"}function ue(z){const{type:k,data:Y}=z;return k==="trip"?Y.name:k==="flight"?`${Y.origin?.substring(0,3)||"?"} → ${Y.destination?.substring(0,3)||"?"}`:k==="hotel"?Y.hotelName||Y.name||"Hotel":k==="event"?Y.name||"Event":k==="transportation"?`${Y.method||"Transit"}`:k==="carRental"?Y.company||"Car Rental":"Item"}function N(z){return{trip:"luggage",flight:"flight",hotel:"hotel",event:"event",transportation:"train",carRental:"directions_car"}[z.type]||"info"}function ie(z){x()(z.type,z.type,z.data)}pa(()=>{},()=>{i()}),Wa(),Yt();var ye=Qn(),U=a(ye);ut(U,5,()=>e(p),z=>z.year*12+z.month,(z,k)=>{const Y=Ke(()=>(e(k),e(P),c(()=>e(k).days.flatMap(ke=>ke.items).reduce((ke,de)=>{const pe=e(P)[de.id]??0;return Math.max(ke,pe)},-1)))),H=Ke(()=>(Ae(e(Y)),c(()=>Math.max(2,1.2+(e(Y)+1)*1.75))));var g=Xn(),W=a(g),C=a(W),S=a(C,!0);t(C);var y=r(C,2),_=a(y,!0);t(y),t(W);var F=r(W,2),A=a(F);ut(A,5,()=>(e(k),c(()=>e(k).days)),ha,(ke,de,pe)=>{var B=je(),J=fe(B);ut(J,1,()=>(e(de),c(()=>e(de).items)),Z=>Z.id,(Z,O)=>{const ce=Ke(()=>(e(P),e(O),c(()=>e(P)[e(O).id]??0))),Me=Ke(()=>(e(k),e(O),c(()=>e(k).days.findIndex(_e=>_e.dateKey===te(e(O).startDate))))),Le=Ke(()=>(e(k),e(O),c(()=>e(k).days.findIndex(_e=>_e.dateKey===te(e(O).endDate))))),pt=Ke(()=>e(Me)>=0?e(Me):e(Me)<0&&e(Le)>=0?0:pe),Je=Ke(()=>(Ae(e(Le)),Ae(e(pt)),c(()=>Math.max(1,(e(Le)>=0?e(Le):30)-e(pt)+1))));var M=je(),V=fe(M);{var X=_e=>{var Ie=Wn();let Pe;var _t=a(Ie);{var At=Ne=>{var l=Jn(),j=a(l,!0);t(l),K(b=>q(j,b),[()=>(e(O),c(()=>N(e(O))))]),u(Ne,l)};I(_t,Ne=>{e(O),c(()=>e(O).type!=="flight")&&Ne(At)})}var et=r(_t,2);{var tt=Ne=>{var l=Gn(),j=a(l),b=a(j,!0);t(j);var T=r(j,2),$=a(T,!0);t(T),t(l),K((oe,we)=>{q(b,oe),q($,we)},[()=>(e(O),c(()=>e(O).data.origin?.substring(0,3)||"?")),()=>(e(O),c(()=>e(O).data.destination?.substring(0,3)||"?"))]),u(Ne,l)},Xe=Ne=>{var l=Yn(),j=a(l,!0);t(l),K(b=>q(j,b),[()=>(e(O),c(()=>ue(e(O))))]),u(Ne,l)};I(et,Ne=>{e(O),c(()=>e(O).type==="flight")?Ne(tt):Ne(Xe,!1)})}t(Ie),K((Ne,l)=>{Pe=kt(Ie,1,"item-bar svelte-1qvkaye",null,Pe,{"flight-item":e(O).type==="flight"}),xr(Ie,`
                      --day-idx: ${e(pt)??""};
                      --span: ${e(Je)??""};
                      --row-in-month: ${e(ce)??""};
                      background-color: ${Ne??""}4d;
                      color: ${l??""};
                    `)},[()=>(e(O),c(()=>ge(e(O)))),()=>(e(O),c(()=>e(O).type==="flight"?"#5a4a0f":ge(e(O))))]),R("click",Ie,()=>ie(e(O))),R("keydown",Ie,Ne=>Ne.key==="Enter"&&ie(e(O))),u(_e,Ie)};I(V,_e=>{(e(Me)===pe||e(Me)<0&&pe===0&&e(Le)>=0)&&_e(X)})}u(Z,M)}),u(ke,B)}),t(A);var ae=r(A,2);ut(ae,1,()=>(e(k),c(()=>e(k).days)),ha,(ke,de)=>{var pe=Kn();let B;var J=a(pe);{var Z=O=>{var ce=Zn(),Me=a(ce,!0);t(ce),K(()=>q(Me,(e(de),c(()=>e(de).day)))),u(O,ce)};I(J,O=>{e(de),c(()=>!e(de).isBlank&&e(de).day)&&O(Z)})}t(pe),K(O=>B=kt(pe,1,"day-cell svelte-1qvkaye",null,B,O),[()=>({today:e(de).isToday,blank:e(de).isBlank,weekend:!e(de).isBlank&&e(de).dateKey&&new Date(e(de).dateKey).getDay()%6===0,special:e(de).dateKey&&re(e(de).dateKey)})]),u(ke,pe)}),t(F),t(g),K(ke=>{xr(g,`min-height: ${e(H)??""}rem;`),q(S,ke),q(_,(e(k),c(()=>e(k).year)))},[()=>(e(k),c(()=>e(k).name.substring(0,3)))]),u(z,g)}),t(U),t(ye),u(n,ye),Gt()}function ta(){if(typeof window<"u"){const n=window.location.hostname,s=window.location.protocol;return window.location.port==="5173"?`${s}//${n}:3501`:n==="localhost"||n==="127.0.0.1"?`${s}//localhost:3000`:`${s}//${n}:3501`}return"http://localhost:3000"}const la={async updateProfile(n){const s=ta(),d=await fetch(`${s}/account/profile`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),credentials:"include"});if(!d.ok)throw new Error(`Failed to update profile: ${d.statusText}`);return d.json()},async changePassword(n){const s=ta(),d=await fetch(`${s}/account/password`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),credentials:"include"});if(!d.ok)throw new Error(`Failed to change password: ${d.statusText}`);return d.json()},async getVouchers(){const n=ta(),s=await fetch(`${n}/vouchers`,{method:"GET",credentials:"include"});if(!s.ok)throw new Error(`Failed to fetch vouchers: ${s.statusText}`);return s.json()},async getVoucherDetails(n){const s=ta(),d=await fetch(`${s}/account/vouchers/${n}/details`,{method:"GET",credentials:"include"});if(!d.ok)throw new Error(`Failed to fetch voucher details: ${d.statusText}`);return d.json()},async createVoucher(n){const s=ta(),d=await fetch(`${s}/vouchers`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),credentials:"include"});if(!d.ok)throw new Error(`Failed to create voucher: ${d.statusText}`);return d.json()},async updateVoucher(n,s){const d=ta(),f=await fetch(`${d}/vouchers/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s),credentials:"include"});if(!f.ok)throw new Error(`Failed to update voucher: ${f.statusText}`);return f.json()},async deleteVoucher(n){const s=ta(),d=await fetch(`${s}/vouchers/${n}`,{method:"DELETE",credentials:"include"});if(!d.ok)throw new Error(`Failed to delete voucher: ${d.statusText}`);return d.json()},async getCompanions(){const n=ta(),s=await fetch(`${n}/companions/api/json`,{method:"GET",credentials:"include"});if(!s.ok)throw new Error(`Failed to fetch companions: ${s.statusText}`);return await s.json()},async getAllCompanions(){const n=ta(),s=await fetch(`${n}/companions/api/all`,{method:"GET",credentials:"include"});if(!s.ok)throw new Error(`Failed to fetch all companions: ${s.statusText}`);return s.json()},async createCompanion(n){const s=ta(),d=await fetch(`${s}/companions`,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(n),credentials:"include"});if(!d.ok)throw new Error(`Failed to create companion: ${d.statusText}`);return d.json()},async updateCompanion(n,s){const d=ta(),f=await fetch(`${d}/companions/${n}`,{method:"PUT",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(s),credentials:"include"});if(!f.ok)throw new Error(`Failed to update companion: ${f.statusText}`);return f.json()},async removeCompanion(n){const s=ta(),d=await fetch(`${s}/companions/${n}`,{method:"DELETE",credentials:"include"});if(!d.ok)throw new Error(`Failed to remove companion: ${d.statusText}`);return d.json()},async revokeCompanionAccess(n){const s=ta(),d=await fetch(`${s}/account/companions/${n}/revoke`,{method:"PUT",credentials:"include"});if(!d.ok)throw new Error(`Failed to revoke companion access: ${d.statusText}`);return d.json()},async exportData(){const n=ta(),s=await fetch(`${n}/account/export`,{method:"GET",credentials:"include"});if(!s.ok)throw new Error(`Export failed: ${s.statusText}`);return s.blob()},async previewImport(n){const s=ta(),d=new FormData;d.append("file",n);const f=await fetch(`${s}/account/data/preview`,{method:"POST",credentials:"include",body:d});if(!f.ok){let x="Failed to preview import";try{x=(await f.json()).message||x}catch{}throw new Error(x)}return f.json()},async importData(n){const s=ta(),d=await fetch(`${s}/account/data/import`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),credentials:"include"});if(!d.ok)throw new Error(`Failed to import data: ${d.statusText}`);return d.json()}};var ts=w('<div class="error-message"> </div>'),as=w('<div class="edit-panel"><form class="edit-content"><!> <div class="form-fields"><div class="form-row cols-2"><div class="form-group"><label for="firstName">First Name</label> <input type="text" id="firstName" placeholder="John" required/></div> <div class="form-group"><label for="lastName">Last Initial</label> <input type="text" id="lastName" placeholder="D" maxlength="1" required/></div></div> <div class="form-group"><label for="email">Email Address</label> <input type="email" id="email" placeholder="john@example.com" autocomplete="new-email" required/></div></div> <div class="form-buttons"><button type="submit" class="submit-btn"> </button> <button type="button" class="cancel-btn">Cancel</button></div></form></div>');function rs(n,s){Jt(s,!1);let d=Se(s,"data",12,null),f=ne(!1),x=ne(null),m=ne({firstName:d()?.firstName||"",lastName:d()?.lastName||"",email:d()?.email||""}),v=d()?.email||"";function p(){return o(x,null),e(m).firstName.trim()?e(m).lastName.trim()?e(m).lastName.length>1?(o(x,"Last initial must be a single character"),!1):e(m).email.trim()?e(m).email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)?!0:(o(x,"Please enter a valid email address"),!1):(o(x,"Email is required"),!1):(o(x,"Last initial is required"),!1):(o(x,"First name is required"),!1)}async function h(){if(p())try{o(f,!0),o(x,null);const k=await la.updateProfile({firstName:e(m).firstName,lastName:e(m).lastName,email:e(m).email});k&&k.success?k.data?.user&&(Pi.setUser(k.data.user),d(k.data.user),v=e(m).email):o(x,k?.message||"Failed to update profile")}catch(k){o(x,k instanceof Error?k.message:"An error occurred while updating your profile")}finally{o(f,!1)}}function P(){o(m,{firstName:d()?.firstName||"",lastName:d()?.lastName||"",email:d()?.email||""}),o(x,null)}Yt();var L=as(),ve=a(L),re=a(ve);{var te=k=>{var Y=ts(),H=a(Y,!0);t(Y),K(()=>q(H,e(x))),u(k,Y)};I(re,k=>{e(x)&&k(te)})}var he=r(re,2),le=a(he),i=a(le),E=r(a(i),2);be(E),t(i);var se=r(i,2),ge=r(a(se),2);be(ge),t(se),t(le);var ue=r(le,2),N=r(a(ue),2);be(N),t(ue),t(he);var ie=r(he,2),ye=a(ie),U=a(ye,!0);t(ye);var z=r(ye,2);t(ie),t(ve),t(L),K(()=>{ye.disabled=e(f),q(U,e(f)?"Saving...":"Update Profile"),z.disabled=e(f)}),xe(E,()=>e(m).firstName,k=>Q(m,e(m).firstName=k)),xe(ge,()=>e(m).lastName,k=>Q(m,e(m).lastName=k)),R("change",ge,k=>Q(m,e(m).lastName=k.currentTarget.value.substring(0,1))),xe(N,()=>e(m).email,k=>Q(m,e(m).email=k)),R("click",z,P),R("submit",ve,ur(h)),u(n,L),Gt()}var is=w('<div class="error-message"> </div>'),ns=w('<span class="field-error">Passwords do not match</span>'),ss=w('<div class="edit-panel"><form class="edit-content"><!> <div class="form-fields"><div class="form-group"><label for="currentPassword">Current Password</label> <input type="password" id="currentPassword" placeholder="Enter your current password" required/></div> <div class="password-info svelte-1w2c911"><p class="info-text svelte-1w2c911"><span class="material-symbols-outlined">info</span> Password must be at least 6 characters long</p></div> <div class="form-group"><label for="newPassword">New Password</label> <input type="password" id="newPassword" placeholder="Enter your new password" required/></div> <div class="form-group"><label for="confirmPassword">Confirm New Password</label> <input type="password" id="confirmPassword" placeholder="Confirm your new password" required/> <!></div></div> <div class="form-buttons"><button type="submit" class="submit-btn"> </button> <button type="button" class="cancel-btn">Cancel</button></div></form></div>');function os(n,s){Jt(s,!1);let d=ne(!1),f=ne(null),x=ne({currentPassword:"",newPassword:"",confirmPassword:""}),m=ne(!0);function v(){return o(f,null),o(m,e(x).newPassword===e(x).confirmPassword),e(x).currentPassword.trim()?e(x).newPassword.trim()?e(x).newPassword.length<6?(o(f,"New password must be at least 6 characters"),!1):e(x).confirmPassword.trim()?e(m)?!0:(o(f,"New passwords do not match"),!1):(o(f,"Password confirmation is required"),!1):(o(f,"New password is required"),!1):(o(f,"Current password is required"),!1)}async function p(){if(v())try{o(d,!0),o(f,null);const H=await la.changePassword({currentPassword:e(x).currentPassword,newPassword:e(x).newPassword,confirmPassword:e(x).confirmPassword});H&&H.success?h():o(f,H?.message||"Failed to change password")}catch(H){const g=H instanceof Error?H.message:"An error occurred while changing your password";o(f,g)}finally{o(d,!1)}}function h(){o(x,{currentPassword:"",newPassword:"",confirmPassword:""}),o(m,!0),o(f,null)}function P(){h()}function L(){(e(x).newPassword||e(x).confirmPassword)&&o(m,e(x).newPassword===e(x).confirmPassword)}Yt();var ve=ss(),re=a(ve),te=a(re);{var he=H=>{var g=is(),W=a(g,!0);t(g),K(()=>q(W,e(f))),u(H,g)};I(te,H=>{e(f)&&H(he)})}var le=r(te,2),i=a(le),E=r(a(i),2);be(E),t(i);var se=r(i,4),ge=r(a(se),2);be(ge),t(se);var ue=r(se,2),N=r(a(ue),2);be(N);var ie=r(N,2);{var ye=H=>{var g=ns();u(H,g)};I(ie,H=>{!e(m)&&e(x).confirmPassword&&H(ye)})}t(ue),t(le);var U=r(le,2),z=a(U),k=a(z,!0);t(z);var Y=r(z,2);t(U),t(re),t(ve),K(()=>{Ir(E,e(x).currentPassword),E.disabled=e(d),Ir(ge,e(x).newPassword),ge.disabled=e(d),Ir(N,e(x).confirmPassword),N.disabled=e(d),z.disabled=e(d)||!e(m),q(k,e(d)?"Saving...":"Change Password"),Y.disabled=e(d)}),R("change",E,H=>Q(x,e(x).currentPassword=H.currentTarget.value)),R("change",ge,H=>Q(x,e(x).newPassword=H.currentTarget.value)),R("input",ge,L),R("change",N,H=>Q(x,e(x).confirmPassword=H.currentTarget.value)),R("input",N,L),R("click",Y,P),R("submit",re,ur(p)),u(n,ve),Gt()}var ls=w('<div class="error-message"> </div>'),ds=w("<option> </option>"),cs=w("<option> </option>"),vs=w('<div class="edit-content"><!> <form><div class="form-fields"><div class="form-group"><label>Voucher Number *</label> <input type="text" placeholder="e.g., 123456789" required/></div> <div class="form-row cols-2"><div class="form-group"><label>Type *</label> <select required></select></div> <div class="form-group"><label>Issuer *</label> <input type="text" placeholder="e.g., United Airlines" required/></div></div> <div class="form-row cols-2"><div class="form-group"><label>Associated Account</label> <input type="text" placeholder="e.g., Frequent flyer number"/></div> <div class="form-group"><label>PIN Code</label> <input type="password" placeholder="PIN or security code"/></div></div> <div class="form-row cols-2"><div class="form-group"><label>Currency</label> <select></select></div> <div class="form-group"><label>Total Value</label> <input type="number" step="0.01" min="0" placeholder="0.00"/></div></div> <div class="form-group"><label>Expiration Date</label> <input type="date"/></div> <div class="form-group"><label>Notes</label> <textarea placeholder="Any additional information about this voucher..." rows="3"></textarea></div></div> <div class="form-buttons"><button class="submit-btn" type="submit"> </button> <button class="cancel-btn" type="button">Cancel</button></div></form></div>');function qr(n,s){Jt(s,!1),Se(s,"tripId",8);let d=Se(s,"voucherId",8,null),f=Se(s,"voucher",8,null),x=Se(s,"onSuccess",8,null),m=Se(s,"onCancel",8,null),v=ne(!1),p=ne(null),h=ne({type:f()?.type||"TRAVEL_CREDIT",issuer:f()?.issuer||"",voucherNumber:f()?.voucherNumber||"",associatedAccount:f()?.associatedAccount||"",pinCode:f()?.pinCode||"",currency:f()?.currency||"USD",totalValue:f()?.totalValue?parseFloat(f().totalValue).toString():"",expirationDate:f()?.expirationDate?new Date(f().expirationDate).toISOString().split("T")[0]:"",notes:f()?.notes||""});const P=[{value:"TRAVEL_CREDIT",label:"Travel Credit"},{value:"UPGRADE_CERT",label:"Upgrade Certificate"},{value:"REGIONAL_UPGRADE_CERT",label:"Regional Upgrade Cert"},{value:"GLOBAL_UPGRADE_CERT",label:"Global Upgrade Cert"},{value:"COMPANION_CERT",label:"Companion Certificate"},{value:"GIFT_CARD",label:"Gift Card"},{value:"MISC",label:"Miscellaneous"}],L=[{value:"USD",label:"USD ($)"},{value:"EUR",label:"EUR (€)"},{value:"GBP",label:"GBP (£)"},{value:"JPY",label:"JPY (¥)"},{value:"CAD",label:"CAD (C$)"},{value:"AUD",label:"AUD (A$)"}];async function ve(){try{if(!e(h).voucherNumber.trim()){o(p,"Voucher number is required");return}if(!e(h).issuer.trim()){o(p,"Issuer is required");return}if(!["UPGRADE_CERT","COMPANION_CERT","REGIONAL_UPGRADE_CERT","GLOBAL_UPGRADE_CERT"].includes(e(h).type)){if(!e(h).totalValue){o(p,"Total value is required for this voucher type");return}const Me=parseFloat(e(h).totalValue);if(isNaN(Me)||Me<=0){o(p,"Total value must be a positive number");return}}o(v,!0),o(p,null);let O;const ce={...e(h),totalValue:e(h).totalValue?parseFloat(e(h).totalValue):null};d()?(O=await la.updateVoucher(d(),ce),O=O.data||O):(O=await la.createVoucher(ce),O=O.data||O),x()&&x()(O)}catch(Z){o(p,Z instanceof Error?Z.message:"Failed to save voucher")}finally{o(v,!1)}}function re(){m()&&m()()}Yt();var te=vs(),he=a(te);{var le=Z=>{var O=ls(),ce=a(O,!0);t(O),K(()=>q(ce,e(p))),u(Z,O)};I(he,Z=>{e(p)&&Z(le)})}var i=r(he,2),E=a(i),se=a(E),ge=r(a(se),2);be(ge),t(se);var ue=r(se,2),N=a(ue),ie=r(a(N),2);K(()=>{e(h),lr(()=>{})}),ut(ie,5,()=>P,ha,(Z,O)=>{var ce=ds(),Me=a(ce,!0);t(ce);var Le={};K(()=>{q(Me,(e(O),c(()=>e(O).label))),Le!==(Le=(e(O),c(()=>e(O).value)))&&(ce.value=(ce.__value=(e(O),c(()=>e(O).value)))??"")}),u(Z,ce)}),t(ie),t(N);var ye=r(N,2),U=r(a(ye),2);be(U),t(ye),t(ue);var z=r(ue,2),k=a(z),Y=r(a(k),2);be(Y),t(k);var H=r(k,2),g=r(a(H),2);be(g),t(H),t(z);var W=r(z,2),C=a(W),S=r(a(C),2);K(()=>{e(h),lr(()=>{})}),ut(S,5,()=>L,ha,(Z,O)=>{var ce=cs(),Me=a(ce,!0);t(ce);var Le={};K(()=>{q(Me,(e(O),c(()=>e(O).label))),Le!==(Le=(e(O),c(()=>e(O).value)))&&(ce.value=(ce.__value=(e(O),c(()=>e(O).value)))??"")}),u(Z,ce)}),t(S),t(C);var y=r(C,2),_=r(a(y),2);be(_),t(y),t(W);var F=r(W,2),A=r(a(F),2);be(A),t(F);var ae=r(F,2),ke=r(a(ae),2);La(ke),t(ae),t(E);var de=r(E,2),pe=a(de),B=a(pe,!0);t(pe);var J=r(pe,2);t(de),t(i),t(te),K(()=>{pe.disabled=e(v),q(B,d()?"Update Voucher":"Add Voucher"),J.disabled=e(v)}),xe(ge,()=>e(h).voucherNumber,Z=>Q(h,e(h).voucherNumber=Z)),cr(ie,()=>e(h).type,Z=>Q(h,e(h).type=Z)),xe(U,()=>e(h).issuer,Z=>Q(h,e(h).issuer=Z)),xe(Y,()=>e(h).associatedAccount,Z=>Q(h,e(h).associatedAccount=Z)),xe(g,()=>e(h).pinCode,Z=>Q(h,e(h).pinCode=Z)),cr(S,()=>e(h).currency,Z=>Q(h,e(h).currency=Z)),xe(_,()=>e(h).totalValue,Z=>Q(h,e(h).totalValue=Z)),xe(A,()=>e(h).expirationDate,Z=>Q(h,e(h).expirationDate=Z)),xe(ke,()=>e(h).notes,Z=>Q(h,e(h).notes=Z)),R("click",J,re),R("submit",i,ur(ve)),u(n,te),Gt()}var us=w("<div> </div>"),ps=w('<div class="provider svelte-qc6r1s"> </div>'),fs=w('<div class="detail-row svelte-qc6r1s"><label class="svelte-qc6r1s">Description</label> <p class="svelte-qc6r1s"> </p></div>'),ms=w('<div class="detail-row svelte-qc6r1s"><label class="svelte-qc6r1s">Expiration Date</label> <p class="svelte-qc6r1s"> </p></div>'),hs=w('<div class="detail-row svelte-qc6r1s"><label class="svelte-qc6r1s">Notes</label> <p class="svelte-qc6r1s"> </p></div>'),gs=w('<div class="detail-row svelte-qc6r1s"><label class="svelte-qc6r1s">Added</label> <p class="svelte-qc6r1s"> </p></div>'),_s=w('<span class="material-symbols-outlined">edit</span> Edit',1),ys=w('<span class="material-symbols-outlined">delete</span> Delete',1),bs=w('<div class="voucher-details svelte-qc6r1s"><div class="detail-header svelte-qc6r1s"><h3 class="svelte-qc6r1s"> </h3> <!></div> <div class="detail-content"><div class="discount-box svelte-qc6r1s"><div class="discount-value svelte-qc6r1s"> </div> <!></div> <div class="details-grid svelte-qc6r1s"><!> <!> <!> <!></div> <div class="detail-actions svelte-qc6r1s"><!> <!> <!></div></div></div>');function xs(n,s){Jt(s,!1);let d=Se(s,"voucherId",8),f=Se(s,"voucher",8),x=Se(s,"onClose",8,null),m=Se(s,"onEdit",8,null),v=Se(s,"onDelete",8,null),p=ne(!1);function h(B){if(!B)return"No expiration";try{return new Date(B).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})}catch{return B}}function P(B){if(!B)return-1;try{const J=new Date(B),Z=new Date;Z.setHours(0,0,0,0),J.setHours(0,0,0,0);const O=J.getTime()-Z.getTime();return Math.ceil(O/(1e3*60*60*24))}catch{return-1}}function L(B){return P(B)<0}function ve(B){const J=P(B);return J<0?"Expired":J===0?"Expires today":J===1?"Expires in 1 day":J<=7?`Expires in ${J} days`:J<=30?`Expires in ${Math.floor(J/7)} weeks`:`Expires in ${Math.floor(J/30)} months`}function re(B){return B.discountType==="percentage"?`${B.discountValue}% off`:`$${parseFloat(B.discountValue).toFixed(2)} off`}async function te(){if(confirm("Are you sure you want to delete this voucher?")){o(p,!0);try{await la.deleteVoucher(d()),v()&&v()(d()),x()&&x()()}catch{alert("Failed to delete voucher"),o(p,!1)}}}function he(){m()&&m()(d())}Yt();var le=bs(),i=a(le),E=a(i),se=a(E,!0);t(E);var ge=r(E,2);{var ue=B=>{var J=us();let Z;var O=a(J,!0);t(J),K((ce,Me)=>{Z=kt(J,1,"status-badge svelte-qc6r1s",null,Z,ce),q(O,Me)},[()=>({expired:L(f().expirationDate)}),()=>(Ae(f()),c(()=>ve(f().expirationDate)))]),u(B,J)};I(ge,B=>{Ae(f()),c(()=>f().expirationDate)&&B(ue)})}t(i);var N=r(i,2),ie=a(N),ye=a(ie),U=a(ye,!0);t(ye);var z=r(ye,2);{var k=B=>{var J=ps(),Z=a(J,!0);t(J),K(()=>q(Z,(Ae(f()),c(()=>f().provider)))),u(B,J)};I(z,B=>{Ae(f()),c(()=>f().provider)&&B(k)})}t(ie);var Y=r(ie,2),H=a(Y);{var g=B=>{var J=fs(),Z=r(a(J),2),O=a(Z,!0);t(Z),t(J),K(()=>q(O,(Ae(f()),c(()=>f().description)))),u(B,J)};I(H,B=>{Ae(f()),c(()=>f().description)&&B(g)})}var W=r(H,2);{var C=B=>{var J=ms(),Z=r(a(J),2),O=a(Z,!0);t(Z),t(J),K(ce=>q(O,ce),[()=>(Ae(f()),c(()=>h(f().expirationDate)))]),u(B,J)};I(W,B=>{Ae(f()),c(()=>f().expirationDate)&&B(C)})}var S=r(W,2);{var y=B=>{var J=hs(),Z=r(a(J),2),O=a(Z,!0);t(Z),t(J),K(()=>q(O,(Ae(f()),c(()=>f().notes)))),u(B,J)};I(S,B=>{Ae(f()),c(()=>f().notes)&&B(y)})}var _=r(S,2);{var F=B=>{var J=gs(),Z=r(a(J),2),O=a(Z,!0);t(Z),t(J),K(ce=>q(O,ce),[()=>(Ae(f()),c(()=>h(f().createdAt)))]),u(B,J)};I(_,B=>{Ae(f()),c(()=>f().createdAt)&&B(F)})}t(Y);var A=r(Y,2),ae=a(A);Aa(ae,{variant:"primary",get disabled(){return e(p)},$$events:{click:he},children:(B,J)=>{var Z=_s();Ft(),u(B,Z)},$$slots:{default:!0}});var ke=r(ae,2);Aa(ke,{variant:"danger",get disabled(){return e(p)},get loading(){return e(p)},$$events:{click:te},children:(B,J)=>{var Z=ys();Ft(),u(B,Z)},$$slots:{default:!0}});var de=r(ke,2);{var pe=B=>{Aa(B,{variant:"secondary",get disabled(){return e(p)},$$events:{click(...J){x()?.apply(this,J)}},children:(J,Z)=>{Ft();var O=ma("Close");u(J,O)},$$slots:{default:!0}})};I(de,B=>{x()&&B(pe)})}t(A),t(N),t(le),K(B=>{q(se,(Ae(f()),c(()=>f().code))),q(U,B)},[()=>(Ae(f()),c(()=>re(f())))]),u(n,le),Gt()}var Ts=w('<span class="material-symbols-outlined">add</span> Add Voucher',1),Ds=w('<div class="tabs-header svelte-113vqn2"><div class="tabs svelte-113vqn2"><button> </button> <button> </button></div> <!></div>'),ws=w('<div class="loading-state svelte-113vqn2"><span class="material-symbols-outlined">hourglass_empty</span> <p>Loading vouchers...</p></div>'),ks=w('<div class="empty-state svelte-113vqn2"><span class="material-symbols-outlined">card_giftcard</span> <p class="svelte-113vqn2"> </p> <!></div>'),Cs=w('<tr><td class="voucher-number svelte-113vqn2"> </td><td class="svelte-113vqn2"> </td><td class="svelte-113vqn2"> </td><td class="currency-value svelte-113vqn2"> </td><td class="svelte-113vqn2"> </td><td class="svelte-113vqn2"><span> </span></td><td class="actions svelte-113vqn2"><button class="action-btn edit svelte-113vqn2" title="Edit"><span class="material-symbols-outlined">edit</span></button> <button class="action-btn delete svelte-113vqn2" title="Delete"><span class="material-symbols-outlined">delete</span></button></td></tr>'),Es=w('<div class="vouchers-table-container svelte-113vqn2"><table class="vouchers-table svelte-113vqn2"><thead class="svelte-113vqn2"><tr><th class="svelte-113vqn2">Voucher Number</th><th class="svelte-113vqn2">Type</th><th class="svelte-113vqn2">Issuer</th><th class="svelte-113vqn2">Remaining Value</th><th class="svelte-113vqn2">Expiration</th><th class="svelte-113vqn2">Status</th><th class="svelte-113vqn2">Actions</th></tr></thead><tbody class="svelte-113vqn2"></tbody></table></div>'),js=w('<div class="vouchers-view svelte-113vqn2"><!> <!></div>'),Ns=w('<div class="form-view svelte-113vqn2"><button class="back-btn svelte-113vqn2"><span class="material-symbols-outlined">arrow_back</span> Back to Vouchers</button> <!></div>'),Ss=w('<div class="details-view svelte-113vqn2"><button class="back-btn svelte-113vqn2"><span class="material-symbols-outlined">arrow_back</span> Back to Vouchers</button> <!></div>'),Ms=w('<div class="settings-vouchers-container svelte-113vqn2"><!> <!> <!></div>');function Is(n,s){Jt(s,!1);let d=Se(s,"onEditVoucher",8,null),f=Se(s,"onAddVoucher",8,null),x=ne([]),m=ne([]),v=ne(!0),p=ne(null),h=ne(null),P=ne("list"),L=ne(null),ve=ne(null),re=ne("open");Va(async()=>{await te()});async function te(){try{o(v,!0),o(p,null);const _=await la.getVouchers();o(x,_.data||_||[]),le()}catch(_){o(p,_ instanceof Error?_.message:"Failed to load vouchers")}finally{o(v,!1)}}function he(_){if(!_)return!1;try{return new Date(_)<new Date}catch{return!1}}function le(){e(re)==="open"?o(m,e(x).filter(_=>!he(_.expirationDate))):e(re)==="closed"?o(m,e(x).filter(_=>he(_.expirationDate))):o(m,e(x))}function i(_){o(re,_),le()}function E(){f()?f()():(o(L,null),o(ve,null),o(P,"form"))}function se(_){const F=e(x).find(A=>A.id===_);d()?d()(F):(o(L,_),o(ve,F),o(P,"form"))}async function ge(_){const F=_.detail||_;e(L)?(o(x,e(x).map(A=>A.id===e(L)?F:A)),o(h,"Voucher updated successfully")):(o(x,[...e(x),F]),o(h,"Voucher added successfully")),le(),o(P,"list"),o(L,null),o(ve,null),setTimeout(()=>{o(h,null)},3e3)}function ue(){o(P,"list"),o(L,null),o(ve,null)}function N(){o(P,"list"),o(L,null),o(ve,null)}async function ie(_){o(x,e(x).filter(F=>F.id!==_)),le(),o(P,"list"),o(L,null),o(ve,null),o(h,"Voucher deleted successfully"),setTimeout(()=>{o(h,null)},3e3)}function ye(_){o(P,"form"),o(L,_),o(ve,e(x).find(F=>F.id===_))}function U(_){if(!_)return"No expiration";try{return new Date(_).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch{return _}}function z(_){return _?_.replace(/_/g," ").split(" ").map(F=>F.charAt(0)+F.slice(1).toLowerCase()).join(" "):"Unknown"}Yt();var k=Ms(),Y=a(k);{var H=_=>{Ra(_,{type:"error",get message(){return e(p)},dismissible:!0})};I(Y,_=>{e(p)&&_(H)})}var g=r(Y,2);{var W=_=>{Ra(_,{type:"success",get message(){return e(h)},dismissible:!0})};I(g,_=>{e(h)&&_(W)})}var C=r(g,2);{var S=_=>{var F=js(),A=a(F);{var ae=B=>{var J=Ds(),Z=a(J),O=a(Z);let ce;var Me=a(O);t(O);var Le=r(O,2);let pt;var Je=a(Le);t(Le),t(Z);var M=r(Z,2);Aa(M,{variant:"primary",get disabled(){return e(v)},$$events:{click:E},children:(V,X)=>{var _e=Ts();Ft(),u(V,_e)},$$slots:{default:!0}}),t(J),K((V,X)=>{ce=kt(O,1,"tab-btn svelte-113vqn2",null,ce,{active:e(re)==="open"}),q(Me,`Open (${V??""})`),pt=kt(Le,1,"tab-btn svelte-113vqn2",null,pt,{active:e(re)==="closed"}),q(Je,`Expired (${X??""})`)},[()=>(e(x),c(()=>e(x).filter(V=>!he(V.expirationDate)).length)),()=>(e(x),c(()=>e(x).filter(V=>he(V.expirationDate)).length))]),R("click",O,()=>i("open")),R("click",Le,()=>i("closed")),u(B,J)};I(A,B=>{e(v)||B(ae)})}var ke=r(A,2);{var de=B=>{var J=ws();u(B,J)},pe=B=>{var J=je(),Z=fe(J);{var O=Me=>{var Le=ks(),pt=r(a(Le),2),Je=a(pt,!0);t(pt);var M=r(pt,2);{var V=X=>{Aa(X,{variant:"primary",$$events:{click:E},children:(_e,Ie)=>{Ft();var Pe=ma("Add Your First Voucher");u(_e,Pe)},$$slots:{default:!0}})};I(M,X=>{e(re),e(x),c(()=>e(re)==="open"&&e(x).length===0)&&X(V)})}t(Le),K(()=>q(Je,(e(re),e(x),c(()=>e(re)==="open"&&e(x).length===0?"No vouchers yet":"No vouchers in this category")))),u(Me,Le)},ce=Me=>{var Le=Es(),pt=a(Le),Je=r(a(pt));ut(Je,5,()=>e(m),M=>M.id,(M,V)=>{var X=Cs();let _e;var Ie=a(X),Pe=a(Ie,!0);t(Ie);var _t=r(Ie),At=a(_t,!0);t(_t);var et=r(_t),tt=a(et,!0);t(et);var Xe=r(et),Ne=a(Xe,!0);t(Xe);var l=r(Xe),j=a(l,!0);t(l);var b=r(l),T=a(b);let $;var oe=a(T,!0);t(T),t(b);var we=r(b),Ce=a(we),Te=r(Ce,2);t(we),t(X),K(($e,ze,Ze)=>{_e=kt(X,1,"svelte-113vqn2",null,_e,{expired:e(V).isExpired}),q(Pe,(e(V),c(()=>e(V).voucherNumber))),q(At,$e),q(tt,(e(V),c(()=>e(V).issuer))),q(Ne,ze),q(j,Ze),$=kt(T,1,"status-badge svelte-113vqn2",null,$,{open:e(V).status==="OPEN",used:e(V).status==="USED","expired-badge":e(V).isExpired}),q(oe,(e(V),c(()=>e(V).status))),Te.disabled=e(v)},[()=>(e(V),c(()=>z(e(V).type))),()=>(e(V),c(()=>e(V).remainingBalance!==void 0?`${e(V).currency} ${parseFloat(e(V).remainingBalance).toFixed(2)}`:"—")),()=>(e(V),c(()=>U(e(V).expirationDate)))]),R("click",Ce,()=>se(e(V).id)),R("click",Te,()=>ie(e(V).id)),u(M,X)}),t(Je),t(pt),t(Le),u(Me,Le)};I(Z,Me=>{e(m),c(()=>e(m).length===0)?Me(O):Me(ce,!1)},!0)}u(B,J)};I(ke,B=>{e(v)?B(de):B(pe,!1)})}t(F),u(_,F)},y=_=>{var F=je(),A=fe(F);{var ae=de=>{var pe=Ns(),B=a(pe),J=r(B,2);qr(J,{tripId:"",get voucherId(){return e(L)},get voucher(){return e(ve)},onSuccess:ge,onCancel:ue}),t(pe),R("click",B,ue),u(de,pe)},ke=de=>{var pe=je(),B=fe(pe);{var J=Z=>{var O=Ss(),ce=a(O),Me=r(ce,2);{let Le=Ke(()=>e(L)||"");xs(Me,{get voucherId(){return e(Le)},get voucher(){return e(ve)},onClose:N,onEdit:ye,onDelete:ie})}t(O),R("click",ce,N),u(Z,O)};I(B,Z=>{e(P)==="details"&&e(ve)&&Z(J)},!0)}u(de,pe)};I(A,de=>{e(P)==="form"?de(ae):de(ke,!1)},!0)}u(_,F)};I(C,_=>{e(P)==="list"?_(S):_(y,!1)})}t(k),u(n,k),Gt()}var As=w('<div class="loading-state svelte-1srup7e"><span class="material-symbols-outlined">hourglass_empty</span> <p>Loading companions...</p></div>'),$s=w('<span class="indicator svelte-1srup7e">✓</span>'),Ps=w('<span class="indicator svelte-1srup7e">✓</span>'),qs=w('<button class="action-btn edit-btn svelte-1srup7e" title="Edit companion"><span class="material-symbols-outlined">edit</span></button> <button class="action-btn delete-btn svelte-1srup7e" title="Remove companion"><span class="material-symbols-outlined">delete</span></button>',1),Ls=w('<button class="action-btn revoke-btn svelte-1srup7e" title="Revoke access"><span class="material-symbols-outlined">block</span></button>'),Rs=w('<tr class="svelte-1srup7e"><td class="name-cell svelte-1srup7e"> </td><td class="email-cell svelte-1srup7e"> </td><td class="center-col svelte-1srup7e"><!></td><td class="center-col svelte-1srup7e"><!></td><td class="actions-cell svelte-1srup7e"><div class="actions-group svelte-1srup7e"><!> <!></div></td></tr>'),Fs=w('<div class="table-wrapper svelte-1srup7e"><table class="companions-table svelte-1srup7e"><thead class="svelte-1srup7e"><tr><th class="svelte-1srup7e">Name</th><th class="svelte-1srup7e">Email</th><th class="center-col svelte-1srup7e">You Invited</th><th class="center-col svelte-1srup7e">They Invited</th><th class="actions-col svelte-1srup7e"></th></tr></thead><tbody class="svelte-1srup7e"></tbody></table></div>'),Os=w('<div class="empty-state svelte-1srup7e"><span class="material-symbols-outlined">groups</span> <p class="svelte-1srup7e">No companions yet</p> <p class="empty-description svelte-1srup7e">Start adding travel companions to share your trips and collaborate on travel planning.</p></div>'),zs=w('<div class="settings-companions-container svelte-1srup7e"><!> <!> <!></div>');function Us(n,s){Jt(s,!1);let d=ne([]),f=ne(!0),x=ne(null),m=ne(null);Va(async()=>(await p(),window.addEventListener("companions-updated",v),()=>{window.removeEventListener("companions-updated",v)}));async function v(){await p()}async function p(){try{o(f,!0),o(x,null);const N=await la.getAllCompanions();o(d,N.companions||[]),console.log("Loaded companions:",e(d))}catch(N){o(x,N instanceof Error?N.message:"Failed to load companions")}finally{o(f,!1)}}async function h(N){try{o(f,!0),o(x,null),await la.removeCompanion(N),o(m,"Companion removed successfully"),await p(),setTimeout(()=>{o(m,null)},3e3)}catch(ie){o(x,ie instanceof Error?ie.message:"Failed to remove companion")}finally{o(f,!1)}}async function P(N){try{o(f,!0),o(x,null),await la.revokeCompanionAccess(N),o(m,"Companion access revoked successfully"),await p(),setTimeout(()=>{o(m,null)},3e3)}catch(ie){o(x,ie instanceof Error?ie.message:"Failed to revoke access")}finally{o(f,!1)}}function L(N){return N.firstName&&N.lastName?`${N.firstName} ${N.lastName.charAt(0)}.`:N.firstName?N.firstName:N.lastName?N.lastName:N.email}function ve(N,ie){window.dispatchEvent(new CustomEvent(N,{detail:ie}))}function re(N){ve("edit-companion",{companion:N})}Yt();var te=zs(),he=a(te);{var le=N=>{Ra(N,{type:"error",get message(){return e(x)},dismissible:!0})};I(he,N=>{e(x)&&N(le)})}var i=r(he,2);{var E=N=>{Ra(N,{type:"success",get message(){return e(m)},dismissible:!0})};I(i,N=>{e(m)&&N(E)})}var se=r(i,2);{var ge=N=>{var ie=As();u(N,ie)},ue=N=>{var ie=je(),ye=fe(ie);{var U=k=>{var Y=Fs(),H=a(Y),g=r(a(H));ut(g,5,()=>e(d),W=>W.id,(W,C)=>{var S=Rs(),y=a(S),_=a(y,!0);t(y);var F=r(y),A=a(F,!0);t(F);var ae=r(F),ke=a(ae);{var de=Je=>{var M=$s();u(Je,M)};I(ke,Je=>{e(C).youInvited&&Je(de)})}t(ae);var pe=r(ae),B=a(pe);{var J=Je=>{var M=Ps();u(Je,M)};I(B,Je=>{e(C).theyInvited&&Je(J)})}t(pe);var Z=r(pe),O=a(Z),ce=a(O);{var Me=Je=>{var M=qs(),V=fe(M),X=r(V,2);K(()=>{V.disabled=e(f),X.disabled=e(f)}),R("click",V,()=>re(e(C))),R("click",X,()=>h(e(C).companionId)),u(Je,M)};I(ce,Je=>{e(C).youInvited&&Je(Me)})}var Le=r(ce,2);{var pt=Je=>{var M=Ls();K(()=>M.disabled=e(f)),R("click",M,()=>P(e(C).companionId)),u(Je,M)};I(Le,Je=>{e(C).theyInvited&&Je(pt)})}t(O),t(Z),t(S),K(Je=>{q(_,Je),q(A,e(C).email)},[()=>L(e(C))]),u(W,S)}),t(g),t(H),t(Y),u(k,Y)},z=k=>{var Y=Os();u(k,Y)};I(ye,k=>{e(d)&&e(d).length>0?k(U):k(z,!1)},!0)}u(N,ie)};I(se,N=>{e(f)?N(ge):N(ue,!1)})}t(te),u(n,te),Gt()}var Hs=w('<span class="material-symbols-outlined">download</span> Download Backup',1),Vs=w('<div class="selected-file svelte-xh59jx"><span class="material-symbols-outlined">check_circle</span> <div><p class="file-name svelte-xh59jx"> </p> <p class="file-size svelte-xh59jx"> </p></div></div>'),Bs=w('<div class="preview-summary-box svelte-xh59jx"><h4 class="summary-title svelte-xh59jx">Import Summary</h4> <div class="summary-grid svelte-xh59jx"><div><p class="summary-stat svelte-xh59jx"><span class="font-semibold"> </span> total items</p> <p class="summary-subtext svelte-xh59jx"> </p></div></div></div>'),Js=w('<span class="section-badge duplicate-badge svelte-xh59jx"> </span>'),Gs=w('<div class="duplicate-badge-box svelte-xh59jx"><span class="material-symbols-outlined">warning</span> <span> </span></div>'),Ys=w('<p class="item-summary-text svelte-xh59jx"> </p>'),Ws=w('<div class="duplicate-badge-box svelte-xh59jx"><span class="material-symbols-outlined">warning</span> <span>Duplicate</span></div>'),Zs=w('<p class="item-summary-text svelte-xh59jx"> </p>'),Ks=w('<div><!> <div class="item-checkbox-wrapper svelte-xh59jx"><input type="checkbox" class="svelte-xh59jx"/> <label class="item-label svelte-xh59jx"><div class="item-main-content svelte-xh59jx"><span class="item-name-text svelte-xh59jx"> </span> <!></div></label></div></div>'),Xs=w('<div class="trip-children svelte-xh59jx"></div>'),Qs=w('<div><!> <div class="item-checkbox-wrapper svelte-xh59jx"><input type="checkbox" class="svelte-xh59jx"/> <label class="item-label svelte-xh59jx"><div class="item-main-content svelte-xh59jx"><span class="item-name-text svelte-xh59jx"> </span> <!></div></label></div></div> <!>',1),eo=w('<div class="section-group svelte-xh59jx"><div class="section-header-bar svelte-xh59jx"><div class="section-header-left svelte-xh59jx"><span class="material-symbols-outlined section-icon svelte-xh59jx"> </span> <h4 class="section-title svelte-xh59jx"> </h4> <span class="section-badge svelte-xh59jx"> </span> <!></div> <label class="section-select-all svelte-xh59jx"><input type="checkbox" class="svelte-xh59jx"/> <span>All</span></label></div> <div class="section-items svelte-xh59jx"></div></div>'),to=w('<span class="material-symbols-outlined">check</span> Import Selected',1),ao=w('<span class="material-symbols-outlined">arrow_back</span> Back',1),ro=w('<div class="preview-section svelte-xh59jx"><!> <div class="preview-lists svelte-xh59jx"></div> <div class="preview-actions svelte-xh59jx"><!> <!></div></div>'),io=w('<div class="settings-backup-container svelte-xh59jx"><!> <!> <div class="export-section svelte-xh59jx"><div class="section-header svelte-xh59jx"><div class="icon-box export svelte-xh59jx"><span class="material-symbols-outlined">download</span></div> <h3 class="svelte-xh59jx">Export Data</h3></div> <!></div> <div class="import-section svelte-xh59jx"><div class="section-header svelte-xh59jx"><div class="icon-box import svelte-xh59jx"><span class="material-symbols-outlined">upload</span></div> <h3 class="svelte-xh59jx">Import Data</h3></div> <div class="file-input-wrapper svelte-xh59jx"><input type="file" accept=".json" id="file-input" class="svelte-xh59jx"/> <label for="file-input" class="file-label svelte-xh59jx"><span class="material-symbols-outlined">description</span> <span>Choose JSON File</span></label></div> <!></div> <!></div>');function no(n,s){Jt(s,!1);let d=ne(!1),f=ne(null),x=ne(null),m=ne(null),v=ne(null),p=ne(!1),h=ne({}),P=ne(!1);async function L(){try{o(d,!0),o(f,null);const C=await la.exportData(),S=window.URL.createObjectURL(C),y=document.createElement("a");y.href=S,y.download=`bluebonnet-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(y),y.click(),document.body.removeChild(y),window.URL.revokeObjectURL(S),o(x,"Data exported successfully"),setTimeout(()=>{o(x,null)},3e3)}catch(C){o(f,C instanceof Error?C.message:"Failed to export data")}finally{o(d,!1)}}async function ve(C){const y=C.target.files;if(!y||y.length===0)return;const _=y[0];if(_.type!=="application/json"){o(f,"Please select a valid JSON file");return}o(m,_),o(f,null),await re(_)}async function re(C){const S=C||e(m);if(!S){o(f,"Please select a file");return}try{o(p,!0),o(f,null);const y=await la.previewImport(S),_=y.data||y;o(v,_.preview||_),o(h,{}),e(v).items&&Array.isArray(e(v).items)&&e(v).items.forEach(F=>{Q(h,e(h)[F.id]=F.selected!==!1)})}catch(y){o(f,y instanceof Error?y.message:"Failed to preview import")}finally{o(p,!1)}}async function te(){if(e(v))try{o(P,!0),o(f,null);const C=Object.entries(e(h)).filter(([,A])=>A).map(([A])=>A);if(C.length===0){o(f,"Please select items to import");return}const S={trips:[],standaloneFlights:[],standaloneHotels:[],standaloneTransportation:[],standaloneCarRentals:[],standaloneEvents:[],vouchers:[],companions:[]},y={},_=new Set(C);if(e(v).items&&Array.isArray(e(v).items)){for(const A of e(v).items)if(_.has(A.id))if(A.type==="trip")y[A.originalId]={...A.data,flights:[],hotels:[],transportation:[],carRentals:[],events:[]},S.trips.push(y[A.originalId]);else if(A.type==="flight")if(A.parentTripId){const ae=e(v).items.find(ke=>ke.id===A.parentTripId);ae&&y[ae.originalId]&&y[ae.originalId].flights.push(A.data)}else S.standaloneFlights.push(A.data);else if(A.type==="hotel")if(A.parentTripId){const ae=e(v).items.find(ke=>ke.id===A.parentTripId);ae&&y[ae.originalId]&&y[ae.originalId].hotels.push(A.data)}else S.standaloneHotels.push(A.data);else if(A.type==="transportation")if(A.parentTripId){const ae=e(v).items.find(ke=>ke.id===A.parentTripId);ae&&y[ae.originalId]&&y[ae.originalId].transportation.push(A.data)}else S.standaloneTransportation.push(A.data);else if(A.type==="carRental")if(A.parentTripId){const ae=e(v).items.find(ke=>ke.id===A.parentTripId);ae&&y[ae.originalId]&&y[ae.originalId].carRentals.push(A.data)}else S.standaloneCarRentals.push(A.data);else if(A.type==="event")if(A.parentTripId){const ae=e(v).items.find(ke=>ke.id===A.parentTripId);ae&&y[ae.originalId]&&y[ae.originalId].events.push(A.data)}else S.standaloneEvents.push(A.data);else A.type==="voucher"?S.vouchers.push(A.data):A.type==="companion"&&S.companions.push(A.data)}const F=await la.importData({importData:S,selectedItemIds:C});F&&F.success&&(o(x,`Successfully imported ${F.stats?Object.values(F.stats).reduce((A,ae)=>A+(typeof ae=="number"?ae:0),0):C.length} items`),o(m,null),o(v,null),o(h,{}),typeof window<"u"&&window.dispatchEvent(new CustomEvent("dataImported",{detail:{stats:F.stats}})),setTimeout(()=>{o(x,null)},5e3))}catch(C){o(f,C instanceof Error?C.message:"Failed to import data")}finally{o(P,!1)}}function he(C,S,y){S.map(F=>F.id).forEach(F=>{Q(h,e(h)[F]=y)}),o(h,{...e(h)})}function le(C,S){Q(h,e(h)[C]=S),o(h,{...e(h)})}function i(C,S){if(Q(h,e(h)[C]=S),S){const y=e(v).items.find(_=>_.id===C);y&&y.children&&["flights","hotels","transportation","carRentals","events"].forEach(_=>{y.children[_]&&y.children[_].length>0&&y.children[_].forEach(F=>{Q(h,e(h)[F]=!0)})})}o(h,{...e(h)})}Yt();var E=io(),se=a(E);{var ge=C=>{Ra(C,{type:"error",get message(){return e(f)},dismissible:!0})};I(se,C=>{e(f)&&C(ge)})}var ue=r(se,2);{var N=C=>{Ra(C,{type:"success",get message(){return e(x)},dismissible:!0})};I(ue,C=>{e(x)&&C(N)})}var ie=r(ue,2),ye=r(a(ie),2);Aa(ye,{variant:"primary",get disabled(){return e(d)},get loading(){return e(d)},$$events:{click:L},children:(C,S)=>{var y=Hs();Ft(),u(C,y)},$$slots:{default:!0}}),t(ie);var U=r(ie,2),z=r(a(U),2),k=a(z);Ft(2),t(z);var Y=r(z,2);{var H=C=>{var S=Vs(),y=r(a(S),2),_=a(y),F=a(_,!0);t(_);var A=r(_,2),ae=a(A);t(A),t(y),t(S),K(ke=>{q(F,e(m).name),q(ae,`${ke??""} KB`)},[()=>(e(m).size/1024).toFixed(2)]),u(C,S)};I(Y,C=>{e(m)&&C(H)})}t(U);var g=r(U,2);{var W=C=>{var S=ro(),y=a(S);{var _=de=>{var pe=Bs(),B=r(a(pe),2),J=a(B),Z=a(J),O=a(Z),ce=a(O,!0);t(O),Ft(),t(Z);var Me=r(Z,2),Le=a(Me);t(Me),t(J),t(B),t(pe),K(()=>{q(ce,e(v).stats.totalItems),q(Le,`${e(v).stats.totalDuplicates??""} possible duplicates`)}),u(de,pe)};I(y,de=>{e(v).stats&&de(_)})}var F=r(y,2);ut(F,4,()=>[{key:"trips",label:"Trips",icon:"luggage"},{key:"standaloneFlights",label:"Standalone Flights",icon:"flight"},{key:"standaloneHotels",label:"Standalone Hotels",icon:"apartment"},{key:"standaloneTransportation",label:"Standalone Transportation",icon:"local_taxi"},{key:"standaloneCarRentals",label:"Standalone Car Rentals",icon:"directions_car"},{key:"standaloneEvents",label:"Standalone Events",icon:"event"},{key:"vouchers",label:"Vouchers & Credits",icon:"card_giftcard"},{key:"companions",label:"Travel Companions",icon:"person_add"}],ha,(de,pe)=>{const B=Ke(()=>e(v).items.filter(ce=>ce.category===pe.key));var J=je(),Z=fe(J);{var O=ce=>{const Me=Ke(()=>e(B).filter(Ne=>Ne.isDuplicate).length);var Le=eo(),pt=a(Le),Je=a(pt),M=a(Je),V=a(M,!0);t(M);var X=r(M,2),_e=a(X,!0);t(X);var Ie=r(X,2),Pe=a(Ie);t(Ie);var _t=r(Ie,2);{var At=Ne=>{var l=Js(),j=a(l);t(l),K(()=>q(j,`${e(Me)??""} duplicates`)),u(Ne,l)};I(_t,Ne=>{e(Me)>0&&Ne(At)})}t(Je);var et=r(Je,2),tt=a(et);be(tt),Ft(2),t(et),t(pt);var Xe=r(pt,2);ut(Xe,5,()=>e(B),Ne=>Ne.id,(Ne,l)=>{var j=Qs(),b=fe(j);let T;var $=a(b);{var oe=Oe=>{var Re=Gs(),Ue=r(a(Re),2),Ve=a(Ue);t(Ue),t(Re),K(()=>q(Ve,`Possible duplicate: ${e(l).duplicateOf.name??""}`)),u(Oe,Re)};I($,Oe=>{e(l).isDuplicate&&e(l).duplicateOf&&Oe(oe)})}var we=r($,2),Ce=a(we);be(Ce);var Te=r(Ce,2),$e=a(Te),ze=a($e),Ze=a(ze,!0);t(ze);var Ge=r(ze,2);{var Ee=Oe=>{var Re=Ys(),Ue=a(Re,!0);t(Re),K(()=>q(Ue,e(l).summary)),u(Oe,Re)};I(Ge,Oe=>{e(l).summary&&Oe(Ee)})}t($e),t(Te),t(we),t(b);var G=r(b,2);{var Ye=Oe=>{var Re=Xs();ut(Re,4,()=>["flights","hotels","transportation","carRentals","events"],ha,(Ue,Ve)=>{var st=je(),me=fe(st);{var He=De=>{var at=je(),it=fe(at);ut(it,1,()=>e(l).children[Ve],ha,(Fe,nt)=>{const Be=Ke(()=>e(v).items.find(ot=>ot.id===e(nt)));var Tt=je(),Wt=fe(Tt);{var Dt=ot=>{var qe=Ks();let yt;var $t=a(qe);{var Nt=Qe=>{var ft=Ws();u(Qe,ft)};I($t,Qe=>{e(Be).isDuplicate&&e(Be).duplicateOf&&Qe(Nt)})}var bt=r($t,2),dt=a(bt);be(dt);var Pt=r(dt,2),qt=a(Pt),Ct=a(qt),xt=a(Ct,!0);t(Ct);var D=r(Ct,2);{var ga=Qe=>{var ft=Zs(),Lt=a(ft,!0);t(ft),K(()=>q(Lt,e(Be).summary)),u(Qe,ft)};I(D,Qe=>{e(Be).summary&&Qe(ga)})}t(qt),t(Pt),t(bt),t(qe),K(()=>{yt=kt(qe,1,"item-card item-card-nested svelte-xh59jx",null,yt,{duplicate:e(Be).isDuplicate}),gt(dt,"id",`item-${e(Be).id??""}`),hr(dt,e(h)[e(Be).id]||!1),dt.disabled=e(P),gt(Pt,"for",`item-${e(Be).id??""}`),q(xt,e(Be).name)}),R("change",dt,Qe=>{le(e(Be).id,Qe.target.checked)}),u(ot,qe)};I(Wt,ot=>{e(Be)&&ot(Dt)})}u(Fe,Tt)}),u(De,at)};I(me,De=>{e(l).children[Ve]&&e(l).children[Ve].length>0&&De(He)})}u(Ue,st)}),t(Re),u(Oe,Re)};I(G,Oe=>{pe.key==="trips"&&e(l).children&&Oe(Ye)})}K(()=>{T=kt(b,1,"item-card svelte-xh59jx",null,T,{duplicate:e(l).isDuplicate}),gt(Ce,"id",`item-${e(l).id??""}`),hr(Ce,e(h)[e(l).id]||!1),Ce.disabled=e(P),gt(Te,"for",`item-${e(l).id??""}`),q(Ze,e(l).name)}),R("change",Ce,Oe=>{pe.key==="trips"?i(e(l).id,Oe.target.checked):le(e(l).id,Oe.target.checked)}),u(Ne,j)}),t(Xe),t(Le),K(Ne=>{q(V,pe.icon),q(_e,pe.label),q(Pe,`${e(B).length??""} items`),hr(tt,Ne),tt.disabled=e(P)},[()=>e(B).every(Ne=>e(h)[Ne.id])]),R("change",tt,Ne=>he(pe.key,e(B),Ne.target.checked)),u(ce,Le)};I(Z,ce=>{e(B).length>0&&ce(O)})}u(de,J)}),t(F);var A=r(F,2),ae=a(A);{let de=Ke(()=>Object.values(e(h)).every(pe=>!pe)||e(P));Aa(ae,{variant:"primary",get disabled(){return e(de)},get loading(){return e(P)},$$events:{click:te},children:(pe,B)=>{var J=to();Ft(),u(pe,J)},$$slots:{default:!0}})}var ke=r(ae,2);Aa(ke,{variant:"secondary",get disabled(){return e(P)},$$events:{click:()=>{o(v,null),o(h,{})}},children:(de,pe)=>{var B=ao();Ft(),u(de,B)},$$slots:{default:!0}}),t(A),t(S),u(C,S)};I(g,C=>{e(v)&&e(v).items&&e(v).items.length>0&&C(W)})}t(E),K(()=>k.disabled=e(p)||e(P)),R("change",k,ve),u(n,E),Gt()}var so=w('<div class="error-message"> </div>'),oo=w('<p class="help-text svelte-mv3v44">Email cannot be changed</p>'),lo=w('<div class="edit-content"><!> <form><div class="form-fields"><div class="form-row cols-2-1"><div class="form-group"><label for="firstName">First Name</label> <input id="firstName" type="text" placeholder="John"/></div> <div class="form-group"><label for="lastName">Last Initial</label> <input id="lastName" type="text" placeholder="D" maxlength="1"/></div></div> <div class="form-group"><label for="email">Email Address *</label> <input id="email" type="email" placeholder="companion@example.com" required/> <!></div> <div class="checkbox-wrapper svelte-mv3v44"><label for="can-edit" class="checkbox-label svelte-mv3v44"><input id="can-edit" type="checkbox" class="svelte-mv3v44"/> Allow editing of trip items</label> <p class="checkbox-help-text svelte-mv3v44">If unchecked, companion can only view your trips</p></div></div> <div class="form-buttons"><button class="submit-btn" type="submit"> </button> <button class="cancel-btn" type="button">Cancel</button></div></form></div>');function Br(n,s){Jt(s,!1);let d=Se(s,"companion",8,null),f=Se(s,"onSuccess",8,null),x=Se(s,"onCancel",8,null),m=ne(!1),v=ne(null),p=ne({firstName:"",lastName:"",email:"",canEdit:!1});const h=!!d()?.id;async function P(){try{if(o(v,null),!e(p).email.trim()){o(v,"Email is required");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e(p).email)){o(v,"Please enter a valid email address");return}if(h&&(e(p).firstName||e(p).lastName)&&(!e(p).firstName||!e(p).lastName)){o(v,"Please provide both first name and last name, or neither");return}o(m,!0);const S={firstName:e(p).firstName||void 0,lastName:e(p).lastName||void 0,email:e(p).email,canBeAddedByOthers:e(p).canEdit};let y;h?y=await la.updateCompanion(d().id,S):y=await la.createCompanion(S);const _=y.data||y.companion||y;f()&&f()(_)}catch(S){o(v,S instanceof Error?S.message:h?"Failed to update companion":"Failed to add companion")}finally{o(m,!1)}}function L(){x()&&x()()}pa(()=>Ae(d()),()=>{d()&&o(p,{firstName:d().firstName||"",lastName:d().lastName||"",email:d().email||"",canEdit:d().canBeAddedByOthers||!1})}),Wa(),Yt();var ve=lo(),re=a(ve);{var te=S=>{var y=so(),_=a(y,!0);t(y),K(()=>q(_,e(v))),u(S,y)};I(re,S=>{e(v)&&S(te)})}var he=r(re,2),le=a(he),i=a(le),E=a(i),se=r(a(E),2);be(se),t(E);var ge=r(E,2),ue=r(a(ge),2);be(ue),t(ge),t(i);var N=r(i,2),ie=r(a(N),2);be(ie);var ye=r(ie,2);{var U=S=>{var y=oo();u(S,y)};I(ye,S=>{h&&S(U)})}t(N);var z=r(N,2),k=a(z),Y=a(k);be(Y),Ft(),t(k),Ft(2),t(z),t(le);var H=r(le,2),g=a(H),W=a(g,!0);t(g);var C=r(g,2);t(H),t(he),t(ve),K(()=>{se.disabled=e(m),ue.disabled=e(m),ie.disabled=e(m)||h,Y.disabled=e(m),g.disabled=e(m),q(W,h?"Update":"Add Companion"),C.disabled=e(m)}),xe(se,()=>e(p).firstName,S=>Q(p,e(p).firstName=S)),xe(ue,()=>e(p).lastName,S=>Q(p,e(p).lastName=S)),xe(ie,()=>e(p).email,S=>Q(p,e(p).email=S)),ei(Y,()=>e(p).canEdit,S=>Q(p,e(p).canEdit=S)),R("click",C,L),R("submit",he,ur(P)),u(n,ve),Gt()}var co=w('<div class="companion-circle svelte-1xpgi64"> </div>'),vo=w('<div class="companion-indicators svelte-1xpgi64"></div>');function uo(n,s){Jt(s,!1);let d=Se(s,"companions",24,()=>[]);function f(v){return v?v.charAt(0).toUpperCase():"?"}function x(v){const p=["#FF6B6B","#4ECDC4","#45B7D1","#FFA07A","#98D8C8","#F7DC6F","#BB8FCE","#85C1E2","#F8B88B","#A9CCE3"],h=v.charCodeAt(0);return p[h%p.length]}Yt();var m=vo();ut(m,5,d,v=>v.id,(v,p)=>{var h=co(),P=a(h,!0);t(h),K((L,ve)=>{xr(h,`background-color: ${L??""}`),gt(h,"title",(e(p),c(()=>e(p).email))),q(P,ve)},[()=>(e(p),c(()=>x(f(e(p).email)))),()=>(e(p),c(()=>f(e(p).email)))]),u(v,h)}),t(m),u(n,m),Gt()}var po=w('<div class="settings-main-panel svelte-x1i5gj"><div class="settings-main-content svelte-x1i5gj"><div class="settings-section svelte-x1i5gj"><h3 class="svelte-x1i5gj">Account</h3> <button class="settings-item svelte-x1i5gj"><span class="material-symbols-outlined svelte-x1i5gj">person</span> <span class="svelte-x1i5gj">Profile</span></button> <button class="settings-item svelte-x1i5gj"><span class="material-symbols-outlined svelte-x1i5gj">lock</span> <span class="svelte-x1i5gj">Security</span></button></div> <div class="settings-section svelte-x1i5gj"><h3 class="svelte-x1i5gj">Manage Vouchers & Credits</h3> <button class="settings-item svelte-x1i5gj"><span class="material-symbols-outlined svelte-x1i5gj">card_giftcard</span> <span class="svelte-x1i5gj">Vouchers & Credits</span></button></div> <div class="settings-section svelte-x1i5gj"><h3 class="svelte-x1i5gj">Manage Travel Companions</h3> <button class="settings-item svelte-x1i5gj"><span class="material-symbols-outlined svelte-x1i5gj">people</span> <span class="svelte-x1i5gj">Travel Companions</span></button></div> <div class="settings-section svelte-x1i5gj"><h3 class="svelte-x1i5gj">Data</h3> <button class="settings-item svelte-x1i5gj"><span class="material-symbols-outlined svelte-x1i5gj">cloud_download</span> <span class="svelte-x1i5gj">Backup & Export</span></button></div> <div class="settings-section svelte-x1i5gj"><h3 class="svelte-x1i5gj">Account Actions</h3> <a href="/logout" class="settings-item logout svelte-x1i5gj"><span class="material-symbols-outlined svelte-x1i5gj">logout</span> <span class="svelte-x1i5gj">Sign Out</span></a></div></div></div>'),fo=w('<div class="empty-state svelte-x1i5gj"><span class="material-symbols-outlined empty-icon svelte-x1i5gj">calendar_month</span> <p> </p> <!></div>'),mo=w('<p class="trip-cities svelte-x1i5gj"> </p>'),ho=w('<div class="trip-companions svelte-x1i5gj"><!></div>'),go=w('<span class="date-header-layover svelte-x1i5gj"> </span>'),_o=w('<span class="date-header-layover svelte-x1i5gj"> </span>'),yo=w('<div class="layover-indicator svelte-x1i5gj"><p class="layover-text svelte-x1i5gj"> </p></div>'),bo=w('<div role="button" tabindex="0"><div class="flight-icon-wrapper svelte-x1i5gj"><p class="flight-time-label svelte-x1i5gj"> </p> <div class="item-icon blue svelte-x1i5gj"><span class="material-symbols-outlined" style="font-size: 1.3rem;">flight</span></div></div> <div class="item-content svelte-x1i5gj"><p class="item-title svelte-x1i5gj"> </p> <p class="item-route svelte-x1i5gj"> </p></div></div>  <!>',1),xo=w('<div role="button" tabindex="0"><div class="item-icon green svelte-x1i5gj"><span class="material-symbols-outlined" style="font-size: 1.3rem;">hotel</span></div> <div class="item-content svelte-x1i5gj"><p class="item-title svelte-x1i5gj"> </p> <p class="item-dates svelte-x1i5gj"> </p> <p class="item-route svelte-x1i5gj"> </p></div></div>'),To=w('<div class="standalone-item-card svelte-x1i5gj" role="button" tabindex="0"><div class="flight-icon-wrapper svelte-x1i5gj"><p class="flight-time-label svelte-x1i5gj"> </p> <div class="item-icon red svelte-x1i5gj"><span class="material-symbols-outlined" style="font-size: 1.3rem;"> </span></div></div> <div class="item-content svelte-x1i5gj"><p class="item-title svelte-x1i5gj"> </p> <p class="item-route svelte-x1i5gj"> </p></div></div>'),Do=w('<div class="standalone-item-card svelte-x1i5gj" role="button" tabindex="0"><div class="item-icon gray svelte-x1i5gj"><span class="material-symbols-outlined" style="font-size: 1.3rem;">directions_car</span></div> <div class="item-content svelte-x1i5gj"><p class="item-title svelte-x1i5gj"> </p> <p class="item-time svelte-x1i5gj"> </p> <p class="item-route svelte-x1i5gj"> </p></div></div>'),wo=w('<div class="item-icon purple svelte-x1i5gj"><span class="material-symbols-outlined" style="font-size: 1.3rem;">event</span></div>'),ko=w('<div class="flight-icon-wrapper svelte-x1i5gj"><p class="flight-time-label svelte-x1i5gj"> </p> <div class="item-icon purple svelte-x1i5gj"><span class="material-symbols-outlined" style="font-size: 1.3rem;">event</span></div></div>'),Co=w('<div class="standalone-item-card svelte-x1i5gj" role="button" tabindex="0"><!> <div class="item-content svelte-x1i5gj"><p class="item-title svelte-x1i5gj"> </p> <p class="item-time svelte-x1i5gj"> </p> <p class="item-route svelte-x1i5gj"> </p></div></div>'),Eo=w('<div class="trip-item-date-group svelte-x1i5gj"><div class="trip-item-date-header svelte-x1i5gj"><span class="trip-date-badge svelte-x1i5gj"> </span> <div class="date-header-layovers svelte-x1i5gj"><!></div></div> <div class="trip-item-date-items svelte-x1i5gj"></div></div>'),jo=w('<div class="trip-items svelte-x1i5gj"></div>'),No=w('<div><div class="trip-header svelte-x1i5gj" role="button" tabindex="0"><div class="trip-icon-container svelte-x1i5gj"><span class="material-symbols-outlined trip-icon svelte-x1i5gj"> </span></div> <div class="trip-info svelte-x1i5gj"><div class="trip-name-row svelte-x1i5gj"><h3 class="trip-name svelte-x1i5gj"> </h3> <button class="edit-btn svelte-x1i5gj" title="Edit trip details and companions"><span class="material-symbols-outlined">edit</span></button></div> <p class="trip-dates svelte-x1i5gj"> </p> <!></div> <!> <button><span class="material-symbols-outlined">expand_more</span></button></div> <!></div>'),So=w('<p class="item-dates svelte-x1i5gj"> </p>'),Mo=w('<p class="item-time svelte-x1i5gj"><!></p>'),Io=w('<div class="standalone-item-card svelte-x1i5gj" role="button" tabindex="0"><div><span class="material-symbols-outlined"> </span></div> <div class="item-content svelte-x1i5gj"><p class="item-title svelte-x1i5gj"> </p> <!> <p class="item-route svelte-x1i5gj"><!></p></div></div>'),Ao=w('<div class="timeline-date-group svelte-x1i5gj"><div class="timeline-date-header svelte-x1i5gj"><span class="date-badge svelte-x1i5gj"> </span></div> <div class="timeline-items svelte-x1i5gj"></div></div>'),$o=w('<div class="trips-list svelte-x1i5gj"></div>'),Po=w('<div slot="primary" class="primary-content svelte-x1i5gj"><div class="header-section svelte-x1i5gj"><div class="header-top svelte-x1i5gj"><h1 class="svelte-x1i5gj">My Trips</h1> <div class="header-buttons svelte-x1i5gj"><button class="icon-btn svelte-x1i5gj" title="View calendar"><span class="material-symbols-outlined">calendar_month</span></button> <button class="add-btn svelte-x1i5gj" title="Add new trip"><span class="material-symbols-outlined">add</span></button></div></div> <!> <nav class="tabs svelte-x1i5gj"><div class="tabs-left svelte-x1i5gj"><button>Upcoming</button> <button>Past</button></div> <button title="Settings"><span class="material-symbols-outlined" style="font-size: 1.1rem;">settings</span></button></nav></div> <div class="trips-content svelte-x1i5gj"><!></div></div>'),qo=w('<div class="calendar-sidebar-container svelte-x1i5gj"><div class="calendar-sidebar-header svelte-x1i5gj"><h2 class="svelte-x1i5gj">Calendar</h2> <button class="close-btn svelte-x1i5gj" title="Close"><span class="material-symbols-outlined">close</span></button></div> <!></div>'),Lo=w('<div class="settings-panel svelte-x1i5gj"><div class="settings-panel-header svelte-x1i5gj"><h2 class="svelte-x1i5gj">Profile</h2> <button class="close-btn svelte-x1i5gj" title="Close"><span class="material-symbols-outlined">close</span></button></div> <div class="settings-panel-content svelte-x1i5gj"><!></div></div>'),Ro=w('<div class="settings-panel svelte-x1i5gj"><div class="settings-panel-header svelte-x1i5gj"><h2 class="svelte-x1i5gj">Security</h2> <button class="close-btn svelte-x1i5gj" title="Close"><span class="material-symbols-outlined">close</span></button></div> <div class="settings-panel-content svelte-x1i5gj"><!></div></div>'),Fo=w('<div class="calendar-sidebar-container svelte-x1i5gj"><div class="calendar-sidebar-header svelte-x1i5gj"><h2 class="svelte-x1i5gj">Vouchers & Credits</h2> <button class="close-btn svelte-x1i5gj" title="Close"><span class="material-symbols-outlined">close</span></button></div> <!></div>'),Oo=w('<div class="calendar-sidebar-container svelte-x1i5gj"><div class="calendar-sidebar-header svelte-x1i5gj"><h2 class="svelte-x1i5gj">Travel Companions</h2> <div class="header-actions svelte-x1i5gj"><button class="add-companion-btn svelte-x1i5gj" title="Add Companion"><span class="material-symbols-outlined">group_add</span></button> <button class="close-btn svelte-x1i5gj" title="Close"><span class="material-symbols-outlined">close</span></button></div></div> <!></div>'),zo=w('<div class="calendar-sidebar-container svelte-x1i5gj"><div class="calendar-sidebar-header svelte-x1i5gj"><h2 class="svelte-x1i5gj">Backup & Export</h2> <button class="close-btn svelte-x1i5gj" title="Close"><span class="material-symbols-outlined">close</span></button></div> <!></div>'),Uo=w('<div class="new-item-menu svelte-x1i5gj"><div class="menu-header svelte-x1i5gj"><h2 class="menu-title svelte-x1i5gj">Add New Item</h2> <button class="close-menu-btn svelte-x1i5gj" title="Close"><span class="material-symbols-outlined">close</span></button></div> <div class="menu-items svelte-x1i5gj"><button class="menu-item svelte-x1i5gj"><div class="menu-item-icon amber svelte-x1i5gj"><span class="material-symbols-outlined">flight</span></div> <div class="menu-item-content svelte-x1i5gj"><h3 class="svelte-x1i5gj">Trip</h3> <p class="svelte-x1i5gj">Plan a complete trip with dates</p></div> <span class="material-symbols-outlined menu-arrow svelte-x1i5gj">chevron_right</span></button> <div class="menu-divider svelte-x1i5gj"><span class="svelte-x1i5gj">or add a single item</span></div> <button class="menu-item svelte-x1i5gj"><div class="menu-item-icon blue svelte-x1i5gj"><span class="material-symbols-outlined">flight</span></div> <div class="menu-item-content svelte-x1i5gj"><h3 class="svelte-x1i5gj">Flight</h3> <p class="svelte-x1i5gj">Add a flight booking</p></div> <span class="material-symbols-outlined menu-arrow svelte-x1i5gj">chevron_right</span></button> <button class="menu-item svelte-x1i5gj"><div class="menu-item-icon green svelte-x1i5gj"><span class="material-symbols-outlined">hotel</span></div> <div class="menu-item-content svelte-x1i5gj"><h3 class="svelte-x1i5gj">Hotel</h3> <p class="svelte-x1i5gj">Add a hotel or accommodation</p></div> <span class="material-symbols-outlined menu-arrow svelte-x1i5gj">chevron_right</span></button> <button class="menu-item svelte-x1i5gj"><div class="menu-item-icon red svelte-x1i5gj"><span class="material-symbols-outlined">train</span></div> <div class="menu-item-content svelte-x1i5gj"><h3 class="svelte-x1i5gj">Transportation</h3> <p class="svelte-x1i5gj">Train, bus, taxi, or other transit</p></div> <span class="material-symbols-outlined menu-arrow svelte-x1i5gj">chevron_right</span></button> <button class="menu-item svelte-x1i5gj"><div class="menu-item-icon gray svelte-x1i5gj"><span class="material-symbols-outlined">directions_car</span></div> <div class="menu-item-content svelte-x1i5gj"><h3 class="svelte-x1i5gj">Car Rental</h3> <p class="svelte-x1i5gj">Add a car rental booking</p></div> <span class="material-symbols-outlined menu-arrow svelte-x1i5gj">chevron_right</span></button> <button class="menu-item svelte-x1i5gj"><div class="menu-item-icon purple svelte-x1i5gj"><span class="material-symbols-outlined">event</span></div> <div class="menu-item-content svelte-x1i5gj"><h3 class="svelte-x1i5gj">Event</h3> <p class="svelte-x1i5gj">Concert, conference, or activity</p></div> <span class="material-symbols-outlined menu-arrow svelte-x1i5gj">chevron_right</span></button></div></div>'),Ho=w('<div slot="secondary"><!></div>'),Vo=w('<div class="tertiary-header svelte-x1i5gj"><h3 class="svelte-x1i5gj">Edit Voucher</h3> <button class="close-btn svelte-x1i5gj" title="Close"><span class="material-symbols-outlined">close</span></button></div> <div class="tertiary-form-container svelte-x1i5gj"><!></div>',1),Bo=w('<div class="tertiary-header svelte-x1i5gj"><h3 class="svelte-x1i5gj">Add Voucher</h3> <button class="close-btn svelte-x1i5gj" title="Close"><span class="material-symbols-outlined">close</span></button></div> <div class="tertiary-form-container svelte-x1i5gj"><!></div>',1),Jo=w('<div class="tertiary-header svelte-x1i5gj"><h3 class="svelte-x1i5gj">Add Companion</h3> <button class="close-btn svelte-x1i5gj" title="Close"><span class="material-symbols-outlined">close</span></button></div> <div class="tertiary-form-container svelte-x1i5gj"><!></div>',1),Go=w('<div class="tertiary-header svelte-x1i5gj"><h3 class="svelte-x1i5gj">Edit Companion</h3> <button class="close-btn svelte-x1i5gj" title="Close"><span class="material-symbols-outlined">close</span></button></div> <div class="tertiary-form-container svelte-x1i5gj"><!></div>',1),Yo=w('<div slot="tertiary" class="tertiary-content svelte-x1i5gj"><!></div>');function vl(n,s){Jt(s,!1);const d=()=>$i(qi,"$authStore",f),[f,x]=Ai();let m=ne([]),v=ne({flights:[],hotels:[],transportation:[],carRentals:[],events:[]}),p=ne([]),h=ne("upcoming"),P=ne("trips"),L=ne(!0),ve=ne(null),re=ne(new Set),te=ne({flights:[],hotels:[],events:[],transportation:[],carRentals:[]}),he=ne(null),le=ne(null),i=ne(null),E=ne(null),se=ne(null),ge=ne({}),ue=ne([]);function N(l){let j,b=null;if(l.type==="trip"?j=k(l.data.departureDate):(j=l.sortDate,l.itemType==="flight"?b=l.data.originTimezone:l.itemType==="hotel"?b=l.data.timezone:l.itemType==="transportation"?b=l.data.originTimezone:l.itemType==="carRental"?b=l.data.pickupTimezone:l.itemType==="event"&&(b=l.data.timezone)),b)try{const we=new Intl.DateTimeFormat("en-CA",{year:"numeric",month:"2-digit",timeZone:b}).formatToParts(j),Ce={};return we.forEach(Te=>{Te.type!=="literal"&&(Ce[Te.type]=Te.value)}),`${Ce.year}-${Ce.month}`}catch{}const T=j.getUTCFullYear(),$=String(j.getUTCMonth()+1).padStart(2,"0");return`${T}-${$}`}async function ie(){try{const l=await Ya.getAll("all"),j=l?.trips||[];o(v,l?.standalone||{flights:[],hotels:[],transportation:[],carRentals:[],events:[]});const b=await Promise.all(j.map(async T=>{try{return await Ya.getOne(T.id)}catch($){return console.error("Error fetching trip details:",$),T}}));Gi.setTrips(b),o(m,b),g(),W()}catch(l){const j=l instanceof Error?l.message:"Failed to load trips";o(ve,j)}finally{o(L,!1)}}function ye(){ie()}function U(){O("add-companion",{})}function z(l){const j=l.detail?.companion;j&&O("edit-companion",{companion:j})}Va(async()=>(await ie(),window.addEventListener("dataImported",ye),window.addEventListener("add-companion",U),window.addEventListener("edit-companion",z),()=>{window.removeEventListener("dataImported",ye),window.removeEventListener("add-companion",U),window.removeEventListener("edit-companion",z)}));function k(l){if(!l)return new Date(0);const[j,b,T]=l.split("-").map(Number);return new Date(j,b-1,T,0,0,0,0)}function Y(l){return l.returnDate?k(l.returnDate):l.departureDate?k(l.departureDate):new Date(0)}function H(l,j){return j==="flight"?new Date(l.departureDateTime):j==="hotel"?new Date(l.checkInDateTime):j==="transportation"?new Date(l.departureDateTime):j==="carRental"?new Date(l.pickupDateTime):j==="event"?new Date(l.startDateTime):new Date(0)}function g(){const l=new Date;l.setHours(0,0,0,0);const j=[];e(m).forEach(b=>{j.push({type:"trip",data:b,sortDate:b.departureDate?k(b.departureDate):new Date(0)})}),["flights","hotels","transportation","carRentals","events"].forEach(b=>{const T={flights:"flight",hotels:"hotel",transportation:"transportation",carRentals:"carRental",events:"event"};e(v)[b]&&e(v)[b].forEach($=>{j.push({type:"standalone",itemType:T[b],data:$,sortDate:H($,T[b])})})}),e(h)==="upcoming"?(o(p,j.filter(b=>{if(b.type==="trip"){const T=b.data.departureDate?k(b.data.departureDate):null;return T&&T>=l}else return b.sortDate>=l})),e(p).sort((b,T)=>b.sortDate.getTime()-T.sortDate.getTime())):e(h)==="past"&&(o(p,j.filter(b=>b.type==="trip"?Y(b.data)<l:b.sortDate<l)),e(p).sort((b,T)=>T.sortDate.getTime()-b.sortDate.getTime()))}function W(){const l={flights:[],hotels:[],events:[],transportation:[],carRentals:[]};e(p).forEach(j=>{if(j.type==="trip"){const b=j.data;b.flights&&l.flights.push(...b.flights.map(T=>({...T,tripId:b.id}))),b.hotels&&l.hotels.push(...b.hotels.map(T=>({...T,tripId:b.id}))),b.events&&l.events.push(...b.events.map(T=>({...T,tripId:b.id}))),b.transportation&&l.transportation.push(...b.transportation.map(T=>({...T,tripId:b.id}))),b.carRentals&&l.carRentals.push(...b.carRentals.map(T=>({...T,tripId:b.id})))}else j.type==="standalone"&&(j.itemType==="flight"?l.flights.push(j.data):j.itemType==="hotel"?l.hotels.push(j.data):j.itemType==="event"?l.events.push(j.data):j.itemType==="transportation"?l.transportation.push(j.data):j.itemType==="carRental"&&l.carRentals.push(j.data))}),o(te,l)}function C(l){o(h,l),Z(),g(),W()}function S(){o(E,{type:"newItemMenu",data:{}})}function y(){o(E,{type:"calendar",data:{}}),_()}function _(){setTimeout(()=>{const l=document.getElementById("secondary-sidebar");l&&(e(E)?.type==="calendar"?l.classList.add("full-width"):l.classList.remove("full-width"))},0)}function F(){o(E,{type:"trip",itemType:"trip",data:{}})}function A(l){o(E,{type:l,itemType:l,data:{}})}function ae(l){e(re).has(l)?e(re).delete(l):e(re).add(l),o(re,e(re))}function ke(l){o(he,l)}function de(){o(he,null)}function pe(l,j){o(i,l),o(le,j)}function B(){o(le,null),o(i,null)}function J(l,j,b){o(E,{type:l,itemType:j||void 0,data:b})}function Z(){o(E,null),_()}function O(l,j={}){o(se,{type:l,data:j})}function ce(){o(se,null)}function Me(l){if(!l)return"";const j=k(l),b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],T=String(j.getDate()).padStart(2,"0"),$=b[j.getMonth()],oe=j.getFullYear();return`${T} ${$} ${oe}`}function Le(l){if(!l)return"";const[j,b]=l.split("-"),T=parseInt(j,10),$=parseInt(b,10);return`${["January","February","March","April","May","June","July","August","September","October","November","December"][$-1]} ${T}`}function pt(l){if(!l)return"";const[j,b,T]=l.split("-"),$=parseInt(j,10),oe=parseInt(b,10)-1,we=parseInt(T,10),Te=new Date($,oe,we).toLocaleDateString("en-US",{weekday:"short"}),ze=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][oe];return`${Te}, ${we} ${ze}`}function Je(l){let j,b=null;if(l.type==="flight")j=new Date(l.departureDateTime),b=l.originTimezone;else if(l.type==="hotel")j=new Date(l.checkInDateTime),b=l.timezone;else if(l.type==="transportation")j=new Date(l.departureDateTime),b=l.originTimezone;else if(l.type==="carRental")j=new Date(l.pickupDateTime),b=l.pickupTimezone;else if(l.type==="event")j=new Date(l.startDateTime),b=l.timezone;else return"";if(b)try{const Ce=new Intl.DateTimeFormat("en-CA",{year:"numeric",month:"2-digit",day:"2-digit",timeZone:b}).formatToParts(j),Te={};return Ce.forEach($e=>{$e.type!=="literal"&&(Te[$e.type]=$e.value)}),`${Te.year}-${Te.month}-${Te.day}`}catch{}const T=j.getUTCFullYear(),$=String(j.getUTCMonth()+1).padStart(2,"0"),oe=String(j.getUTCDate()).padStart(2,"0");return`${T}-${$}-${oe}`}function M(l){const j={},b=[];return l.flights&&l.flights.forEach(T=>{b.push({type:"flight",...T})}),l.hotels&&l.hotels.forEach(T=>{b.push({type:"hotel",...T})}),l.transportation&&l.transportation.forEach(T=>{b.push({type:"transportation",...T})}),l.carRentals&&l.carRentals.forEach(T=>{b.push({type:"carRental",...T})}),l.events&&l.events.forEach(T=>{b.push({type:"event",...T})}),b.sort((T,$)=>{const oe=T.type==="flight"?new Date(T.departureDateTime):T.type==="hotel"?new Date(T.checkInDateTime):T.type==="transportation"?new Date(T.departureDateTime):T.type==="carRental"?new Date(T.pickupDateTime):T.type==="event"?new Date(T.startDateTime):new Date(0),we=$.type==="flight"?new Date($.departureDateTime):$.type==="hotel"?new Date($.checkInDateTime):$.type==="transportation"?new Date($.departureDateTime):$.type==="carRental"?new Date($.pickupDateTime):$.type==="event"?new Date($.startDateTime):new Date(0);return oe.getTime()-we.getTime()}),b.forEach(T=>{const $=Je(T);j[$]||(j[$]=[]),j[$].push(T)}),j}function V(l){return l?l.charAt(0).toUpperCase()+l.slice(1).toLowerCase():""}function X(l,j=null){if(!l)return"";const b=new Date(l);if(!j){const $=String(b.getUTCHours()).padStart(2,"0"),oe=String(b.getUTCMinutes()).padStart(2,"0");return`${$}:${oe}`}return new Intl.DateTimeFormat("en-US",{timeZone:j,hour:"2-digit",minute:"2-digit",hour12:!1}).format(b)}function _e(l,j=null){if(!l)return"";const b=new Date(l);if(!j){const T=String(b.getUTCHours()).padStart(2,"0"),$=String(b.getUTCMinutes()).padStart(2,"0"),oe=String(b.getUTCDate()).padStart(2,"0"),Ce=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][b.getUTCMonth()],Te=b.getUTCFullYear();return`${oe} ${Ce} ${Te} ${T}:${$}`}try{const $=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:j}).formatToParts(b),oe={};return $.forEach(we=>{we.type!=="literal"&&(oe[we.type]=we.value)}),`${oe.day} ${oe.month} ${oe.year} ${oe.hour}:${oe.minute}`}catch{const $=String(b.getUTCHours()).padStart(2,"0"),oe=String(b.getUTCMinutes()).padStart(2,"0"),we=String(b.getUTCDate()).padStart(2,"0"),Te=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][b.getUTCMonth()],$e=b.getUTCFullYear();return`${we} ${Te} ${$e} ${$}:${oe}`}}function Ie(l,j=null){if(!l)return"";const b=new Date(l);if(!j){const T=String(b.getUTCDate()).padStart(2,"0"),oe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][b.getUTCMonth()],we=b.getUTCFullYear();return`${T} ${oe} ${we}`}try{const $=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"2-digit",timeZone:j}).formatToParts(b),oe={};return $.forEach(we=>{we.type!=="literal"&&(oe[we.type]=we.value)}),`${oe.day} ${oe.month} ${oe.year}`}catch{const $=String(b.getUTCDate()).padStart(2,"0"),we=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][b.getUTCMonth()],Ce=b.getUTCFullYear();return`${$} ${we} ${Ce}`}}function Pe(l){if(!l)return"";if(l.includes(" - ")){const j=l.split(" - ")[1];return j&&j.includes(",")?j.split(",")[0].trim():j?.trim()||""}return l.includes(",")?l.split(",")[0].trim():l.trim()}function _t(l){const j=(l||"").toLowerCase().trim();return{train:"train",bus:"directions_bus",ferry:"directions_boat",shuttle:"local_taxi",taxi:"local_taxi",rideshare:"local_taxi",subway:"subway",metro:"subway",tram:"tram",other:"directions_run"}[j]||"train"}function At(l){return l==="business"?"badge":["leisure","family","romantic"].includes(l)?"hotel":"flights_and_hotels"}function et(l){const j=new Set;return l.flights&&l.flights.forEach(b=>{b.origin&&j.add(Pe(b.origin)),b.destination&&j.add(Pe(b.destination))}),l.transportation&&l.transportation.forEach(b=>{b.origin&&j.add(Pe(b.origin)),b.destination&&j.add(Pe(b.destination))}),l.carRentals&&l.carRentals.forEach(b=>{b.pickupLocation&&j.add(Pe(b.pickupLocation))}),Array.from(j).sort().join(", ")}function tt(l,j){if(l.type!=="flight"||j.type!=="flight")return null;const b=l.destination?.split(" - ")[0]?.trim(),T=j.origin?.split(" - ")[0]?.trim();if(!b||!T||b!==T)return null;const $=new Date(l.arrivalDateTime),Ce=(new Date(j.departureDateTime).getTime()-$.getTime())/(1e3*60*60);if(Ce<0||Ce>=24)return null;const Te=Math.floor(Ce),$e=Math.round((Ce-Te)*60);return{duration:Te>0?`${Te}h ${$e}m`:`${$e}m`,location:b}}function Xe(l,j){const b=[];l.flights&&l.flights.forEach(T=>{b.push({type:"flight",...T})}),l.hotels&&l.hotels.forEach(T=>{b.push({type:"hotel",...T})}),l.transportation&&l.transportation.forEach(T=>{b.push({type:"transportation",...T})}),l.carRentals&&l.carRentals.forEach(T=>{b.push({type:"carRental",...T})}),l.events&&l.events.forEach(T=>{b.push({type:"event",...T})}),b.sort((T,$)=>{const oe=T.type==="flight"?new Date(T.departureDateTime):T.type==="hotel"?new Date(T.checkInDateTime):T.type==="transportation"?new Date(T.departureDateTime):T.type==="carRental"?new Date(T.pickupDateTime):T.type==="event"?new Date(T.startDateTime):new Date(0),we=$.type==="flight"?new Date($.departureDateTime):$.type==="hotel"?new Date($.checkInDateTime):$.type==="transportation"?new Date($.departureDateTime):$.type==="carRental"?new Date($.pickupDateTime):$.type==="event"?new Date($.startDateTime):new Date(0);return oe.getTime()-we.getTime()});for(let T=0;T<b.length;T++)if(b[T].type==="flight"&&b[T].id===j){if(T+1<b.length&&b[T+1].type==="flight")return tt(b[T],b[T+1]);break}return null}function Ne(l,j,b){const T=[];l.flights&&l.flights.forEach($=>{T.push({type:"flight",...$})}),l.hotels&&l.hotels.forEach($=>{T.push({type:"hotel",...$})}),l.transportation&&l.transportation.forEach($=>{T.push({type:"transportation",...$})}),l.carRentals&&l.carRentals.forEach($=>{T.push({type:"carRental",...$})}),l.events&&l.events.forEach($=>{T.push({type:"event",...$})}),T.sort(($,oe)=>{const we=$.type==="flight"?new Date($.departureDateTime):$.type==="hotel"?new Date($.checkInDateTime):$.type==="transportation"?new Date($.departureDateTime):$.type==="carRental"?new Date($.pickupDateTime):$.type==="event"?new Date($.startDateTime):new Date(0),Ce=oe.type==="flight"?new Date(oe.departureDateTime):oe.type==="hotel"?new Date(oe.checkInDateTime):oe.type==="transportation"?new Date(oe.departureDateTime):oe.type==="carRental"?new Date(oe.pickupDateTime):oe.type==="event"?new Date(oe.startDateTime):new Date(0);return we.getTime()-Ce.getTime()});for(let $=0;$<T.length;$++)if(T[$].type==="flight"&&T[$].id===j){if($+1<T.length&&T[$+1].type==="flight")return Je(T[$+1])!==b;break}return!1}pa(()=>(e(p),e(ge),e(ue)),()=>{e(p).length>0?(o(ge,{}),o(ue,[]),e(p).forEach(l=>{const j=N(l);e(ge)[j]||(Q(ge,e(ge)[j]=[]),e(ue).push(j)),e(ge)[j].push(l)})):(o(ge,{}),o(ue,[]))}),pa(()=>(e(E),e(se)),()=>{if(typeof window<"u"&&e(E)){const l=document.getElementById("secondary-sidebar");l&&(["calendar","settings-vouchers","settings-companions","settings-backup"].includes(e(E).type)?l.classList.add("full-width"):l.classList.remove("full-width"),e(se)?l.classList.add("with-tertiary"):l.classList.remove("with-tertiary"))}}),Wa(),Yt(),oi("x1i5gj",l=>{Xr(()=>{Si.title="Dashboard - Bluebonnet"})});{let l=Ke(()=>e(h)==="past");Ji(n,{get tripData(){return e(te)},get isPast(){return e(l)},get highlightedTripId(){return e(he)},get highlightedItemType(){return e(i)},get highlightedItemId(){return e(le)},$$slots:{primary:(j,b)=>{var T=Po(),$=a(T),oe=a($),we=r(a(oe),2),Ce=a(we),Te=r(Ce,2);t(we),t(oe);var $e=r(oe,2);{var ze=De=>{Ra(De,{type:"error",get message(){return e(ve)},dismissible:!0})};I($e,De=>{e(ve)&&De(ze)})}var Ze=r($e,2),Ge=a(Ze),Ee=a(Ge);let G;var Ye=r(Ee,2);let Oe;t(Ge);var Re=r(Ge,2);let Ue;t(Ze),t($);var Ve=r($,2),st=a(Ve);{var me=De=>{var at=po(),it=a(at),Fe=a(it),nt=r(a(Fe),2),Be=r(nt,2);t(Fe);var Tt=r(Fe,2),Wt=r(a(Tt),2);t(Tt);var Dt=r(Tt,2),ot=r(a(Dt),2);t(Dt);var qe=r(Dt,2),yt=r(a(qe),2);t(qe),Ft(2),t(it),t(at),R("click",nt,()=>{o(E,{type:"settings-profile",data:d().user||{}})}),R("click",Be,()=>{o(E,{type:"settings-security",data:{}})}),R("click",Wt,()=>{o(E,{type:"settings-vouchers",data:{}})}),R("click",ot,()=>{o(E,{type:"settings-companions",data:{}})}),R("click",yt,()=>{o(E,{type:"settings-backup",data:{}})}),u(De,at)},He=De=>{var at=je(),it=fe(at);{var Fe=Be=>{Qi(Be,{message:"Loading trips..."})},nt=Be=>{var Tt=je(),Wt=fe(Tt);{var Dt=qe=>{var yt=fo(),$t=r(a(yt),2),Nt=a($t,!0);t($t);var bt=r($t,2);Aa(bt,{variant:"primary",size:"small",$$events:{click:S},children:(dt,Pt)=>{Ft();var qt=ma("Create Trip");u(dt,qt)},$$slots:{default:!0}}),t(yt),K(()=>q(Nt,e(h)==="upcoming"?"No upcoming trips":"No past trips")),u(qe,yt)},ot=qe=>{var yt=$o();ut(yt,5,()=>e(ue),$t=>$t,($t,Nt)=>{var bt=Ao(),dt=a(bt),Pt=a(dt),qt=a(Pt,!0);t(Pt),t(dt);var Ct=r(dt,2);ut(Ct,5,()=>(e(ge),e(Nt),c(()=>e(ge)[e(Nt)])),xt=>xt.type==="trip"?xt.data.id:`${xt.itemType}-${xt.data.id}`,(xt,D)=>{var ga=je(),Qe=fe(ga);{var ft=ct=>{var mt=No();let Et;var aa=a(mt),ya=a(aa),Fa=a(ya),Za=a(Fa,!0);t(Fa),t(ya);var Ka=r(ya,2),Ba=a(Ka),Xa=a(Ba),Tr=a(Xa,!0);t(Xa);var pr=r(Xa,2);t(Ba);var Qa=r(Ba,2),Dr=a(Qa);t(Qa);var wr=r(Qa,2);{var St=vt=>{var Ot=mo(),ca=a(Ot,!0);t(Ot),K(rt=>q(ca,rt),[()=>(e(D),c(()=>et(e(D).data)))]),u(vt,Ot)};I(wr,vt=>{e(D),c(()=>et(e(D).data))&&vt(St)})}t(Ka);var Zt=r(Ka,2);{var ka=vt=>{var Ot=ho(),ca=a(Ot);uo(ca,{get companions(){return e(D),c(()=>e(D).data.travelCompanions)}}),t(Ot),u(vt,Ot)};I(Zt,vt=>{e(D),c(()=>e(D).data.travelCompanions&&e(D).data.travelCompanions.length>0)&&vt(ka)})}var ba=r(Zt,2);let $a;t(aa);var ra=r(aa,2);{var da=vt=>{var Ot=jo();ut(Ot,5,()=>(e(D),c(()=>Object.keys(M(e(D).data)))),ca=>ca,(ca,rt)=>{var zt=Eo(),_a=a(zt),Ca=a(_a),er=a(Ca,!0);t(Ca);var Kt=r(Ca,2),va=a(Kt);{var Ea=Rt=>{const ee=Ke(()=>(e(D),c(()=>Object.keys(M(e(D).data)))));var ja=je(),Ja=fe(ja);{var ar=Oa=>{const Xt=Ke(()=>(Ae(e(ee)),e(rt),c(()=>e(ee)[e(ee).indexOf(e(rt))-1])));var Qt=je(),za=fe(Qt);{var Na=ea=>{const ua=Ke(()=>(e(D),Ae(e(Xt)),c(()=>M(e(D).data)[e(Xt)])));var ht=je(),fa=fe(ht);ut(fa,1,()=>e(ua),ha,(Ta,Ut)=>{var Mt=je(),wt=fe(Mt);{var oa=Ht=>{const ia=Ke(()=>(e(D),e(Ut),c(()=>Xe(e(D).data,e(Ut).id)))),It=Ke(()=>(e(D),e(Ut),Ae(e(Xt)),c(()=>Ne(e(D).data,e(Ut).id,e(Xt)))));var lt=je(),jt=fe(lt);{var Vt=na=>{var sa=go(),Sa=a(sa);t(sa),K(()=>q(Sa,`${Ae(e(ia)),c(()=>e(ia).duration)??""} in ${Ae(e(ia)),c(()=>e(ia).location)??""}`)),u(na,sa)};I(jt,na=>{e(ia)&&e(It)&&na(Vt)})}u(Ht,lt)};I(wt,Ht=>{e(Ut),c(()=>e(Ut).type==="flight")&&Ht(oa)})}u(Ta,Mt)}),u(ea,ht)};I(za,ea=>{e(Xt)&&ea(Na)})}u(Oa,Qt)};I(Ja,Oa=>{Ae(e(ee)),c(()=>e(ee).length>1)&&Oa(ar)})}u(Rt,ja)},tr=Rt=>{const ee=Ke(()=>(e(D),c(()=>Object.keys(M(e(D).data))))),ja=Ke(()=>(Ae(e(ee)),e(rt),c(()=>e(ee).indexOf(e(rt)))));var Ja=je(),ar=fe(Ja);{var Oa=Xt=>{const Qt=Ke(()=>(Ae(e(ee)),Ae(e(ja)),c(()=>e(ee)[e(ja)-1]))),za=Ke(()=>(e(D),Ae(e(Qt)),c(()=>M(e(D).data)[e(Qt)])));var Na=je(),ea=fe(Na);ut(ea,1,()=>e(za),ha,(ua,ht)=>{var fa=je(),Ta=fe(fa);{var Ut=Mt=>{const wt=Ke(()=>(e(D),e(ht),c(()=>Xe(e(D).data,e(ht).id)))),oa=Ke(()=>(e(D),e(ht),Ae(e(Qt)),c(()=>Ne(e(D).data,e(ht).id,e(Qt)))));var Ht=je(),ia=fe(Ht);{var It=lt=>{var jt=_o(),Vt=a(jt);t(jt),K(()=>q(Vt,`${Ae(e(wt)),c(()=>e(wt).duration)??""} in ${Ae(e(wt)),c(()=>e(wt).location)??""}`)),u(lt,jt)};I(ia,lt=>{e(wt)&&e(oa)&&lt(It)})}u(Mt,Ht)};I(Ta,Mt=>{e(ht),c(()=>e(ht).type==="flight")&&Mt(Ut)})}u(ua,fa)}),u(Xt,Na)};I(ar,Xt=>{e(ja)>0&&Xt(Oa)})}u(Rt,Ja)};I(va,Rt=>{e(rt),e(D),c(()=>e(rt)===Object.keys(M(e(D).data))[0])?Rt(Ea):Rt(tr,!1)})}t(Kt),t(_a);var xa=r(_a,2);ut(xa,5,()=>(e(D),e(rt),c(()=>M(e(D).data)[e(rt)])),Rt=>Rt.id,(Rt,ee)=>{var ja=je(),Ja=fe(ja);{var ar=Xt=>{const Qt=Ke(()=>(e(D),e(ee),c(()=>Xe(e(D).data,e(ee).id)))),za=Ke(()=>(e(D),e(ee),e(rt),c(()=>Ne(e(D).data,e(ee).id,e(rt)))));var Na=bo(),ea=fe(Na);let ua;var ht=a(ea),fa=a(ht),Ta=a(fa,!0);t(fa),Ft(2),t(ht);var Ut=r(ht,2),Mt=a(Ut),wt=a(Mt,!0);t(Mt);var oa=r(Mt,2),Ht=a(oa);t(oa),t(Ut),t(ea);var ia=r(ea,2);{var It=lt=>{var jt=yo(),Vt=a(jt),na=a(Vt);t(Vt),t(jt),K(()=>q(na,`${Ae(e(Qt)),c(()=>e(Qt).duration)??""} in ${Ae(e(Qt)),c(()=>e(Qt).location)??""}`)),u(lt,jt)};I(ia,lt=>{e(Qt)&&!e(za)&&lt(It)})}K((lt,jt,Vt)=>{ua=kt(ea,1,"standalone-item-card svelte-x1i5gj",null,ua,{"item-highlighted":e(le)===e(ee).id&&e(i)==="flight"}),q(Ta,lt),q(wt,(e(ee),c(()=>e(ee).flightNumber))),q(Ht,`${jt??""} → ${Vt??""}`)},[()=>(e(ee),c(()=>X(e(ee).departureDateTime,e(ee).originTimezone))),()=>(e(ee),c(()=>Pe(e(ee).origin))),()=>(e(ee),c(()=>Pe(e(ee).destination)))]),R("mouseenter",ea,()=>pe("flight",e(ee).id)),R("mouseleave",ea,B),R("click",ea,()=>J("flight","flight",e(ee))),R("keydown",ea,lt=>lt.key==="Enter"&&J("flight","flight",e(ee))),u(Xt,Na)},Oa=Xt=>{var Qt=je(),za=fe(Qt);{var Na=ua=>{var ht=xo();let fa;var Ta=r(a(ht),2),Ut=a(Ta),Mt=a(Ut,!0);t(Ut);var wt=r(Ut,2),oa=a(wt);t(wt);var Ht=r(wt,2),ia=a(Ht,!0);t(Ht),t(Ta),t(ht),K((It,lt,jt)=>{fa=kt(ht,1,"standalone-item-card svelte-x1i5gj",null,fa,{"item-highlighted":e(le)===e(ee).id&&e(i)==="hotel"}),q(Mt,(e(ee),c(()=>e(ee).hotelName||e(ee).name))),q(oa,`${It??""} - ${lt??""}`),q(ia,jt)},[()=>(e(ee),c(()=>Ie(e(ee).checkInDateTime,e(ee).timezone))),()=>(e(ee),c(()=>Ie(e(ee).checkOutDateTime,e(ee).timezone))),()=>(e(ee),c(()=>Pe(e(ee).address)?Pe(e(ee).address):Pe(e(ee).city)))]),R("mouseenter",ht,()=>pe("hotel",e(ee).id)),R("mouseleave",ht,B),R("click",ht,()=>J("hotel","hotel",e(ee))),R("keydown",ht,It=>It.key==="Enter"&&J("hotel","hotel",e(ee))),u(ua,ht)},ea=ua=>{var ht=je(),fa=fe(ht);{var Ta=Mt=>{var wt=To(),oa=a(wt),Ht=a(oa),ia=a(Ht,!0);t(Ht);var It=r(Ht,2),lt=a(It),jt=a(lt,!0);t(lt),t(It),t(oa);var Vt=r(oa,2),na=a(Vt),sa=a(na,!0);t(na);var Sa=r(na,2),Ga=a(Sa);t(Sa),t(Vt),t(wt),K((Ua,Pa,Ha,kr,rr)=>{q(ia,Ua),q(jt,Pa),q(sa,Ha),q(Ga,`${kr??""} → ${rr??""}`)},[()=>(e(ee),c(()=>X(e(ee).departureDateTime,e(ee).originTimezone))),()=>(e(ee),c(()=>_t(e(ee).method))),()=>(e(ee),c(()=>V(e(ee).method))),()=>(e(ee),c(()=>Pe(e(ee).origin))),()=>(e(ee),c(()=>Pe(e(ee).destination)))]),R("click",wt,()=>J("transportation","transportation",e(ee))),R("keydown",wt,Ua=>Ua.key==="Enter"&&J("transportation","transportation",e(ee))),u(Mt,wt)},Ut=Mt=>{var wt=je(),oa=fe(wt);{var Ht=It=>{var lt=Do(),jt=r(a(lt),2),Vt=a(jt),na=a(Vt,!0);t(Vt);var sa=r(Vt,2),Sa=a(sa,!0);t(sa);var Ga=r(sa,2),Ua=a(Ga,!0);t(Ga),t(jt),t(lt),K((Pa,Ha)=>{q(na,(e(ee),c(()=>e(ee).company))),q(Sa,Pa),q(Ua,Ha)},[()=>(e(ee),c(()=>_e(e(ee).pickupDateTime,e(ee).pickupTimezone))),()=>(e(ee),c(()=>Pe(e(ee).pickupLocation)))]),R("click",lt,()=>J("carRental","carRental",e(ee))),R("keydown",lt,Pa=>Pa.key==="Enter"&&J("carRental","carRental",e(ee))),u(It,lt)},ia=It=>{var lt=je(),jt=fe(lt);{var Vt=na=>{var sa=Co(),Sa=a(sa);{var Ga=Da=>{var ir=wo();u(Da,ir)},Ua=Da=>{var ir=ko(),Fr=a(ir),ni=a(Fr,!0);t(Fr),Ft(2),t(ir),K(si=>q(ni,si),[()=>(e(ee),c(()=>X(e(ee).startDateTime,e(ee).timezone)))]),u(Da,ir)};I(Sa,Da=>{e(ee),c(()=>e(ee).isAllDay)?Da(Ga):Da(Ua,!1)})}var Pa=r(Sa,2),Ha=a(Pa),kr=a(Ha,!0);t(Ha);var rr=r(Ha,2),ri=a(rr,!0);t(rr);var Rr=r(rr,2),ii=a(Rr,!0);t(Rr),t(Pa),t(sa),K(Da=>{q(kr,(e(ee),c(()=>e(ee).name))),q(ri,Da),q(ii,(e(ee),c(()=>e(ee).location)))},[()=>(e(ee),c(()=>_e(e(ee).startDateTime,e(ee).timezone)))]),R("click",sa,()=>J("event","event",e(ee))),R("keydown",sa,Da=>Da.key==="Enter"&&J("event","event",e(ee))),u(na,sa)};I(jt,na=>{e(ee),c(()=>e(ee).type==="event")&&na(Vt)},!0)}u(It,lt)};I(oa,It=>{e(ee),c(()=>e(ee).type==="carRental")?It(Ht):It(ia,!1)},!0)}u(Mt,wt)};I(fa,Mt=>{e(ee),c(()=>e(ee).type==="transportation")?Mt(Ta):Mt(Ut,!1)},!0)}u(ua,ht)};I(za,ua=>{e(ee),c(()=>e(ee).type==="hotel")?ua(Na):ua(ea,!1)},!0)}u(Xt,Qt)};I(Ja,Xt=>{e(ee),c(()=>e(ee).type==="flight")?Xt(ar):Xt(Oa,!1)})}u(Rt,ja)}),t(xa),t(zt),K(Rt=>q(er,Rt),[()=>(e(rt),c(()=>pt(e(rt))))]),u(ca,zt)}),t(Ot),u(vt,Ot)};I(ra,vt=>{e(re),e(D),c(()=>e(re).has(e(D).data.id))&&vt(da)})}t(mt),K((vt,Ot,ca,rt,zt)=>{Et=kt(mt,1,"trip-card svelte-x1i5gj",null,Et,vt),q(Za,Ot),q(Tr,(e(D),c(()=>e(D).data.name))),q(Dr,`${ca??""} - ${rt??""}`),$a=kt(ba,1,"expand-btn svelte-x1i5gj",null,$a,zt)},[()=>({expanded:e(re).has(e(D).data.id),highlighted:e(he)===e(D).data.id}),()=>(e(D),c(()=>At(e(D).data.purpose))),()=>(e(D),c(()=>Me(e(D).data.departureDate))),()=>(e(D),c(()=>Me(e(D).data.returnDate||e(D).data.departureDate))),()=>({rotated:e(re).has(e(D).data.id)})]),R("click",pr,vt=>{vt.stopPropagation(),o(E,{type:"item",itemType:"trip",data:e(D).data})}),R("click",ba,vt=>{vt.stopPropagation(),ae(e(D).data.id)}),R("click",aa,()=>ae(e(D).data.id)),R("keydown",aa,vt=>vt.key==="Enter"&&ae(e(D).data.id)),R("mouseenter",mt,()=>ke(e(D).data.id)),R("mouseleave",mt,()=>de()),u(ct,mt)},Lt=ct=>{var mt=Io(),Et=a(mt),aa=a(Et),ya=a(aa,!0);t(aa),t(Et);var Fa=r(Et,2),Za=a(Fa),Ka=a(Za,!0);t(Za);var Ba=r(Za,2);{var Xa=St=>{var Zt=So(),ka=a(Zt);t(Zt),K((ba,$a)=>q(ka,`${ba??""} - ${$a??""}`),[()=>(e(D),c(()=>Ie(e(D).data.checkInDateTime,e(D).data.timezone))),()=>(e(D),c(()=>Ie(e(D).data.checkOutDateTime,e(D).data.timezone)))]),u(St,Zt)},Tr=St=>{var Zt=Mo(),ka=a(Zt);{var ba=ra=>{var da=ma();K(vt=>q(da,vt),[()=>(e(D),c(()=>_e(e(D).data.departureDateTime,e(D).data.originTimezone)))]),u(ra,da)},$a=ra=>{var da=je(),vt=fe(da);{var Ot=rt=>{var zt=ma();K(_a=>q(zt,_a),[()=>(e(D),c(()=>_e(e(D).data.departureDateTime,e(D).data.originTimezone)))]),u(rt,zt)},ca=rt=>{var zt=je(),_a=fe(zt);{var Ca=Kt=>{var va=ma();K(Ea=>q(va,Ea),[()=>(e(D),c(()=>_e(e(D).data.pickupDateTime,e(D).data.pickupTimezone)))]),u(Kt,va)},er=Kt=>{var va=je(),Ea=fe(va);{var tr=xa=>{var Rt=ma();K(ee=>q(Rt,ee),[()=>(e(D),c(()=>_e(e(D).data.startDateTime,e(D).data.timezone)))]),u(xa,Rt)};I(Ea,xa=>{e(D),c(()=>e(D).itemType==="event")&&xa(tr)},!0)}u(Kt,va)};I(_a,Kt=>{e(D),c(()=>e(D).itemType==="carRental")?Kt(Ca):Kt(er,!1)},!0)}u(rt,zt)};I(vt,rt=>{e(D),c(()=>e(D).itemType==="transportation")?rt(Ot):rt(ca,!1)},!0)}u(ra,da)};I(ka,ra=>{e(D),c(()=>e(D).itemType==="flight")?ra(ba):ra($a,!1)})}t(Zt),u(St,Zt)};I(Ba,St=>{e(D),c(()=>e(D).itemType==="hotel")?St(Xa):St(Tr,!1)})}var pr=r(Ba,2),Qa=a(pr);{var Dr=St=>{var Zt=ma();K((ka,ba)=>q(Zt,`${ka??""} → ${ba??""}`),[()=>(e(D),c(()=>Pe(e(D).data.origin))),()=>(e(D),c(()=>Pe(e(D).data.destination)))]),u(St,Zt)},wr=St=>{var Zt=je(),ka=fe(Zt);{var ba=ra=>{var da=ma();K(vt=>q(da,vt),[()=>(e(D),c(()=>Pe(e(D).data.address)))]),u(ra,da)},$a=ra=>{var da=je(),vt=fe(da);{var Ot=rt=>{var zt=ma();K((_a,Ca)=>q(zt,`${_a??""} → ${Ca??""}`),[()=>(e(D),c(()=>Pe(e(D).data.origin))),()=>(e(D),c(()=>Pe(e(D).data.destination)))]),u(rt,zt)},ca=rt=>{var zt=je(),_a=fe(zt);{var Ca=Kt=>{var va=ma();K(Ea=>q(va,Ea),[()=>(e(D),c(()=>Pe(e(D).data.pickupLocation)))]),u(Kt,va)},er=Kt=>{var va=je(),Ea=fe(va);{var tr=xa=>{var Rt=ma();K(()=>q(Rt,(e(D),c(()=>e(D).data.location)))),u(xa,Rt)};I(Ea,xa=>{e(D),c(()=>e(D).itemType==="event")&&xa(tr)},!0)}u(Kt,va)};I(_a,Kt=>{e(D),c(()=>e(D).itemType==="carRental")?Kt(Ca):Kt(er,!1)},!0)}u(rt,zt)};I(vt,rt=>{e(D),c(()=>e(D).itemType==="transportation")?rt(Ot):rt(ca,!1)},!0)}u(ra,da)};I(ka,ra=>{e(D),c(()=>e(D).itemType==="hotel")?ra(ba):ra($a,!1)},!0)}u(St,Zt)};I(Qa,St=>{e(D),c(()=>e(D).itemType==="flight")?St(Dr):St(wr,!1)})}t(pr),t(Fa),t(mt),K(St=>{kt(Et,1,`item-icon ${e(D),c(()=>e(D).itemType==="flight"?"blue":e(D).itemType==="hotel"?"green":e(D).itemType==="carRental"?"gray":e(D).itemType==="event"?"purple":"red")??""}`,"svelte-x1i5gj"),q(ya,St),q(Ka,(e(D),c(()=>e(D).itemType==="flight"?e(D).data.flightNumber:e(D).itemType==="hotel"?e(D).data.hotelName||e(D).data.name:e(D).itemType==="carRental"?e(D).data.company:e(D).itemType==="event"?e(D).data.name:e(D).data.method)))},[()=>(e(D),c(()=>e(D).itemType==="flight"?"flight":e(D).itemType==="hotel"?"hotel":e(D).itemType==="carRental"?"directions_car":e(D).itemType==="event"?"event":_t(e(D).data.method)))]),R("click",mt,()=>J(e(D).itemType,e(D).itemType,e(D).data)),R("mouseenter",mt,()=>pe(e(D).itemType,e(D).data.id)),R("mouseleave",mt,B),R("keydown",mt,St=>St.key==="Enter"&&J(e(D).itemType,e(D).itemType,e(D).data)),u(ct,mt)};I(Qe,ct=>{e(D),c(()=>e(D).type==="trip")?ct(ft):ct(Lt,!1)})}u(xt,ga)}),t(Ct),t(bt),K(xt=>q(qt,xt),[()=>(e(Nt),c(()=>Le(e(Nt))))]),u($t,bt)}),t(yt),u(qe,yt)};I(Wt,qe=>{e(p),c(()=>e(p).length===0)?qe(Dt):qe(ot,!1)},!0)}u(Be,Tt)};I(it,Be=>{e(L)?Be(Fe):Be(nt,!1)},!0)}u(De,at)};I(st,De=>{e(P)==="settings"?De(me):De(He,!1)})}t(Ve),t(T),K(()=>{G=kt(Ee,1,"tab-btn svelte-x1i5gj",null,G,{active:e(P)==="trips"&&e(h)==="upcoming"}),Oe=kt(Ye,1,"tab-btn svelte-x1i5gj",null,Oe,{active:e(P)==="trips"&&e(h)==="past"}),Ue=kt(Re,1,"tab-btn settings-btn svelte-x1i5gj",null,Ue,{active:e(P)==="settings"})}),R("click",Ce,y),R("click",Te,S),R("click",Ee,()=>{o(P,"trips"),C("upcoming")}),R("click",Ye,()=>{o(P,"trips"),C("past")}),R("click",Re,()=>o(P,"settings")),u(j,T)},secondary:(j,b)=>{var T=Ho();let $;var oe=a(T);{var we=Te=>{var $e=qo(),ze=a($e),Ze=r(a(ze),2);t(ze);var Ge=r(ze,2);es(Ge,{get trips(){return e(m)},get standaloneItems(){return e(v)},onItemClick:J}),t($e),R("click",Ze,Z),u(Te,$e)},Ce=Te=>{var $e=je(),ze=fe($e);{var Ze=Ee=>{var G=Lo(),Ye=a(G),Oe=r(a(Ye),2);t(Ye);var Re=r(Ye,2),Ue=a(Re);{let Ve=Ke(()=>(e(E),c(()=>e(E)?.data)));rs(Ue,{get data(){return e(Ve)}})}t(Re),t(G),R("click",Oe,Z),u(Ee,G)},Ge=Ee=>{var G=je(),Ye=fe(G);{var Oe=Ue=>{var Ve=Ro(),st=a(Ve),me=r(a(st),2);t(st);var He=r(st,2),De=a(He);os(De,{}),t(He),t(Ve),R("click",me,Z),u(Ue,Ve)},Re=Ue=>{var Ve=je(),st=fe(Ve);{var me=De=>{var at=Fo(),it=a(at),Fe=r(a(it),2);t(it);var nt=r(it,2);Is(nt,{onEditVoucher:Be=>O("edit-voucher",{voucher:Be}),onAddVoucher:()=>O("add-voucher",{})}),t(at),R("click",Fe,Z),u(De,at)},He=De=>{var at=je(),it=fe(at);{var Fe=Be=>{var Tt=Oo(),Wt=a(Tt),Dt=r(a(Wt),2),ot=a(Dt),qe=r(ot,2);t(Dt),t(Wt);var yt=r(Wt,2);Us(yt,{}),t(Tt),R("click",ot,()=>O("add-companion",{})),R("click",qe,Z),u(Be,Tt)},nt=Be=>{var Tt=je(),Wt=fe(Tt);{var Dt=qe=>{var yt=zo(),$t=a(yt),Nt=r(a($t),2);t($t);var bt=r($t,2);no(bt,{}),t(yt),R("click",Nt,Z),u(qe,yt)},ot=qe=>{var yt=je(),$t=fe(yt);{var Nt=dt=>{var Pt=Uo(),qt=a(Pt),Ct=r(a(qt),2);t(qt);var xt=r(qt,2),D=a(xt),ga=r(D,4),Qe=r(ga,2),ft=r(Qe,2),Lt=r(ft,2),ct=r(Lt,2);t(xt),t(Pt),R("click",Ct,Z),R("click",D,F),R("click",ga,()=>A("flight")),R("click",Qe,()=>A("hotel")),R("click",ft,()=>A("transportation")),R("click",Lt,()=>A("carRental")),R("click",ct,()=>A("event")),u(dt,Pt)},bt=dt=>{var Pt=je(),qt=fe(Pt);{var Ct=xt=>{{let D=Ke(()=>(e(E),c(()=>e(E).itemType||e(E).type))),ga=Ke(()=>(e(E),c(()=>e(E).data?.tripId||"")));Bn(xt,{get itemType(){return e(D)},get data(){return e(E),c(()=>e(E).data)},get tripId(){return e(ga)},get allTrips(){return e(m)},onClose:Z,onSave:async Qe=>{if(e(E)){if(Qe===null)if(e(E).type==="trip")o(m,e(m).filter(ft=>ft.id!==e(E).data.id));else{const ft=e(E).itemType+"s";e(v)[ft]&&Q(v,e(v)[ft]=e(v)[ft].filter(Lt=>Lt.id!==e(E).data.id))}else if(e(E).type==="trip"){const ft=e(m).findIndex(Lt=>Lt.id===Qe.id);ft>=0?(Q(m,e(m)[ft]=Qe),o(m,e(m))):o(m,[...e(m),Qe])}else{const ft=e(E).data?.tripId,Lt=Qe.tripId,ct=e(E).itemType+"s";if(ft!==Lt){const mt=new Set;ft&&mt.add(ft),Lt&&mt.add(Lt);for(const Et of mt)try{const aa=await Ya.getOne(Et),ya=e(m).findIndex(Fa=>Fa.id===Et);ya>=0&&Q(m,e(m)[ya]=aa)}catch(aa){console.error("Error refetching trip:",aa)}o(m,e(m)),!ft&&Lt&&e(v)[ct]&&Q(v,e(v)[ct]=e(v)[ct].filter(Et=>Et.id!==Qe.id)),ft&&!Lt&&(e(v)[ct]?Q(v,e(v)[ct]=[...e(v)[ct],Qe]):Q(v,e(v)[ct]=[Qe]))}else if(Lt){const mt=e(m).findIndex(Et=>Et.id===Lt);if(mt>=0){const Et=e(m)[mt];if(Et[ct]){const aa=Et[ct].findIndex(ya=>ya.id===Qe.id);aa>=0&&(Et[ct][aa]=Qe)}Q(m,e(m)[mt]=Et),o(m,e(m))}}else if(e(v)[ct]){const mt=e(v)[ct].findIndex(Et=>Et.id===Qe.id);mt>=0?(Q(v,e(v)[ct][mt]=Qe),Q(v,e(v)[ct]=e(v)[ct])):Q(v,e(v)[ct]=[...e(v)[ct],Qe])}else Q(v,e(v)[ct]=[Qe])}g(),W()}}})}};I(qt,xt=>{e(E)&&xt(Ct)},!0)}u(dt,Pt)};I($t,dt=>{e(E),c(()=>e(E)?.type==="newItemMenu")?dt(Nt):dt(bt,!1)},!0)}u(qe,yt)};I(Wt,qe=>{e(E),c(()=>e(E)?.type==="settings-backup")?qe(Dt):qe(ot,!1)},!0)}u(Be,Tt)};I(it,Be=>{e(E),c(()=>e(E)?.type==="settings-companions")?Be(Fe):Be(nt,!1)},!0)}u(De,at)};I(st,De=>{e(E),c(()=>e(E)?.type==="settings-vouchers")?De(me):De(He,!1)},!0)}u(Ue,Ve)};I(Ye,Ue=>{e(E),c(()=>e(E)?.type==="settings-security")?Ue(Oe):Ue(Re,!1)},!0)}u(Ee,G)};I(ze,Ee=>{e(E),c(()=>e(E)?.type==="settings-profile")?Ee(Ze):Ee(Ge,!1)},!0)}u(Te,$e)};I(oe,Te=>{e(E),c(()=>e(E)?.type==="calendar")?Te(we):Te(Ce,!1)})}t(T),K(()=>$=kt(T,1,"secondary-content svelte-x1i5gj",null,$,{"full-width":e(E)?.type==="calendar"||e(E)?.type==="settings-vouchers"||e(E)?.type==="settings-companions"||e(E)?.type==="settings-backup"})),u(j,T)},tertiary:(j,b)=>{var T=Yo(),$=a(T);{var oe=Ce=>{var Te=Vo(),$e=fe(Te),ze=r(a($e),2);t($e);var Ze=r($e,2),Ge=a(Ze);{let Ee=Ke(()=>(e(se),c(()=>e(se).data?.voucher?.id))),G=Ke(()=>(e(se),c(()=>e(se).data?.voucher)));qr(Ge,{tripId:"",get voucherId(){return e(Ee)},get voucher(){return e(G)},onSuccess:Ye=>{ce()},onCancel:ce})}t(Ze),R("click",ze,ce),u(Ce,Te)},we=Ce=>{var Te=je(),$e=fe(Te);{var ze=Ge=>{var Ee=Bo(),G=fe(Ee),Ye=r(a(G),2);t(G);var Oe=r(G,2),Re=a(Oe);qr(Re,{tripId:"",voucherId:null,voucher:null,onSuccess:Ue=>{ce()},onCancel:ce}),t(Oe),R("click",Ye,ce),u(Ge,Ee)},Ze=Ge=>{var Ee=je(),G=fe(Ee);{var Ye=Re=>{var Ue=Jo(),Ve=fe(Ue),st=r(a(Ve),2);t(Ve);var me=r(Ve,2),He=a(me);Br(He,{companion:null,onSuccess:De=>{ce(),window.dispatchEvent(new CustomEvent("companions-updated",{detail:{companion:De}}))},onCancel:ce}),t(me),R("click",st,ce),u(Re,Ue)},Oe=Re=>{var Ue=je(),Ve=fe(Ue);{var st=me=>{var He=Go(),De=fe(He),at=r(a(De),2);t(De);var it=r(De,2),Fe=a(it);{let nt=Ke(()=>(e(se),c(()=>e(se).data?.companion)));Br(Fe,{get companion(){return e(nt)},onSuccess:Be=>{ce(),window.dispatchEvent(new CustomEvent("companions-updated",{detail:{companion:Be}}))},onCancel:ce})}t(it),R("click",at,ce),u(me,He)};I(Ve,me=>{e(se),c(()=>e(se)?.type==="edit-companion")&&me(st)},!0)}u(Re,Ue)};I(G,Re=>{e(se),c(()=>e(se)?.type==="add-companion")?Re(Ye):Re(Oe,!1)},!0)}u(Ge,Ee)};I($e,Ge=>{e(se),c(()=>e(se)?.type==="add-voucher")?Ge(ze):Ge(Ze,!1)},!0)}u(Ce,Te)};I($,Ce=>{e(se),c(()=>e(se)?.type==="edit-voucher")?Ce(oe):Ce(we,!1)})}t(T),u(j,T)}}})}Gt(),x()}export{vl as component};
