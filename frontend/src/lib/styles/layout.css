/* ============================================================================
   LAYOUT SYSTEM
   Grid-based responsive layouts for each breakpoint
   ============================================================================
   This file contains the actual layout configurations that adapt the UI
   across different breakpoints using CSS Grid and Flexbox.
   ============================================================================ */

/* =====================================================================
   ROOT LAYOUT STRUCTURE
   Applied to the main app container
   ===================================================================== */

.app-layout {
  width: 100%;
  height: 100dvh;
  overflow: hidden;
  display: grid;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 1;
  /* Default: mobile layout (will be overridden by media queries for tablet+) */
  grid-template-columns: 1fr;
  grid-template-rows: 1fr auto;
}

/* =====================================================================
   MOBILE LAYOUT (< 640px)
   Single column with bottom navigation

   Structure:
   ┌────────────────────┐
   │   App Content      │  (Flex: 1)
   ├────────────────────┤
   │   Bottom Nav       │  (60px)
   └────────────────────┘
   ===================================================================== */

@media (max-width: 639px) {
  .responsive-mobile {
    display: flex;
    flex-direction: column;
    width: 100%;
    height: 100%;
  }

  .responsive-desktop {
    display: none;
  }

  /* Navigation tabs */
  .nav-tab {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    flex: 1;
    gap: 0.25rem;
    padding: 0.5rem;
    background: none;
    border: none;
    cursor: pointer;
    color: var(--color-text-tertiary);
    font-size: 0.625rem;
    transition: color var(--transition-fast);
    min-height: var(--touch-target-min);
  }

  .nav-tab:active {
    background-color: rgba(0, 0, 0, 0.05);
  }

  .nav-tab.active {
    color: var(--color-primary);
  }

  .nav-tab-icon {
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* Landscape mode on mobile */
  @media (max-height: 600px) {
    .app-nav {
      height: var(--nav-height-landscape);
    }

    .nav-tab {
      font-size: 0.5rem;
      gap: 0.125rem;
      padding: 0.25rem;
    }

    .nav-tab-icon {
      width: 20px;
      height: 20px;
    }
  }
}

/* =====================================================================
   TABLET LAYOUT (640px - 1023px)
   Top navigation + collapsible primary sidebar + side drawers

   Structure:
   ┌──────────────────────────────────────┐
   │        Top Navigation Bar   │  60px   │
   ├──────────┬───────────────────────────┤
   │          │                           │
   │ Primary  │    App Content            │  Flex: 1
   │ Sidebar  │    (Map + Secondary)      │
   │ (300px   │                           │
   │ collapsed)│                          │
   │          │                           │
   └──────────┴───────────────────────────┘
   ===================================================================== */

@media (min-width: 640px) {
  .responsive-mobile {
    display: none;
  }

  .responsive-desktop {
    display: grid;
    width: 100%;
    height: 100%;
  }
}

@media (min-width: 640px) and (max-width: 1023px) {
  .app-layout {
    grid-template-columns: auto 1fr;
    grid-template-rows: auto 1fr;
  }

  /* Navigation left section (hamburger + logo) */
  .nav-left {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
  }

  /* Hamburger menu button */
  .nav-hamburger {
    display: flex;
    align-items: center;
    justify-content: center;
    width: var(--touch-target-min);
    height: var(--touch-target-min);
    padding: 0;
    background: none;
    border: none;
    cursor: pointer;
    color: var(--color-text-primary);
    transition: background-color var(--transition-fast);
  }

  .nav-hamburger:active {
    background-color: var(--color-bg-tertiary);
    border-radius: var(--radius-md);
  }

  .nav-hamburger-icon {
    width: 24px;
    height: 24px;
  }

  /* Navigation logo */
  .nav-logo {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--color-text-primary);
  }

  /* Navigation right section (user menu, settings) */
  .nav-right {
    display: flex;
    gap: var(--spacing-md);
    align-items: center;
  }

  /* Primary sidebar (collapsible) */
  .primary-sidebar {
    grid-column: 1;
    grid-row: 2;
    width: var(--sidebar-width-primary);
    overflow-y: auto;
    overflow-x: hidden;
    border-right: 1px solid var(--color-border);
    background: white;
    z-index: var(--z-sidebar-primary);
    transition:
      transform var(--transition-smooth),
      width var(--transition-smooth);
  }

  /* Collapsed state */
  .primary-sidebar.collapsed {
    position: fixed;
    left: 0;
    top: var(--nav-height-tablet);
    bottom: 0;
    transform: translateX(-100%);
    border-right: none;
    z-index: var(--z-drawer);
  }

  /* Drawer backdrop (appears when sidebar is open in collapsed state) */
  .sidebar-backdrop {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: calc(var(--z-drawer) - 1);
    opacity: 0;
    pointer-events: none;
    transition: opacity var(--transition-smooth);
  }

  .primary-sidebar.collapsed.open ~ .sidebar-backdrop {
    opacity: 1;
    pointer-events: auto;
  }

  /* Main content area */
  .app-content {
    grid-column: 2;
    grid-row: 2;
    position: relative;
    overflow: hidden;
    display: grid;
    grid-template-columns: 1fr;
    grid-template-rows: 1fr;
  }

  /* Map container (background) */
  .map-container {
    grid-column: 1;
    grid-row: 1;
    position: absolute;
    width: 100%;
    height: 100%;
    z-index: var(--z-map);
  }

  /* Secondary sidebar (right drawer) */
  .secondary-sidebar {
    position: absolute;
    right: 0;
    top: 0;
    bottom: 0;
    width: 50%;
    max-width: 400px;
    background: white;
    overflow-y: auto;
    overflow-x: hidden;
    box-shadow: -2px 0 8px rgba(0, 0, 0, 0.1);
    z-index: var(--z-sidebar-secondary);
    transform: translateX(100%);
    transition: transform var(--transition-smooth);
  }

  .secondary-sidebar.open {
    transform: translateX(0);
  }

  /* Tertiary sidebar (layered over secondary) */
  .tertiary-sidebar {
    position: absolute;
    right: 0;
    top: 0;
    bottom: 0;
    width: 50%;
    max-width: 400px;
    background: white;
    overflow-y: auto;
    overflow-x: hidden;
    box-shadow: -2px 0 8px rgba(0, 0, 0, 0.1);
    z-index: calc(var(--z-sidebar-secondary) + 1);
    transform: translateX(100%);
    transition: transform var(--transition-smooth);
  }

  .tertiary-sidebar.open {
    transform: translateX(0);
  }

  /* Secondary/tertiary drawer backdrop */
  .drawer-backdrop {
    position: fixed;
    top: var(--nav-height-tablet);
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.3);
    z-index: calc(var(--z-sidebar-secondary) - 1);
    opacity: 0;
    pointer-events: none;
    transition: opacity var(--transition-smooth);
  }

  .secondary-sidebar.open ~ .drawer-backdrop,
  .tertiary-sidebar.open ~ .drawer-backdrop {
    opacity: 1;
    pointer-events: auto;
  }
}

/* =====================================================================
   DESKTOP LAYOUT (1024px - 1439px)
   Top navigation + three sidebars (left, center background, right)

   Structure:
   ┌──────────────────────────────────────────────┐
   │        Top Navigation Bar   │  60px           │
   ├──────────┬──────────────────┬────────────────┤
   │          │                  │                │
   │ Primary  │    Map Container │  Secondary    │
   │ Sidebar  │  + Tertiary      │  Sidebar      │
   │ (340px)  │  (Floating)      │  (340px)      │
   │          │                  │                │
   └──────────┴──────────────────┴────────────────┘
   ===================================================================== */

@media (min-width: 1024px) and (max-width: 1439px) {
  .app-layout {
    grid-template-columns: auto 1fr auto;
    grid-template-rows: auto 1fr;
  }

  /* Primary sidebar (trip list) */
  .primary-sidebar {
    grid-column: 1;
    grid-row: 2;
    width: var(--sidebar-width-primary);
    overflow-y: auto;
    overflow-x: hidden;
    border-right: 1px solid var(--color-border);
    background: white;
    z-index: var(--z-sidebar-primary);
  }

  /* Collapsed state */
  .primary-sidebar.collapsed {
    position: fixed;
    left: 0;
    top: var(--nav-height-desktop);
    bottom: 0;
    transform: translateX(-100%);
    border-right: none;
    z-index: var(--z-drawer);
    transition: transform var(--transition-smooth);
  }

  /* Main content area with map */
  .app-content {
    grid-column: 2;
    grid-row: 2;
    position: relative;
    overflow: hidden;
    display: grid;
    grid-template-columns: 1fr;
  }

  /* Map container (full background) */
  .map-container {
    position: absolute;
    width: 100%;
    height: 100%;
    z-index: var(--z-map);
    top: 0;
    left: 0;
  }

  /* Secondary sidebar (details/forms) */
  .secondary-sidebar {
    grid-column: 3;
    grid-row: 2;
    width: var(--sidebar-width-secondary);
    overflow-y: auto;
    overflow-x: hidden;
    border-left: 1px solid var(--color-border);
    background: white;
    z-index: var(--z-sidebar-secondary);
    opacity: 0;
    pointer-events: none;
    transition: opacity var(--transition-smooth);
  }

  .secondary-sidebar.open {
    opacity: 1;
    pointer-events: auto;
  }

  /* Tertiary sidebar (additional forms, floating) */
  .tertiary-sidebar {
    position: absolute;
    right: var(--spacing-lg);
    top: var(--spacing-lg);
    width: var(--sidebar-width-tertiary);
    max-height: calc(100% - var(--spacing-xl));
    overflow-y: auto;
    overflow-x: hidden;
    background: white;
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-lg);
    z-index: var(--z-sidebar-tertiary);
    opacity: 0;
    pointer-events: none;
    transition: opacity var(--transition-smooth);
  }

  .tertiary-sidebar.open {
    opacity: 1;
    pointer-events: auto;
  }

  /* Sidebar backdrop for overlays */
  .sidebar-backdrop {
    display: none;
  }

  .drawer-backdrop {
    display: none;
  }
}

/* =====================================================================
   ULTRA-WIDE LAYOUT (1440px+)
   Top navigation + four columns visible (no overlays)

   Structure:
   ┌──────────────────────────────────────────────────────┐
   │             Top Navigation Bar    │  60px            │
   ├──────────┬──────────────────┬──────────────┬────────┤
   │          │                  │              │        │
   │ Primary  │    Map           │  Secondary   │Tertiary│
   │ Sidebar  │    (Background)  │  Sidebar     │Sidebar │
   │ (340px)  │                  │  (340px)     │(340px) │
   │          │                  │              │        │
   └──────────┴──────────────────┴──────────────┴────────┘
   ===================================================================== */

@media (min-width: 1440px) {
  .app-layout {
    grid-template-columns: 340px 1fr 340px 340px;
    grid-template-rows: auto 1fr;
  }

  /* Primary sidebar (trip list) */
  .primary-sidebar {
    grid-column: 1;
    grid-row: 2;
    width: 340px;
    overflow-y: auto;
    overflow-x: hidden;
    border-right: 1px solid var(--color-border);
    background: white;
    z-index: var(--z-sidebar-primary);
  }

  /* Collapsed state (still available via hamburger) */
  .primary-sidebar.collapsed {
    position: fixed;
    left: 0;
    top: var(--nav-height-desktop);
    bottom: 0;
    width: var(--sidebar-width-mobile);
    max-width: 360px;
    transform: translateX(-100%);
    border-right: none;
    z-index: var(--z-drawer);
    transition: transform var(--transition-smooth);
  }

  /* Main content area */
  .app-content {
    grid-column: 2;
    grid-row: 2;
    position: relative;
    overflow: hidden;
    display: grid;
    grid-template-columns: 1fr;
  }

  /* Map container (background) */
  .map-container {
    position: absolute;
    width: 100%;
    height: 100%;
    z-index: var(--z-map);
    top: 0;
    left: 0;
  }

  /* Secondary sidebar (always visible) */
  .secondary-sidebar {
    grid-column: 3;
    grid-row: 2;
    width: 340px;
    overflow-y: auto;
    overflow-x: hidden;
    border-left: 1px solid var(--color-border);
    background: white;
    z-index: var(--z-sidebar-secondary);
    opacity: 1;
    pointer-events: auto;
  }

  /* Tertiary sidebar (always visible, rightmost) */
  .tertiary-sidebar {
    grid-column: 4;
    grid-row: 2;
    position: relative;
    width: 340px;
    overflow-y: auto;
    overflow-x: hidden;
    border-left: 1px solid var(--color-border);
    background: white;
    z-index: var(--z-sidebar-tertiary);
    opacity: 1;
    pointer-events: auto;
    max-height: none;
    border-radius: 0;
    box-shadow: none;
    border: none;
    border-left: 1px solid var(--color-border);
  }

  /* Disable backdrops in ultra-wide */
  .sidebar-backdrop,
  .drawer-backdrop {
    display: none;
  }
}

/* =====================================================================
   MODAL & OVERLAY SYSTEM
   Bottom sheets, side drawers, and modals
   ===================================================================== */

/* Bottom sheet (Mobile < 640px) */
@media (max-width: 639px) {
  .bottom-sheet {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    max-height: 90vh;
    background: white;
    border-radius: 1rem 1rem 0 0;
    box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.15);
    z-index: var(--z-modal);
    transform: translateY(100%);
    transition: transform var(--transition-smooth);
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }

  .bottom-sheet.open {
    transform: translateY(0);
  }

  .bottom-sheet-backdrop {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: calc(var(--z-modal) - 1);
    opacity: 0;
    pointer-events: none;
    transition: opacity var(--transition-smooth);
  }

  .bottom-sheet.open ~ .bottom-sheet-backdrop {
    opacity: 1;
    pointer-events: auto;
  }

  /* Bottom sheet handle */
  .bottom-sheet-handle {
    display: flex;
    justify-content: center;
    padding: var(--spacing-md);
  }

  .bottom-sheet-handle::before {
    content: '';
    width: 32px;
    height: 4px;
    background: var(--color-border);
    border-radius: 2px;
  }
}

/* =====================================================================
   RESPONSIVE TYPOGRAPHY SCALING
   Fluid text sizes based on viewport
   ===================================================================== */

h1 {
  font-size: clamp(1.75rem, 8vw, 2.5rem);
  font-weight: 700;
  line-height: 1.2;
  margin-bottom: clamp(0.75rem, 2vw, 1.5rem);
}

h2 {
  font-size: clamp(1.5rem, 6vw, 2rem);
  font-weight: 700;
  line-height: 1.3;
  margin-bottom: clamp(0.625rem, 1.5vw, 1.25rem);
}

h3 {
  font-size: clamp(1.25rem, 4vw, 1.5rem);
  font-weight: 600;
  line-height: 1.4;
  margin-bottom: clamp(0.5rem, 1.5vw, 1rem);
}

h4 {
  font-size: clamp(1rem, 3vw, 1.25rem);
  font-weight: 600;
  line-height: 1.5;
  margin-bottom: clamp(0.375rem, 1vw, 0.75rem);
}

h5,
h6 {
  font-size: clamp(0.875rem, 2.5vw, 1rem);
  font-weight: 600;
  line-height: 1.5;
  margin-bottom: clamp(0.375rem, 1vw, 0.75rem);
}

p {
  margin-bottom: clamp(0.5rem, 1.5vw, 1rem);
  line-height: 1.6;
}
